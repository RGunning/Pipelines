--- 
0: 
  annotatepeaks: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/annotatepeaks;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\tls * | grep -v err | xargs rm -rf;\n\ttrap SomeErrorHandler ERR;\n\tclusters=4\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/samtoolsviewInp/out.sorted.bam -T \"H3K4me3 B Cell\" -O out -L 3000 -GO km -KNC ${clusters} -CO blue:white:red -P 5 -FI 1;\n\t/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/ExtractGeneClusterings.r out;\n\tfor i in $(seq 1 ${clusters});\n\tdo\n\t\techo -e \"/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/samtoolsviewInp/out.sorted.bam\tout.cluster${i}.txt\t\\\"H3K4me3 B Cell Cluster${i}\\\"\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/annotatepeaks/config.txt;\n\tdone\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/annotatepeaks/config.txt -O clusters -L 3000 -GO hc -CO blue:white:red -P 5;\n\tcat > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/annotatepeaks/configB.txt << EOF\n/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/samtoolsviewInp/out.sorted.bam\t/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/B_ordered_TPM.txt\t\"H3K4me3 B cell\"\nEOF\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/annotatepeaks/configB.txt -O TPMorderedB -L 3000 -GO none -CO blue:white:red -P 5;\n\tcat > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/annotatepeaks/configT.txt << EOF\n/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/samtoolsviewInp/out.sorted.bam\t/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/T_ordered_TPM.txt\t\"H3K4me3 T cell\"\nEOF\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/annotatepeaks/configT.txt -O TPMorderedT -L 3000 -GO none -CO blue:white:red -P 5; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/annotatepeaks/err"
    condition: ~
    cores: 5
    mem: 5000
    placeholders: 
      - annotatepeaks
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.mark_full
      - datasource.Cell
      - software.ExtractGeneClusterings.r
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.mark_full
      - datasource.Cell
      - annotatepeaks.config.txt
      - annotatepeaks.config.txt
      - annotatepeaks.configB.txt
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - input.B_ordered_TPM.txt
      - datasource.mark_full
      - annotatepeaks.configB.txt
      - annotatepeaks.configT.txt
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - input.T_ordered_TPM.txt
      - datasource.mark_full
      - annotatepeaks.configT.txt
      - annotatepeaks.err
  annotatepeaksgroup: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/annotatepeaksgroup;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\tls * | grep -v err | xargs rm -rf;\n\ttrap SomeErrorHandler ERR;\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/samtoolsviewInp/out.sorted.bam -T \"H3K4me3 B Cell\" -O out -L 3000 -CO blue:white:red -P 5 -FI 0;\n\tfor clusters in {4..10};\n\t\tdo name=\"cluster.${clusters}\";\n\t\treplot.r heatmap -I out.zip -O ${name} -T \"H3K4me3 B Cell\" -L 3000 -GO km -KNC ${clusters} -CO blue:white:red -P 5;\n\t\tExtractGName.R ${name}.RData;\n\tdone 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/annotatepeaksgroup/err"
    condition: ~
    cores: 5
    mem: 5000
    outputfiles: 
      - cluster.4.RData
    placeholders: 
      - annotatepeaksgroup
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.mark_full
      - datasource.Cell
      - datasource.mark_full
      - datasource.Cell
      - annotatepeaksgroup.err
  bamcorrelate: 
    cmd: cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamcorrelate;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;	bamCorrelate bins -b /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/samtoolsview/out.sorted.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/samtoolsview/out.sorted.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/samtoolsview/out.sorted.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/samtoolsview/out.sorted.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/samtoolsview/out.sorted.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/samtoolsview/out.sorted.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/samtoolsview/out.sorted.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/samtoolsview/out.sorted.bam -o heatmap.pdf --corMethod pearson --labels BM_B_4M BM_B_9M BM_B_20M BM_B_36M BM_T_4M BM_T_9M BM_T_20M BM_T_36M --colorMap Reds --zMin 0.5 --zMax 1 -o correlation_spearman.pdf; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamcorrelate/err
    condition: once
    cores: 16
    mem: 5000
    placeholders: 
      - bamcorrelate
      - jobs.samtoolsview.output1
      - jobs.datasource.replicate
      - bamcorrelate.err
  bamtofq: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofq;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;trap SomeErrorHandler ERR;\tif [ TRUE == \"TRUE\" ];\n\t\tthen samtools sort /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_4M_R/BM_B_4M_R_1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofq/lane1;\n\t\tsamtools sort /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_4M_R/BM_B_4M_R_2.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofq/lane2;\n\t\tsamtools merge /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofq/merged.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofq/lane1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofq/lane2.bam;\n\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofq/lane1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofq/lane2.bam;\n\t\tif [ PE == \"PE\" ];\n\t\t\tthen\n\t\t\t\tbamtofastq filename=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofq/merged.bam gz=1 F=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofq/out_1.fq.gz F2=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofq/out_2.fq.gz;\n\t\t\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofq/merged.bam;\n\t\t\telse\n\t\t\t\tbamtofastq gz=1 filename=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofq/merged.bam > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofq/out_1.fq.gz;\n\t\t\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofq/merged.bam;\n\t\t\tfi;\n\t\telse\n\t\t\tcat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_4M_R/BM_B_4M_R* > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofq/out_1.fq.gz;\n\t\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofq/err"
    condition: ~
    mem: 1500
    placeholders: 
      - bamtofq
      - datasource.bam
      - datasource.location
      - bamtofq.lane1
      - datasource.location
      - bamtofq.lane2
      - bamtofq.merged.bam
      - bamtofq.lane1
      - bamtofq.lane2
      - bamtofq.lane1
      - bamtofq.lane2
      - datasource.SE_PE
      - bamtofq.merged.bam
      - bamtofq.out_1.fq.gz
      - bamtofq.out_2.fq.gz
      - bamtofq.merged.bam
      - bamtofq.merged.bam
      - bamtofq.out_1.fq.gz
      - bamtofq.merged.bam
      - datasource.location
      - bamtofq.out_1.fq.gz
      - bamtofq.err
  bamtofqinp: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofqinp;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;trap SomeErrorHandler ERR;\tif [ TRUE == \"TRUE\" ];\n\t\tthen samtools sort /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_INP_R/BM_B_INP_R_1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofqinp/lane1;\n\t\tsamtools sort /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_INP_R/BM_B_INP_R_2.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofqinp/lane2;\n\t\tsamtools merge /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofqinp/merged.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofqinp/lane1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofqinp/lane2.bam;\n\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofqinp/lane1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofqinp/lane2.bam;\n\t\tif [ PE == \"PE\" ];\n\t\t\tthen\n\t\t\t\tbamtofastq gz=1 filename=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofqinp/merged.bam F=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofqinp/out_1.fq.gz F2=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofqinp/out_2.fq.gz;\n\t\t\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofqinp/merged.bam;\n\t\t\telse bamtofastq gz=1 filename=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofqinp/merged.bam > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofqinp/out_1.fq.gz;\n\t\t\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofqinp/merged.bam;\n\t\tfi;\n\telse cat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_INP_R/BM_B_INP_R* > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofqinp/out_1.fq.gz;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofqinp/err"
    condition: ~
    mem: 1500
    placeholders: 
      - bamtofqinp
      - datasource.Inp_bam
      - datasource.Inp_location
      - bamtofqinp.lane1
      - datasource.Inp_location
      - bamtofqinp.lane2
      - bamtofqinp.merged.bam
      - bamtofqinp.lane1
      - bamtofqinp.lane2
      - bamtofqinp.lane1
      - bamtofqinp.lane2
      - datasource.SE_PE
      - bamtofqinp.merged.bam
      - bamtofqinp.out_1.fq.gz
      - bamtofqinp.out_2.fq.gz
      - bamtofqinp.merged.bam
      - bamtofqinp.merged.bam
      - bamtofqinp.out_1.fq.gz
      - bamtofqinp.merged.bam
      - datasource.Inp_location
      - bamtofqinp.out_1.fq.gz
      - bamtofqinp.err
  bedcorrelate: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bedcorrelate;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tbroadreplicates=(/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergedbroadpeak/ChIPseqout_peaks.broadPeak);\n\tgappedreplicates=(/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak);\n\tnarrowreplicates=(/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak);\n\t###\n\tbedtools intersect -u -a ${broadreplicates[0]} -b ${broadreplicates[1]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bedcorrelate/broadintersect.bed;\n\tbedtools intersect -u -a ${gappedreplicates[0]} -b ${gappedreplicates[1]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bedcorrelate/gappedintersect.bed;\n\tbedtools intersect -u -a ${narrowreplicates[0]} -b ${narrowreplicates[1]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bedcorrelate/narrowintersect.bed;\n\tbedtools intersect -u -a ${broadreplicates[1]} -b ${broadreplicates[0]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bedcorrelate/broadintersect2.bed;\n\tbedtools intersect -u -a ${gappedreplicates[1]} -b ${gappedreplicates[0]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bedcorrelate/gappedintersect2.bed;\n\tbedtools intersect -u -a ${narrowreplicates[1]} -b ${narrowreplicates[0]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bedcorrelate/narrowintersect2.bed;\n\t###\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bedcorrelate/broadintersect.bed|wc -l ) \"/\" $(cat ${broadreplicates[0]} |wc -l ) \") *100\"|bc >/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bedcorrelate/broadintersect.txt;\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bedcorrelate/gappedintersect.bed|wc -l ) \"/\" $(cat ${gappedreplicates[0]} |wc -l ) \") *100\"|bc >/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bedcorrelate/gappedintersect.txt;\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bedcorrelate/narrowintersect.bed|wc -l ) \"/\" $(cat ${narrowreplicates[0]} |wc -l ) \") *100\"|bc >/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bedcorrelate/narrowintersect.txt;\n\t###\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bedcorrelate/broadintersect2.bed|wc -l ) \"/\" $(cat ${broadreplicates[1]} |wc -l ) \") *100\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bedcorrelate/broadintersect.txt;\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bedcorrelate/gappedintersect2.bed|wc -l ) \"/\" $(cat ${gappedreplicates[1]} |wc -l ) \") *100\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bedcorrelate/gappedintersect.txt;\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bedcorrelate/narrowintersect2.bed|wc -l ) \"/\" $(cat ${narrowreplicates[1]} |wc -l ) \") *100\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bedcorrelate/narrowintersect.txt;\n\t###\n\techo \"scale=4;((\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bedcorrelate/broadintersect.bed|wc -l ) \"/\" $(cat ${broadreplicates[0]} |wc -l ) \")+(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bedcorrelate/broadintersect2.bed|wc -l ) \"/\" $(cat ${broadreplicates[1]} |wc -l ) \")) *50\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bedcorrelate/broadintersect.txt;\n\techo \"scale=4;((\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bedcorrelate/gappedintersect.bed|wc -l ) \"/\" $(cat ${gappedreplicates[0]} |wc -l ) \")+(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bedcorrelate/gappedintersect2.bed|wc -l ) \"/\" $(cat ${gappedreplicates[1]} |wc -l ) \")) *50\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bedcorrelate/gappedintersect.txt;\n\techo \"scale=4;((\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bedcorrelate/narrowintersect.bed|wc -l ) \"/\" $(cat ${narrowreplicates[0]} |wc -l ) \")+(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bedcorrelate/narrowintersect2.bed|wc -l ) \"/\" $(cat ${narrowreplicates[1]} |wc -l ) \")) *50\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bedcorrelate/narrowintersect.txt; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bedcorrelate/err"
    condition: groupby
    condition_params: 
      - replicate
    cores: 4
    mem: 5000
    placeholders: 
      - bedcorrelate
      - groupby.replicate.macsunmergedbroadpeak.ChIPseqout_peaks.broadPeak
      - groupby.replicate.macsunmergedbroadpeak.ChIPseqout_peaks.gappedPeak
      - groupby.replicate.macsunmergednarrowpeak.ChIPseqout_peaks.narrowPeak
      - bedcorrelate.broadintersect.bed
      - bedcorrelate.gappedintersect.bed
      - bedcorrelate.narrowintersect.bed
      - bedcorrelate.broadintersect2.bed
      - bedcorrelate.gappedintersect2.bed
      - bedcorrelate.narrowintersect2.bed
      - bedcorrelate.broadintersect.bed
      - bedcorrelate.broadintersect.txt
      - bedcorrelate.gappedintersect.bed
      - bedcorrelate.gappedintersect.txt
      - bedcorrelate.narrowintersect.bed
      - bedcorrelate.narrowintersect.txt
      - bedcorrelate.broadintersect2.bed
      - bedcorrelate.broadintersect.txt
      - bedcorrelate.gappedintersect2.bed
      - bedcorrelate.gappedintersect.txt
      - bedcorrelate.narrowintersect2.bed
      - bedcorrelate.narrowintersect.txt
      - bedcorrelate.broadintersect.bed
      - bedcorrelate.broadintersect2.bed
      - bedcorrelate.broadintersect.txt
      - bedcorrelate.gappedintersect.bed
      - bedcorrelate.gappedintersect2.bed
      - bedcorrelate.gappedintersect.txt
      - bedcorrelate.narrowintersect.bed
      - bedcorrelate.narrowintersect2.bed
      - bedcorrelate.narrowintersect.txt
      - bedcorrelate.err
  bowtie: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tls /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_build/touch /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_buildcast/touch;\n\tif [ PE == \"PE\" ];\n\t\tthen /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/bowtierun -p PE -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/trimgalore/out_1_val_1.fq.gz -2 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/trimgalore/out_2_val_2.fq.gz -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie/out.sam -s C57BL6J;\n\telse /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/bowtierun -p PE -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/trimgalore/out_1_val_1.fq.gz -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie/out.sam -s C57BL6J;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie/err"
    condition: ~
    cores: 14
    mem: 7000
    placeholders: 
      - bowtie
      - bowtie_build.touch
      - bowtie_buildcast.touch
      - datasource.SE_PE
      - software.bowtierun
      - datasource.SE_PE
      - trimgalore.output2
      - trimgalore.output4
      - bowtie.out.sam
      - datasource.Strain
      - software.bowtierun
      - datasource.SE_PE
      - trimgalore.output2
      - bowtie.out.sam
      - datasource.Strain
      - bowtie.err
  bowtie_build: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_build;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;trap SomeErrorHandler ERR; gunzip -f /lustre/scratch109/sanger/rg12/genome/C57BL6J/mm10_C57BL6.fa.gz;\tbowtie2-build -f /lustre/scratch109/sanger/rg12/genome/C57BL6J/mm10_C57BL6.fa /lustre/scratch109/sanger/rg12/genome/C57BL6J_indexed/C57BL6J;\n\tgzip /lustre/scratch109/sanger/rg12/genome/C57BL6J/mm10_C57BL6.fa;\n\ttouch /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_build/touch 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_build/err"
    condition: once
    mem: 5000
    placeholders: 
      - bowtie_build
      - bowtie_build.touch
      - bowtie_build.err
  bowtie_buildcast: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_buildcast;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;trap SomeErrorHandler ERR; gunzip -f /lustre/scratch109/sanger/rg12/genome/CASTEiJ/mm10_CAST.fa.gz;\tbowtie2-build -f /lustre/scratch109/sanger/rg12/genome/CASTEiJ/mm10_CAST.fa /lustre/scratch109/sanger/rg12/genome/CASTEiJ_indexed/CASTEiJ;\n\tgzip /lustre/scratch109/sanger/rg12/genome/CASTEiJ/mm10_CAST.fa;\n\ttouch /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_buildcast/touch 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_buildcast/err"
    condition: once
    mem: 5000
    placeholders: 
      - bowtie_buildcast
      - bowtie_buildcast.touch
      - bowtie_buildcast.err
  bowtieinp: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtieinp;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tls /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_build/touch /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_buildcast/touch;\n\tif [ PE == \"PE\" ];\n\t\tthen /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/bowtierun -p PE -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/trimgaloreinp/out_1_val_1.fq.gz -2 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/trimgaloreinp/out_2_val_2.fq.gz -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtieinp/out.sam -s C57BL6J;\n\telse /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/bowtierun -p PE -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/trimgaloreinp/out_1_val_1.fq.gz -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtieinp/out.sam -s C57BL6J;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtieinp/err"
    condition: ~
    cores: 14
    mem: 7000
    placeholders: 
      - bowtieinp
      - bowtie_build.touch
      - bowtie_buildcast.touch
      - datasource.SE_PE
      - software.bowtierun
      - datasource.SE_PE
      - trimgaloreinp.output2
      - trimgaloreinp.output4
      - bowtieinp.out.sam
      - datasource.Strain
      - software.bowtierun
      - datasource.SE_PE
      - trimgaloreinp.output2
      - bowtieinp.out.sam
      - datasource.Strain
      - bowtieinp.err
  createhub: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/createhub;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc; \ttrap SomeErrorHandler ERR;\n \ttest -e /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmerged/ChIPseqout_peaks.narrowPeak /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmerged/ChIPseqout_peaks.narrowPeak /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmerged/ChIPseqout_peaks.narrowPeak /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmerged/ChIPseqout_peaks.narrowPeak /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmerged/ChIPseqout_peaks.narrowPeak /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmerged/ChIPseqout_peaks.narrowPeak /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmerged/ChIPseqout_peaks.narrowPeak /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmerged/ChIPseqout_peaks.narrowPeak;\n \tnames=\"BM_B_4M_R BM_B_9M_R BM_B_20M_R BM_B_36M_R BM_T_4M_R BM_T_9M_R BM_T_20M_R BM_T_36M_R\";\n \tnames1=$(echo $names | sed -r 's/([a-zA-Z0-9_]+)/&-narrowout/g');\n \tnames2=$(echo $names | sed -r 's/([a-zA-Z0-9_]+)/&-broadout/g');\n \tnames3=$(echo $names | sed -r 's/([a-zA-Z0-9_]+)/&-gappedout/g');\n \t#names=$(echo $names1 $names2 $names3);\n \tlength=($names1);\n \ti=${#length[@]};\n \tpeaks=$(perl -E \"print 'narrow ' x $i; print 'broad ' x $i; print 'gapped ' x $i\");\n \tnarrowpeaks=$(perl -E \"print 'narrow ' x $i;\");\n \tbroadpeaks=$(perl -E \"print 'broad ' x $i;\");\n \tgappedpeaks=$(perl -E \"print 'gapped ' x $i\");\n \tbedfilestreat=$(echo $names | sed -r 's/([a-zA-Z0-9_]+)/&-ChIPseqout_treat_pileup.bdg/g');\n \tbedfilescontr=$(echo $names | sed -r 's/([a-zA-Z0-9_]+)/&-ChIPseqout_control_lambda.bdg/g');\n \tbwfiles=$(echo $names | sed -r 's/([a-zA-Z0-9_]+)/&-FoldE.bw/g');\n\n \trunnum=$(echo \"/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmerged/ChIPseqout_peaks.narrowPeak\" |sed -r 's/.*run([0-9]+).*/\\1/');\n \t###\n\teval echo \"createtrack.pl --vocab_url \\'ftp://ngs.sanger.ac.uk/scratch/project/rg12/bp-vocab-2910141000.json\\' --sexes \\'M M M M M M M M\\' --strain \\'BL6 BL6 BL6 BL6 BL6 BL6 BL6 BL6\\' --cell_types \\'B B B B T T T T\\' --hmark \\'4M 9M 20M 36M 4M 9M 20M 36M\\' --replicate \\'b b b b b b b b\\' --peak \\'$narrowpeaks\\' --url_names \\'$names1\\' --type \\'hammock\\' --base_url \\'ftp://ngs.sanger.ac.uk/scratch/project/rg12/ChIPseq/symlink/macsunmergednarrowpeak/$runnum\\' --url_suffix \\'.gz\\' \\> narrow.hub;\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/createhub/out;\n\teval echo \"createtrack.pl --vocab_url \\'ftp://ngs.sanger.ac.uk/scratch/project/rg12/bp-vocab-2910141000.json\\' --sexes \\'M M M M M M M M\\' --strain \\'BL6 BL6 BL6 BL6 BL6 BL6 BL6 BL6\\' --cell_types \\'B B B B T T T T\\' --hmark \\'4M 9M 20M 36M 4M 9M 20M 36M\\' --replicate \\'b b b b b b b b\\' --peak \\'$broadpeaks\\' --url_names \\'$names2\\' --type \\'hammock\\' --base_url \\'ftp://ngs.sanger.ac.uk/scratch/project/rg12/ChIPseq/symlink/macsunmergedbroadpeak/$runnum\\' --url_suffix \\'.gz\\' \\> broad.hub;\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/createhub/out;\n\teval echo \"createtrack.pl --vocab_url \\'ftp://ngs.sanger.ac.uk/scratch/project/rg12/bp-vocab-2910141000.json\\' --sexes \\'M M M M M M M M\\' --strain \\'BL6 BL6 BL6 BL6 BL6 BL6 BL6 BL6\\' --cell_types \\'B B B B T T T T\\' --hmark \\'4M 9M 20M 36M 4M 9M 20M 36M\\' --replicate \\'b b b b b b b b\\' --peak \\'$gappedpeaks\\' --url_names \\'$names3\\' --type \\'hammock\\' --base_url \\'ftp://ngs.sanger.ac.uk/scratch/project/rg12/ChIPseq/symlink/macsunmergedbroadpeak/$runnum\\' --url_suffix \\'.gz\\' \\> gapped.hub;\">> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/createhub/out;\n \t###\n \t#Alignment\n \teval echo \"createtrack.pl --vocab_url \\'ftp://ngs.sanger.ac.uk/scratch/project/rg12/bp-vocab-2910141000.json\\' --sexes \\'M M M M M M M M\\' --strain \\'BL6 BL6 BL6 BL6 BL6 BL6 BL6 BL6\\' --cell_types \\'B B B B T T T T\\' --hmark \\'4M 9M 20M 36M 4M 9M 20M 36M\\' --replicate \\'b b b b b b b b\\'  --url_names \\'$bedfilestreat\\' --type \\'bedgraph\\' --base_url \\'ftp://ngs.sanger.ac.uk/scratch/project/rg12/ChIPseq/symlink/macsunmergednarrowpeak/$runnum\\' --url_suffix \\'.gz\\'\\> treatout.hub; \" >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/createhub/out;\n \teval echo \"createtrack.pl --vocab_url \\'ftp://ngs.sanger.ac.uk/scratch/project/rg12/bp-vocab-2910141000.json\\' --sexes \\'M M M M M M M M\\' --strain \\'BL6 BL6 BL6 BL6 BL6 BL6 BL6 BL6\\' --cell_types \\'B B B B T T T T\\' --hmark \\'4M 9M 20M 36M 4M 9M 20M 36M\\' --replicate \\'b b b b b b b b\\'  --url_names \\'$bedfilescontr\\' --type \\'bedgraph\\' --base_url \\'ftp://ngs.sanger.ac.uk/scratch/project/rg12/ChIPseq/symlink/macsunmergednarrowpeak/$runnum\\' --url_suffix \\'.gz\\' \\> controlout.hub;\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/createhub/out;\n \teval echo \"createtrack.pl --vocab_url \\'ftp://ngs.sanger.ac.uk/scratch/project/rg12/bp-vocab-2910141000.json\\' --sexes \\'M M M M M M M M\\' --strain \\'BL6 BL6 BL6 BL6 BL6 BL6 BL6 BL6\\' --cell_types \\'B B B B T T T T\\' --hmark \\'4M 9M 20M 36M 4M 9M 20M 36M\\' --replicate \\'b b b b b b b b\\'  --url_names \\'$bwfiles\\' --type \\'bigwig\\' --base_url \\'ftp://ngs.sanger.ac.uk/scratch/project/rg12/ChIPseq/symlink/macsunmergednarrowpeak/$runnum\\' \\> folde.hub;\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/createhub/out; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/createhub/err"
    condition: once
    mem: 5000
    placeholders: 
      - createhub
      - jobs.macsunmerged.output1
      - jobs.datasource.Name
      - macsunmerged.output1
      - jobs.datasource.Sex_letter
      - jobs.datasource.Strain_short
      - jobs.datasource.Cell
      - jobs.datasource.Mark
      - jobs.datasource.repeat
      - createhub.out
      - jobs.datasource.Sex_letter
      - jobs.datasource.Strain_short
      - jobs.datasource.Cell
      - jobs.datasource.Mark
      - jobs.datasource.repeat
      - createhub.out
      - jobs.datasource.Sex_letter
      - jobs.datasource.Strain_short
      - jobs.datasource.Cell
      - jobs.datasource.Mark
      - jobs.datasource.repeat
      - createhub.out
      - jobs.datasource.Sex_letter
      - jobs.datasource.Strain_short
      - jobs.datasource.Cell
      - jobs.datasource.Mark
      - jobs.datasource.repeat
      - createhub.out
      - jobs.datasource.Sex_letter
      - jobs.datasource.Strain_short
      - jobs.datasource.Cell
      - jobs.datasource.Mark
      - jobs.datasource.repeat
      - createhub.out
      - jobs.datasource.Sex_letter
      - jobs.datasource.Strain_short
      - jobs.datasource.Cell
      - jobs.datasource.Mark
      - jobs.datasource.repeat
      - createhub.out
      - createhub.err
  createhubgroup: 
    cmd: cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/createhubgroup;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc; 	#ls * | grep -v err | xargs rm -rf; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/createhubgroup/err
    condition: groupby
    condition_params: 
      - Mark
    mem: 5000
    placeholders: 
      - createhubgroup
      - createhubgroup.err
  fastquality: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/fastquality;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tgunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/trimgalore/out_1_val_1.fq.gz | fastx_quality_stats -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/fastquality/out1;\n\tfastq_quality_boxplot_graph.sh -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/fastquality/out1 -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/fastquality/out1.png -t BM_B_4M_R_read1;\n\tgunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/trimgaloreinp/out_1_val_1.fq.gz | fastx_quality_stats -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/fastquality/Inpout1;\n\tfastq_quality_boxplot_graph.sh -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/fastquality/Inpout1 -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/fastquality/Inpout1.png -t BM_B_4M_R_input_read1;\n\tif [ PE == \"PE\" ];\n\tthen gunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/trimgalore/out_2_val_2.fq.gz | fastx_quality_stats -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/fastquality/out2;\n\t\tfastq_quality_boxplot_graph.sh -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/fastquality/out2 -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/fastquality/out2.png -t BM_B_4M_R_read2;\n\t\tgunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/trimgaloreinp/out_2_val_2.fq.gz | fastx_quality_stats -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/fastquality/Inpout2;\n\t\tfastq_quality_boxplot_graph.sh -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/fastquality/Inpout2 -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/fastquality/Inpout2.png -t BM_B_4M_R_input_read2;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/fastquality/err"
    condition: ~
    mem: 50
    placeholders: 
      - fastquality
      - trimgalore.output2
      - fastquality.out1
      - fastquality.out1
      - fastquality.out1.png
      - datasource.Name
      - trimgaloreinp.output2
      - fastquality.Inpout1
      - fastquality.Inpout1
      - fastquality.Inpout1.png
      - datasource.Name
      - datasource.SE_PE
      - trimgalore.output4
      - fastquality.out2
      - fastquality.out2
      - fastquality.out2.png
      - datasource.Name
      - trimgaloreinp.output4
      - fastquality.Inpout2
      - fastquality.Inpout2
      - fastquality.Inpout2.png
      - datasource.Name
      - fastquality.err
  macsmergedbroad: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergedbroad;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tlast=$(tail -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bedcorrelate/broadintersect.txt);\n\tint=${last%.*};\n\tif [ $int -gt 75 ];\n\t\tthen macs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -q 0.01 --broad --broad-cutoff 0.1 --fix-bimodal --extsize 250 --keep-dup auto;\n\t\t###\n\t\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergedbroad/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergedbroad/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergedbroad/FoldE.bdg -m FE\";\n\t\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergedbroad/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergedbroad/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergedbroad/FoldE.bdg -m FE;\n\t\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergedbroad/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergedbroad/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergedbroad/logLR.bdg -m logLR -p 0.00001\";\n\t\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergedbroad/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergedbroad/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergedbroad/logLR.bdg -m logLR -p 0.00001;\n\t\t###\n\t\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergedbroad/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\t\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergedbroad/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergedbroad/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\t\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergedbroad/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t\t###\n\t\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergedbroad/ChIPseqout_model.r;\n\t\tbroadpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergedbroad/ChIPseqout_peaks.broadPeak broadout;\n\t\tgappedpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergedbroad/ChIPseqout_peaks.gappedPeak gappedout;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergedbroad/err"
    condition: groupby
    condition_params: 
      - replicate
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.broadPeak
      - ChIPseqout_peaks.gappedPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
    placeholders: 
      - macsmergedbroad
      - datasource.SE_PE
      - bedcorrelate.broadintersect.txt
      - groupby.replicate.samtoolsview.out.sorted.bam
      - groupby.replicate.samtoolsviewInp.out.sorted.bam
      - datasource.sonication
      - macsmergedbroad.output4
      - macsmergedbroad.output5
      - macsmergedbroad.FoldE.bdg
      - macsmergedbroad.output4
      - macsmergedbroad.output5
      - macsmergedbroad.FoldE.bdg
      - macsmergedbroad.output4
      - macsmergedbroad.output5
      - macsmergedbroad.logLR.bdg
      - macsmergedbroad.output4
      - macsmergedbroad.output5
      - macsmergedbroad.logLR.bdg
      - macsmergedbroad.FoldE.bdg
      - input.mm10.len
      - macsmergedbroad.FoldE.bdg
      - input.mm10.len
      - macsmergedbroad.logLR.bdg
      - input.mm10.len
      - macsmergedbroad.logLR.bdg
      - input.mm10.len
      - macsmergedbroad.output3
      - macsmergedbroad.output1
      - macsmergedbroad.output2
      - macsmergedbroad.err
  macsmergednarrow: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergednarrow;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tlast=$(tail -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bedcorrelate/narrowintersect.txt);\n\tint=${last%.*};\n\tif [ $int -gt 75 ];\n\t\tthen macs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -q 0.01 --fix-bimodal --extsize 250 --keep-dup auto;\n\t\t###\n\t\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergednarrow/ChIPseqout_control_lambda.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergednarrow/FoldE.bw -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergednarrow/FoldE.bdg -m FE\";\n\t\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergednarrow/ChIPseqout_control_lambda.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergednarrow/FoldE.bw -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergednarrow/FoldE.bdg -m FE;\n\t\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergednarrow/ChIPseqout_control_lambda.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergednarrow/FoldE.bw -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergednarrow/logLR.bdg -m logLR -p 0.00001\";\n\t\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergednarrow/ChIPseqout_control_lambda.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergednarrow/FoldE.bw -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergednarrow/logLR.bdg -m logLR -p 0.00001;\n\t\t###\n\t\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergednarrow/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\t\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergednarrow/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergednarrow/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\t\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergednarrow/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t\t###\n\t\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergednarrow/ChIPseqout_model.r;\n\t\tnarrowpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergednarrow/ChIPseqout_peaks.narrowPeak narrowout;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsmergednarrow/err"
    condition: groupby
    condition_params: 
      - replicate
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.narrowPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
    placeholders: 
      - macsmergednarrow
      - datasource.SE_PE
      - bedcorrelate.narrowintersect.txt
      - groupby.replicate.samtoolsview.out.sorted.bam
      - groupby.replicate.samtoolsviewInp.out.sorted.bam
      - datasource.sonication
      - macsmergednarrow.output4
      - macsmergednarrow.output5
      - macsmergednarrow.FoldE.bdg
      - macsmergednarrow.output4
      - macsmergednarrow.output5
      - macsmergednarrow.FoldE.bdg
      - macsmergednarrow.output4
      - macsmergednarrow.output5
      - macsmergednarrow.logLR.bdg
      - macsmergednarrow.output4
      - macsmergednarrow.output5
      - macsmergednarrow.logLR.bdg
      - macsmergednarrow.FoldE.bdg
      - input.mm10.len
      - macsmergednarrow.FoldE.bdg
      - input.mm10.len
      - macsmergednarrow.logLR.bdg
      - input.mm10.len
      - macsmergednarrow.logLR.bdg
      - input.mm10.len
      - macsmergednarrow.output2
      - macsmergednarrow.output1
      - macsmergednarrow.err
  macsunmerged: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmerged;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; \tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tmacs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -p 1 --fix-bimodal --extsize 250 --keep-dup auto; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmerged/err"
    condition: ~
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.narrowPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
    placeholders: 
      - macsunmerged
      - datasource.SE_PE
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.sonication
      - macsunmerged.err
  macsunmergedbroadpeak: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergedbroadpeak;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; ls * | grep -v err | xargs rm -rf;\t. /nfs/users/nfs_r/rg12/.bashrc;\n\ttrap SomeErrorHandler ERR;\n\tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tmacs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -q 0.05 --broad --broad-cutoff 0.1 --fix-bimodal --extsize 250 --keep-dup auto;\n\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergedbroadpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergedbroadpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergedbroadpeak/FoldE.bdg -m FE\";\n\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergedbroadpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergedbroadpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergedbroadpeak/FoldE.bdg -m FE;\n\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergedbroadpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergedbroadpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergedbroadpeak/logLR.bdg -m logLR -p 0.00001\";\n\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergedbroadpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergedbroadpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergedbroadpeak/logLR.bdg -m logLR -p 0.00001;\n\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergedbroadpeak/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergedbroadpeak/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergedbroadpeak/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergedbroadpeak/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t>&2 echo \"Rscript\";\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergedbroadpeak/ChIPseqout_model.r;\n\tbroadpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergedbroadpeak/ChIPseqout_peaks.broadPeak broadout;\n\tgappedpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak gappedout;\n\tbedtools genomecov -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergedbroadpeak/ChIPseqout_peaks.broadPeak -g /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len -bg > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergedbroadpeak/broad.bdg;\n\tbedtools genomecov -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak -g /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len -bg > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergedbroadpeak/gapped.bdg; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergedbroadpeak/err"
    condition: ~
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.broadPeak
      - ChIPseqout_peaks.gappedPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
    placeholders: 
      - macsunmergedbroadpeak
      - datasource.SE_PE
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.sonication
      - macsunmergedbroadpeak.output4
      - macsunmergedbroadpeak.output5
      - macsunmergedbroadpeak.FoldE.bdg
      - macsunmergedbroadpeak.output4
      - macsunmergedbroadpeak.output5
      - macsunmergedbroadpeak.FoldE.bdg
      - macsunmergedbroadpeak.output4
      - macsunmergedbroadpeak.output5
      - macsunmergedbroadpeak.logLR.bdg
      - macsunmergedbroadpeak.output4
      - macsunmergedbroadpeak.output5
      - macsunmergedbroadpeak.logLR.bdg
      - macsunmergedbroadpeak.FoldE.bdg
      - input.mm10.len
      - macsunmergedbroadpeak.FoldE.bdg
      - input.mm10.len
      - macsunmergedbroadpeak.logLR.bdg
      - input.mm10.len
      - macsunmergedbroadpeak.logLR.bdg
      - input.mm10.len
      - macsunmergedbroadpeak.output3
      - macsunmergedbroadpeak.output1
      - macsunmergedbroadpeak.output2
      - macsunmergedbroadpeak.output1
      - input.mm10.len
      - macsunmergedbroadpeak.broad.bdg
      - macsunmergedbroadpeak.output2
      - input.mm10.len
      - macsunmergedbroadpeak.gapped.bdg
      - macsunmergedbroadpeak.err
  macsunmergednarrowpeak: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergednarrowpeak;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; ls * | grep -v err | xargs rm -rf;\t. /nfs/users/nfs_r/rg12/.bashrc;\n\ttrap SomeErrorHandler ERR;\n\tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tmacs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -q 0.01 --fix-bimodal --extsize 250 --keep-dup auto;\n\t###\n\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergednarrowpeak/FoldE.bdg -m FE\";\n\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergednarrowpeak/FoldE.bdg -m FE;\n\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergednarrowpeak/logLR.bdg -m logLR -p 0.00001\";\n\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergednarrowpeak/logLR.bdg -m logLR -p 0.00001;\n\t###\n\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergednarrowpeak/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergednarrowpeak/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergednarrowpeak/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergednarrowpeak/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t###\n\t>&2 echo \"Rscript\";\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergednarrowpeak/ChIPseqout_model.r;\n\tnarrowpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak narrowout;\n\t###\n\tbgzip /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg;\n\tbgzip /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg;\n\ttabix -p bed /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg.gz;\n\ttabix -p bed /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg.gz;\n\tbedtools genomecov -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak -g /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len -bg > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergednarrowpeak/narrow.bdg; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergednarrowpeak/err"
    condition: ~
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.narrowPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
      - ChIPseqout_treat_pileup.bdg.gz
      - ChIPseqout_control_lambda.bdg.gz
      - ChIPseqout_treat_pileup.bdg.gz.tbi
      - ChIPseqout_control_lambda.bdg.gz.tbi
    placeholders: 
      - macsunmergednarrowpeak
      - datasource.SE_PE
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.sonication
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.FoldE.bdg
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.FoldE.bdg
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.logLR.bdg
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.logLR.bdg
      - macsunmergednarrowpeak.FoldE.bdg
      - input.mm10.len
      - macsunmergednarrowpeak.FoldE.bdg
      - input.mm10.len
      - macsunmergednarrowpeak.logLR.bdg
      - input.mm10.len
      - macsunmergednarrowpeak.logLR.bdg
      - input.mm10.len
      - macsunmergednarrowpeak.output2
      - macsunmergednarrowpeak.output1
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.output7
      - macsunmergednarrowpeak.output8
      - macsunmergednarrowpeak.output1
      - input.mm10.len
      - macsunmergednarrowpeak.narrow.bdg
      - macsunmergednarrowpeak.err
  pdfmerge: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/pdfmerge;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\tls * | grep -v err | xargs rm -rf;\n\ttrap SomeErrorHandler ERR;\n\tpdfunite /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/annotatepeaksgroup/cluster.4.pdf /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/annotatepeaksgroup/cluster.4.pdf Cluster4.pdf;\n\tpdfunite /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/annotatepeaksgroup/cluster.5.pdf /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/annotatepeaksgroup/cluster.5.pdf Cluster5.pdf;\n\tpdfunite /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/annotatepeaksgroup/cluster.6.pdf /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/annotatepeaksgroup/cluster.6.pdf Cluster6.pdf;\n\tpdfunite /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/annotatepeaksgroup/cluster.7.pdf /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/annotatepeaksgroup/cluster.7.pdf Cluster7.pdf;\n\tpdfunite /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/annotatepeaksgroup/cluster.8.pdf /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/annotatepeaksgroup/cluster.8.pdf Cluster8.pdf;\n\tpdfunite /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/annotatepeaksgroup/cluster.9.pdf /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/annotatepeaksgroup/cluster.9.pdf Cluster9.pdf;\n\tpdfunite /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/annotatepeaksgroup/cluster.10.pdf /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/annotatepeaksgroup/cluster.10.pdf Cluster10.pdf; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/pdfmerge/err"
    condition: groupby
    condition_params: 
      - Mark
    cores: 5
    mem: 5000
    placeholders: 
      - pdfmerge
      - groupby.Mark.annotatepeaksgroup.cluster.4.pdf
      - groupby.Mark.annotatepeaksgroup.cluster.5.pdf
      - groupby.Mark.annotatepeaksgroup.cluster.6.pdf
      - groupby.Mark.annotatepeaksgroup.cluster.7.pdf
      - groupby.Mark.annotatepeaksgroup.cluster.8.pdf
      - groupby.Mark.annotatepeaksgroup.cluster.9.pdf
      - groupby.Mark.annotatepeaksgroup.cluster.10.pdf
      - pdfmerge.err
  pie: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/pie;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; ls * | grep -v err | xargs rm -rf;\t. /nfs/users/nfs_r/rg12/.bashrc;\n\ttrap SomeErrorHandler ERR;\n\t#gapped broad output\n\tbedtools intersect -loj -a /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak -b /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/ens_genes_and_promoter_distal.bed > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/pie/out;\n\tbedtools intersect -loj -a /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak -b /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/ens_genes_and_promoter_distal.bed > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/pie/out2;\n\tbedtools intersect -wa -b /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak -a /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/ens_genes_and_promoter_distal.bed > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/pie/out3;\n\tbedtools intersect -wa -b /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak -a /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/ens_genes_and_promoter_distal.bed > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/pie/out4;\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/pie.R $(grep -c Gene /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/pie/out) $(grep -c Distal /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/pie/out) $(grep -c Promoter /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/pie/out) $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/pie/out |wc -l) rplot_broad.pdf > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/pie/broad\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/pie.R $(grep -c Gene /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/pie/out2) $(grep -c Distal /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/pie/out2) $(grep -c Promoter /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/pie/out2) $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/pie/out2 |wc -l) rplot_narrow.pdf > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/pie/narrow\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/pie.R $(grep -c Gene /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/pie/out3) $(grep -c Distal /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/pie/out3) $(grep -c Promoter /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/pie/out3) $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/pie/out3 |wc -l) rplot_gene_broad.pdf > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/pie/gene_broad\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/pie.R $(grep -c Gene /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/pie/out4) $(grep -c Distal /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/pie/out4) $(grep -c Promoter /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/pie/out4) $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/pie/out4 |wc -l) rplot_gene_narrow.pdf > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/pie/gene_narrow 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/pie/err"
    condition: ~
    mem: 5000
    placeholders: 
      - pie
      - macsunmergedbroadpeak.output2
      - input.ens_genes_and_promoter_distal.bed
      - pie.out
      - macsunmergednarrowpeak.output1
      - input.ens_genes_and_promoter_distal.bed
      - pie.out2
      - macsunmergedbroadpeak.output2
      - input.ens_genes_and_promoter_distal.bed
      - pie.out3
      - macsunmergednarrowpeak.output1
      - input.ens_genes_and_promoter_distal.bed
      - pie.out4
      - software.pie.R
      - pie.out
      - pie.out
      - pie.out
      - pie.out
      - pie.broad
      - software.pie.R
      - pie.out2
      - pie.out2
      - pie.out2
      - pie.out2
      - pie.narrow
      - software.pie.R
      - pie.out3
      - pie.out3
      - pie.out3
      - pie.out3
      - pie.gene_broad
      - software.pie.R
      - pie.out4
      - pie.out4
      - pie.out4
      - pie.out4
      - pie.gene_narrow
      - pie.err
  samtoolsview: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/samtoolsview;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\ttest -e /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie/out.sam;\n\tsamtools view -hSb /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie/out.sam> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/samtoolsview/out.bam;\n\tsamtools sort /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/samtoolsview/out.bam out.sorted;\n\tsamtools index /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/samtoolsview/out.sorted.bam;\n\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie/out.sam; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/samtoolsview/err"
    condition: ~
    mem: 2000
    outputfiles: 
      - out.sorted.bam
      - out.sorted.bam.bai
    placeholders: 
      - samtoolsview
      - bowtie.out.sam
      - bowtie.out.sam
      - samtoolsview.out.bam
      - samtoolsview.out.bam
      - samtoolsview.output1
      - bowtie.out.sam
      - samtoolsview.err
  samtoolsviewInp: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/samtoolsviewInp;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\ttest -e /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtieinp/out.sam;\n\tsamtools view -hSb /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtieinp/out.sam > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/samtoolsviewInp/out.bam;\n\tsamtools sort /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/samtoolsviewInp/out.bam out.sorted;\n\tsamtools index /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/samtoolsviewInp/out.sorted.bam;\n\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtieinp/out.sam; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/samtoolsviewInp/err"
    condition: ~
    mem: 2000
    outputfiles: 
      - out.sorted.bam
      - out.sorted.bam.bai
    placeholders: 
      - samtoolsviewInp
      - bowtieinp.out.sam
      - bowtieinp.out.sam
      - samtoolsviewInp.out.bam
      - samtoolsviewInp.out.bam
      - samtoolsviewInp.output1
      - bowtieinp.out.sam
      - samtoolsviewInp.err
  seperateclusters: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/seperateclusters;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\tls * | grep -v err | xargs rm -rf;\n\ttrap SomeErrorHandler ERR;\n\tclusters=4;\n\tcp /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/annotatepeaksgroup/cluster.4.RData /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/seperateclusters/clusters.RData;\n\tExtractGName.R /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/seperateclusters/clusters.RData;\n\t>&2 echo \"cluster1-4\";\n\tfor i in {1..4}\n\tdo\n\t\t>&2 echo \"cluster\" ${i};\n\t\techo -e \"/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/samtoolsviewInp/out.sorted.bam\tclusters.1.cluster${i}.txt\t\\\"H3K4me3 B Cell\\\"\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/seperateclusters/config.txt;\n\t\t>&2 echo \"ngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/seperateclusters/config.txt -O heatmapclusters.${i} -L 5000 -GO total -CO blue:white:red -P 5\";\n\t\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/seperateclusters/config.txt -O heatmapclusters.${i} -L 3000 -GO total -CO blue:white:red -P 5;\n\t\tconvert -density 150 heatmapclusters.${i}.heatmap.pdf -quality 90 heatmapclusters.${i}.heatmap.png;\n\tdone 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/seperateclusters/err"
    condition: ~
    cores: 5
    mem: 5000
    placeholders: 
      - seperateclusters
      - annotatepeaksgroup.output1
      - seperateclusters.clusters.RData
      - seperateclusters.clusters.RData
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.mark_full
      - datasource.Cell
      - seperateclusters.config.txt
      - seperateclusters.config.txt
      - seperateclusters.config.txt
      - seperateclusters.err
  summarystats: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/summarystats;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;trap SomeErrorHandler ERR;\tif [ PE == \"PE\" ];\n\t\tthen if [ TRUE == \"TRUE\" ];\n\t\t\tthen echo \"BM_B_4M_R_lane1\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_4M_R/BM_B_4M_R_1.bam >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/summarystats/out.flagstat;\n\t\t\techo \"BM_B_4M_R_lane2\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_4M_R/BM_B_4M_R_2.bam >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/summarystats/out.flagstat;\n\t\telse echo \"BM_B_4M_R\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/summarystats/out.flagstat;\n\t\t\techo \"FastQ\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/summarystats/out.flagstat;\n\t\tfi;\n\t\tif [ TRUE == \"TRUE\" ];\n\t\t\tthen echo \"Inp_BM_B_4M_R_lane1\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_INP_R/BM_B_INP_R_1.bam >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/summarystats/out.flagstat;\n\t\t\techo \"Inp_BM_B_4M_R_lane2\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_INP_R/BM_B_INP_R_2.bam >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/summarystats/out.flagstat;\n\t\telse echo \"Inp_BM_B_4M_R\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/summarystats/out.flagstat;\n\t\t\techo \"FastQ\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/summarystats/out.flagstat;\n\t\tfi;\n\telse if [ TRUE == \"TRUE\" ]; ### CHECK THIS!! SHOULD be INP_1 and INP_2\n\t\tthen echo \"BM_B_4M_R_lane1\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_4M_R/BM_B_4M_R_1.bam >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/summarystats/out.flagstat;\n\t\t\techo \"BM_B_4M_R_lane2\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_4M_R/BM_B_4M_R_2.bam >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/summarystats/out.flagstat;\n\t\telse echo \"BM_B_4M_R\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/summarystats/out.flagstat;\n\t\t\techo \"FastQ\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/summarystats/out.flagstat;\n\t\tfi;\n\t\tif [ TRUE == \"TRUE\" ];\n\t\t\tthen echo \"Inp_BM_B_4M_R_lane1\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_INP_R/BM_B_INP_R_1.bam >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/summarystats/out.flagstat;\n\t\t\techo \"Inp_BM_B_4M_R_lane2\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_INP_R/BM_B_INP_R_2.bam >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/summarystats/out.flagstat;\n\t\telse echo \"Inp_BM_B_4M_R\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/summarystats/out.flagstat;\n\t\t\techo \"FastQ\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/summarystats/out.flagstat;\n\t\tfi;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/summarystats/err"
    condition: ~
    mem: 1000
    placeholders: 
      - summarystats
      - datasource.SE_PE
      - datasource.bam
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - summarystats.out.flagstat
      - datasource.Inp_bam
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.Inp_location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.Inp_location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - summarystats.out.flagstat
      - datasource.bam
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - summarystats.out.flagstat
      - datasource.Inp_bam
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.Inp_location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.Inp_location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - summarystats.out.flagstat
      - summarystats.err
  symlink: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/symlink;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc; \ttrap SomeErrorHandler ERR;\n \tls /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmerged/ChIPseqout_peaks.narrowPeak /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmerged/ChIPseqout_peaks.narrowPeak /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmerged/ChIPseqout_peaks.narrowPeak /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmerged/ChIPseqout_peaks.narrowPeak /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmerged/ChIPseqout_peaks.narrowPeak /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmerged/ChIPseqout_peaks.narrowPeak /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmerged/ChIPseqout_peaks.narrowPeak /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmerged/ChIPseqout_peaks.narrowPeak;\n \trunnum=$(echo \"/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmerged/ChIPseqout_peaks.narrowPeak\" |sed -r 's/.*run([0-9]+).*/\\1/');\n \t>&2 echo $runnum;\n \tplite symlink -f Name -r $runnum -s summarystats#out.flagstat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n \tplite symlink -f Name -r $runnum -s trimgalore#out_1.fq.gz_trimming_report.txt /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n \tplite symlink -f Name -r $runnum -s trimgalore#out_2.fq.gz_trimming_report.txt /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n \tplite symlink -f Name -r $runnum -s trimgaloreinp#out_1.fq.gz_trimming_report.txt /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n \tplite symlink -f Name -r $runnum -s trimgaloreinp#out_2.fq.gz_trimming_report.txt /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n \tplite symlink -f Name -r $runnum -s bowtie#err /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n \tplite symlink -f Name -r $runnum -s bowtieinp#err /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n \tplite symlink -f Name -r $runnum -s samtoolsview#out.sorted.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n \tplite symlink -f Name -r $runnum -s samtoolsviewInp#out.sorted.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n \tplite symlink -f Name -r $runnum -s samtoolsview#out.sorted.bam.bai /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n \tplite symlink -f Name -r $runnum -s samtoolsviewInp#out.sorted.bam.bai /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n \tplite symlink -f Name -r $runnum -s fastquality#out1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n \tplite symlink -f Name -r $runnum -s fastquality#out1.png /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n \tplite symlink -f Name -r $runnum -s fastquality#out2 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n \tplite symlink -f Name -r $runnum -s fastquality#out2.png /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n \tplite symlink -f Name -r $runnum -s fastquality#Inpout1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n \tplite symlink -f Name -r $runnum -s fastquality#Inpout1.png /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n \tplite symlink -f Name -r $runnum -s fastquality#Inpout2 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n \tplite symlink -f Name -r $runnum -s fastquality#Inpout2.png /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n \t###\n \t###\n\tplite symlink -f Name -r $runnum -s macsunmergednarrowpeak#FoldE.bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n\tplite symlink -f Name -r $runnum -s macsunmergednarrowpeak#logLR.bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n\tplite symlink -f Name -r $runnum -s macsunmergednarrowpeak#ChIPseqout_treat_pileup.bdg.gz /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n\tplite symlink -f Name -r $runnum -s macsunmergednarrowpeak#ChIPseqout_treat_pileup.bdg.gz.tbi /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n\tplite symlink -f Name -r $runnum -s macsunmergednarrowpeak#ChIPseqout_control_lambda.bdg.gz /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n\tplite symlink -f Name -r $runnum -s macsunmergednarrowpeak#ChIPseqout_control_lambda.bdg.gz.tbi /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n\tplite symlink -f Name -r $runnum -s macsunmergednarrowpeak#narrowout.gz /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n\tplite symlink -f Name -r $runnum -s macsunmergednarrowpeak#narrowout.gz.tbi /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n\tplite symlink -f Name -r $runnum -s macsunmergedbroadpeak#broadout.gz /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n\tplite symlink -f Name -r $runnum -s macsunmergedbroadpeak#broadout.gz.tbi /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n\tplite symlink -f Name -r $runnum -s macsunmergedbroadpeak#gappedout.gz /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n\tplite symlink -f Name -r $runnum -s macsunmergedbroadpeak#gappedout.gz.tbi /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n\tplite symlink -f Name -r $runnum -s macsunmergedbroadpeak#broad.bdg.tbi /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n\tplite symlink -f Name -r $runnum -s macsunmergedbroadpeak#gapped.bdg.tbi /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n\tplite symlink -f Name -r $runnum -s macsunmergednarrowpeak#narrow.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n\tplite symlink -f Name -r $runnum -s macsunmergedbroadpeak#ChIPseqout_peaks.gappedPeak /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n\tplite symlink -f Name -r $runnum -s macsunmergednarrowpeak#ChIPseqout_peaks.xls /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n\tplite symlink -f Name -r $runnum -s macsunmergedbroadpeak#ChIPseqout_peaks.xls /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n\t#plite symlink -f Mark -r $runnum -s createhubgroup#out /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n\tplite symlink -f Mark -r $runnum -s createhub#out /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n\tplite symlink -f Name -r $runnum -s annotatepeaks#out.heatmap.pdf /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n\tplite symlink -f Name -r $runnum -s annotatepeaks#out.avgprof.pdf /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n\tplite symlink -f Name -r $runnum -s annotatepeaks#clusters.heatmap.pdf /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n\tplite symlink -f Name -r $runnum -s annotatepeaks#clusters.avgprof.pdf /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n\tplite symlink -f Name -r $runnum -s annotatepeaks#TPMorderedT.heatmap.pdf /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/;\n\tplite symlink -f Name -r $runnum -s annotatepeaks#TPMorderedB.heatmap.pdf  /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/symlink/err"
    condition: once
    mem: 5000
    placeholders: 
      - symlink
      - jobs.macsunmerged.output1
      - macsunmerged.output1
      - symlink.err
  trimgalore: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/trimgalore;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tlength=$(gunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofq/out_1.fq.gz | head -2| tail -1 | wc -c);\n\tlength=$[length-11];\n\tif [ PE == \"PE\" ];\n\tthen\n\t\ttrim_galore --fastqc --gzip --length $length --paired -a ATCACGTT --stringency 4 --trim1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofq/out_1.fq.gz /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofq/out_2.fq.gz;\n\telse\n\t\ttrim_galore --fastqc --gzip --length $length -a ATCACGTT --stringency 4 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofq/out_1.fq.gz;\n\n\t\tmv out_1_trimmed.fq.gz out_1_val_1.fq.gz;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/trimgalore/err"
    condition: ~
    cores: 3
    mem: 2000
    outputfiles: 
      - out_1.fq.gz_trimming_report.txt
      - out_1_val_1.fq.gz
      - out_2.fq.gz_trimming_report.txt
      - out_2_val_2.fq.gz
      - out_1_val_1.html
      - out_1_val_1.zip
      - out_2_val_2.html
      - out_2_val_2.zip
    placeholders: 
      - trimgalore
      - bamtofq.out_1.fq.gz
      - datasource.SE_PE
      - datasource.Tag
      - bamtofq.out_1.fq.gz
      - bamtofq.out_2.fq.gz
      - datasource.Tag
      - bamtofq.out_1.fq.gz
      - trimgalore.err
  trimgaloreinp: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/trimgaloreinp;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tlength=$(gunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofqinp/out_1.fq.gz | head -2| tail -1 | wc -c);\n\tlength=$[length-11];\n\tif [ PE == \"PE\" ];\n\tthen\n\t\ttrim_galore --fastqc --gzip --length $length --paired -a GATCAGCG --stringency 4 --trim1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofqinp/out_1.fq.gz /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofqinp/out_2.fq.gz;\n\telse\n\t\ttrim_galore --fastqc --gzip --length $length -a GATCAGCG --stringency 4 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bamtofqinp/out_1.fq.gz;\n\t\tmv out_1_trimmed.fq.gz out_1_val_1.fq.gz; ### should FIX\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/trimgaloreinp/err"
    condition: ~
    cores: 3
    mem: 2000
    outputfiles: 
      - out_1.fq.gz_trimming_report.txt
      - out_1_val_1.fq.gz
      - out_2.fq.gz_trimming_report.txt
      - out_2_val_2.fq.gz
      - out_1_val_1.html
      - out_1_val_1.zip
      - out_2_val_2.html
      - out_2_val_2.zip
    placeholders: 
      - trimgaloreinp
      - bamtofqinp.out_1.fq.gz
      - datasource.SE_PE
      - datasource.Inp_Tag
      - bamtofqinp.out_1.fq.gz
      - bamtofqinp.out_2.fq.gz
      - datasource.Inp_Tag
      - bamtofqinp.out_1.fq.gz
      - trimgaloreinp.err
  wigcorrelate: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/wigcorrelate;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tls /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergedbroadpeak/FoldE.bw;\n\tlength=(/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergedbroadpeak/FoldE.bw);\n\t#Change FoldE.bw to output16\n\tif [ ${#length[@]} != 1 ];\n\t\tthen\n\t\twigCorrelate /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmerged/FoldE.bw > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/wigcorrelate/out;\n\tfi; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/wigcorrelate/err"
    condition: groupby
    condition_params: 
      - replicate
    cores: 4
    mem: 5000
    placeholders: 
      - wigcorrelate
      - macsunmergedbroadpeak.output6
      - groupby.replicate.macsunmergedbroadpeak.FoldE.bw
      - groupby.replicate.macsunmerged.FoldE.bw
      - wigcorrelate.out
      - wigcorrelate.err
  wigcorrelateall: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/wigcorrelateall;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\t## ONLY SAYS HOW THE ALIGNMENT CORRELATES\n\t>&2 echo \"wigCorrelate macsunmergedbroadpeak FoldE\";\n\twigCorrelate /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergedbroadpeak/FoldE.bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergedbroadpeak/FoldE.bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergedbroadpeak/FoldE.bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergedbroadpeak/FoldE.bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergedbroadpeak/FoldE.bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergedbroadpeak/FoldE.bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergedbroadpeak/FoldE.bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergedbroadpeak/FoldE.bw > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/wigcorrelateall/macsunmergedbroadpeak_FoldE.txt;\n\t>&2 echo \"wigCorrelate macsunmergedbroadpeak LogLR\";\n\twigCorrelate /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergedbroadpeak/logLR.bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergedbroadpeak/logLR.bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergedbroadpeak/logLR.bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergedbroadpeak/logLR.bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergedbroadpeak/logLR.bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergedbroadpeak/logLR.bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergedbroadpeak/logLR.bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergedbroadpeak/logLR.bw > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/wigcorrelateall/macsunmergedbroadpeak_logLR.txt;\n\t>&2 echo \"wigCorrelate macsunmergednarrowpeak FoldE\";\n\twigCorrelate /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergednarrowpeak/FoldE.bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergednarrowpeak/FoldE.bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergednarrowpeak/FoldE.bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergednarrowpeak/FoldE.bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergednarrowpeak/FoldE.bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergednarrowpeak/FoldE.bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergednarrowpeak/FoldE.bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergednarrowpeak/FoldE.bw > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/wigcorrelateall/macsunmergednarrowpeak_FoldE.txt;\n\t>&2 echo \"wigCorrelate macsunmergednarrowpeak LogLR\";\n\twigCorrelate /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergednarrowpeak/logLR.bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergednarrowpeak/logLR.bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergednarrowpeak/logLR.bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergednarrowpeak/logLR.bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergednarrowpeak/logLR.bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergednarrowpeak/logLR.bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergednarrowpeak/logLR.bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergednarrowpeak/logLR.bw > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/wigcorrelateall/macsunmergednarrowpeak_logLR.txt; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/wigcorrelateall/err"
    condition: once
    cores: 4
    mem: 5000
    placeholders: 
      - wigcorrelateall
      - jobs.macsunmergedbroadpeak.output6
      - wigcorrelateall.macsunmergedbroadpeak_FoldE.txt
      - jobs.macsunmergedbroadpeak.output7
      - wigcorrelateall.macsunmergedbroadpeak_logLR.txt
      - jobs.macsunmergednarrowpeak.output5
      - wigcorrelateall.macsunmergednarrowpeak_FoldE.txt
      - jobs.macsunmergednarrowpeak.output6
      - wigcorrelateall.macsunmergednarrowpeak_logLR.txt
      - wigcorrelateall.err
1: 
  annotatepeaks: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/annotatepeaks;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\tls * | grep -v err | xargs rm -rf;\n\ttrap SomeErrorHandler ERR;\n\tclusters=4\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/samtoolsviewInp/out.sorted.bam -T \"H3K9me3 B Cell\" -O out -L 3000 -GO km -KNC ${clusters} -CO blue:white:red -P 5 -FI 1;\n\t/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/ExtractGeneClusterings.r out;\n\tfor i in $(seq 1 ${clusters});\n\tdo\n\t\techo -e \"/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/samtoolsviewInp/out.sorted.bam\tout.cluster${i}.txt\t\\\"H3K9me3 B Cell Cluster${i}\\\"\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/annotatepeaks/config.txt;\n\tdone\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/annotatepeaks/config.txt -O clusters -L 3000 -GO hc -CO blue:white:red -P 5;\n\tcat > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/annotatepeaks/configB.txt << EOF\n/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/samtoolsviewInp/out.sorted.bam\t/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/B_ordered_TPM.txt\t\"H3K9me3 B cell\"\nEOF\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/annotatepeaks/configB.txt -O TPMorderedB -L 3000 -GO none -CO blue:white:red -P 5;\n\tcat > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/annotatepeaks/configT.txt << EOF\n/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/samtoolsviewInp/out.sorted.bam\t/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/T_ordered_TPM.txt\t\"H3K9me3 T cell\"\nEOF\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/annotatepeaks/configT.txt -O TPMorderedT -L 3000 -GO none -CO blue:white:red -P 5; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/annotatepeaks/err"
    condition: ~
    cores: 5
    mem: 5000
    placeholders: 
      - annotatepeaks
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.mark_full
      - datasource.Cell
      - software.ExtractGeneClusterings.r
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.mark_full
      - datasource.Cell
      - annotatepeaks.config.txt
      - annotatepeaks.config.txt
      - annotatepeaks.configB.txt
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - input.B_ordered_TPM.txt
      - datasource.mark_full
      - annotatepeaks.configB.txt
      - annotatepeaks.configT.txt
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - input.T_ordered_TPM.txt
      - datasource.mark_full
      - annotatepeaks.configT.txt
      - annotatepeaks.err
  annotatepeaksgroup: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/annotatepeaksgroup;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\tls * | grep -v err | xargs rm -rf;\n\ttrap SomeErrorHandler ERR;\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/samtoolsviewInp/out.sorted.bam -T \"H3K9me3 B Cell\" -O out -L 3000 -CO blue:white:red -P 5 -FI 0;\n\tfor clusters in {4..10};\n\t\tdo name=\"cluster.${clusters}\";\n\t\treplot.r heatmap -I out.zip -O ${name} -T \"H3K9me3 B Cell\" -L 3000 -GO km -KNC ${clusters} -CO blue:white:red -P 5;\n\t\tExtractGName.R ${name}.RData;\n\tdone 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/annotatepeaksgroup/err"
    condition: ~
    cores: 5
    mem: 5000
    outputfiles: 
      - cluster.4.RData
    placeholders: 
      - annotatepeaksgroup
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.mark_full
      - datasource.Cell
      - datasource.mark_full
      - datasource.Cell
      - annotatepeaksgroup.err
  bamtofq: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofq;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;trap SomeErrorHandler ERR;\tif [ TRUE == \"TRUE\" ];\n\t\tthen samtools sort /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_9M_R/BM_B_9M_R_1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofq/lane1;\n\t\tsamtools sort /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_9M_R/BM_B_9M_R_2.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofq/lane2;\n\t\tsamtools merge /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofq/merged.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofq/lane1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofq/lane2.bam;\n\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofq/lane1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofq/lane2.bam;\n\t\tif [ PE == \"PE\" ];\n\t\t\tthen\n\t\t\t\tbamtofastq filename=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofq/merged.bam gz=1 F=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofq/out_1.fq.gz F2=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofq/out_2.fq.gz;\n\t\t\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofq/merged.bam;\n\t\t\telse\n\t\t\t\tbamtofastq gz=1 filename=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofq/merged.bam > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofq/out_1.fq.gz;\n\t\t\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofq/merged.bam;\n\t\t\tfi;\n\t\telse\n\t\t\tcat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_9M_R/BM_B_9M_R* > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofq/out_1.fq.gz;\n\t\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofq/err"
    condition: ~
    mem: 1500
    placeholders: 
      - bamtofq
      - datasource.bam
      - datasource.location
      - bamtofq.lane1
      - datasource.location
      - bamtofq.lane2
      - bamtofq.merged.bam
      - bamtofq.lane1
      - bamtofq.lane2
      - bamtofq.lane1
      - bamtofq.lane2
      - datasource.SE_PE
      - bamtofq.merged.bam
      - bamtofq.out_1.fq.gz
      - bamtofq.out_2.fq.gz
      - bamtofq.merged.bam
      - bamtofq.merged.bam
      - bamtofq.out_1.fq.gz
      - bamtofq.merged.bam
      - datasource.location
      - bamtofq.out_1.fq.gz
      - bamtofq.err
  bamtofqinp: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofqinp;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;trap SomeErrorHandler ERR;\tif [ TRUE == \"TRUE\" ];\n\t\tthen samtools sort /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_INP_R/BM_B_INP_R_1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofqinp/lane1;\n\t\tsamtools sort /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_INP_R/BM_B_INP_R_2.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofqinp/lane2;\n\t\tsamtools merge /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofqinp/merged.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofqinp/lane1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofqinp/lane2.bam;\n\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofqinp/lane1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofqinp/lane2.bam;\n\t\tif [ PE == \"PE\" ];\n\t\t\tthen\n\t\t\t\tbamtofastq gz=1 filename=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofqinp/merged.bam F=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofqinp/out_1.fq.gz F2=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofqinp/out_2.fq.gz;\n\t\t\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofqinp/merged.bam;\n\t\t\telse bamtofastq gz=1 filename=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofqinp/merged.bam > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofqinp/out_1.fq.gz;\n\t\t\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofqinp/merged.bam;\n\t\tfi;\n\telse cat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_INP_R/BM_B_INP_R* > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofqinp/out_1.fq.gz;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofqinp/err"
    condition: ~
    mem: 1500
    placeholders: 
      - bamtofqinp
      - datasource.Inp_bam
      - datasource.Inp_location
      - bamtofqinp.lane1
      - datasource.Inp_location
      - bamtofqinp.lane2
      - bamtofqinp.merged.bam
      - bamtofqinp.lane1
      - bamtofqinp.lane2
      - bamtofqinp.lane1
      - bamtofqinp.lane2
      - datasource.SE_PE
      - bamtofqinp.merged.bam
      - bamtofqinp.out_1.fq.gz
      - bamtofqinp.out_2.fq.gz
      - bamtofqinp.merged.bam
      - bamtofqinp.merged.bam
      - bamtofqinp.out_1.fq.gz
      - bamtofqinp.merged.bam
      - datasource.Inp_location
      - bamtofqinp.out_1.fq.gz
      - bamtofqinp.err
  bedcorrelate: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bedcorrelate;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tbroadreplicates=(/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergedbroadpeak/ChIPseqout_peaks.broadPeak);\n\tgappedreplicates=(/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak);\n\tnarrowreplicates=(/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak);\n\t###\n\tbedtools intersect -u -a ${broadreplicates[0]} -b ${broadreplicates[1]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bedcorrelate/broadintersect.bed;\n\tbedtools intersect -u -a ${gappedreplicates[0]} -b ${gappedreplicates[1]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bedcorrelate/gappedintersect.bed;\n\tbedtools intersect -u -a ${narrowreplicates[0]} -b ${narrowreplicates[1]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bedcorrelate/narrowintersect.bed;\n\tbedtools intersect -u -a ${broadreplicates[1]} -b ${broadreplicates[0]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bedcorrelate/broadintersect2.bed;\n\tbedtools intersect -u -a ${gappedreplicates[1]} -b ${gappedreplicates[0]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bedcorrelate/gappedintersect2.bed;\n\tbedtools intersect -u -a ${narrowreplicates[1]} -b ${narrowreplicates[0]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bedcorrelate/narrowintersect2.bed;\n\t###\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bedcorrelate/broadintersect.bed|wc -l ) \"/\" $(cat ${broadreplicates[0]} |wc -l ) \") *100\"|bc >/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bedcorrelate/broadintersect.txt;\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bedcorrelate/gappedintersect.bed|wc -l ) \"/\" $(cat ${gappedreplicates[0]} |wc -l ) \") *100\"|bc >/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bedcorrelate/gappedintersect.txt;\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bedcorrelate/narrowintersect.bed|wc -l ) \"/\" $(cat ${narrowreplicates[0]} |wc -l ) \") *100\"|bc >/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bedcorrelate/narrowintersect.txt;\n\t###\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bedcorrelate/broadintersect2.bed|wc -l ) \"/\" $(cat ${broadreplicates[1]} |wc -l ) \") *100\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bedcorrelate/broadintersect.txt;\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bedcorrelate/gappedintersect2.bed|wc -l ) \"/\" $(cat ${gappedreplicates[1]} |wc -l ) \") *100\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bedcorrelate/gappedintersect.txt;\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bedcorrelate/narrowintersect2.bed|wc -l ) \"/\" $(cat ${narrowreplicates[1]} |wc -l ) \") *100\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bedcorrelate/narrowintersect.txt;\n\t###\n\techo \"scale=4;((\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bedcorrelate/broadintersect.bed|wc -l ) \"/\" $(cat ${broadreplicates[0]} |wc -l ) \")+(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bedcorrelate/broadintersect2.bed|wc -l ) \"/\" $(cat ${broadreplicates[1]} |wc -l ) \")) *50\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bedcorrelate/broadintersect.txt;\n\techo \"scale=4;((\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bedcorrelate/gappedintersect.bed|wc -l ) \"/\" $(cat ${gappedreplicates[0]} |wc -l ) \")+(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bedcorrelate/gappedintersect2.bed|wc -l ) \"/\" $(cat ${gappedreplicates[1]} |wc -l ) \")) *50\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bedcorrelate/gappedintersect.txt;\n\techo \"scale=4;((\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bedcorrelate/narrowintersect.bed|wc -l ) \"/\" $(cat ${narrowreplicates[0]} |wc -l ) \")+(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bedcorrelate/narrowintersect2.bed|wc -l ) \"/\" $(cat ${narrowreplicates[1]} |wc -l ) \")) *50\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bedcorrelate/narrowintersect.txt; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bedcorrelate/err"
    condition: groupby
    condition_params: 
      - replicate
    cores: 4
    mem: 5000
    placeholders: 
      - bedcorrelate
      - groupby.replicate.macsunmergedbroadpeak.ChIPseqout_peaks.broadPeak
      - groupby.replicate.macsunmergedbroadpeak.ChIPseqout_peaks.gappedPeak
      - groupby.replicate.macsunmergednarrowpeak.ChIPseqout_peaks.narrowPeak
      - bedcorrelate.broadintersect.bed
      - bedcorrelate.gappedintersect.bed
      - bedcorrelate.narrowintersect.bed
      - bedcorrelate.broadintersect2.bed
      - bedcorrelate.gappedintersect2.bed
      - bedcorrelate.narrowintersect2.bed
      - bedcorrelate.broadintersect.bed
      - bedcorrelate.broadintersect.txt
      - bedcorrelate.gappedintersect.bed
      - bedcorrelate.gappedintersect.txt
      - bedcorrelate.narrowintersect.bed
      - bedcorrelate.narrowintersect.txt
      - bedcorrelate.broadintersect2.bed
      - bedcorrelate.broadintersect.txt
      - bedcorrelate.gappedintersect2.bed
      - bedcorrelate.gappedintersect.txt
      - bedcorrelate.narrowintersect2.bed
      - bedcorrelate.narrowintersect.txt
      - bedcorrelate.broadintersect.bed
      - bedcorrelate.broadintersect2.bed
      - bedcorrelate.broadintersect.txt
      - bedcorrelate.gappedintersect.bed
      - bedcorrelate.gappedintersect2.bed
      - bedcorrelate.gappedintersect.txt
      - bedcorrelate.narrowintersect.bed
      - bedcorrelate.narrowintersect2.bed
      - bedcorrelate.narrowintersect.txt
      - bedcorrelate.err
  bowtie: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bowtie;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tls /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_build/touch /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_buildcast/touch;\n\tif [ PE == \"PE\" ];\n\t\tthen /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/bowtierun -p PE -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/trimgalore/out_1_val_1.fq.gz -2 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/trimgalore/out_2_val_2.fq.gz -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bowtie/out.sam -s C57BL6J;\n\telse /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/bowtierun -p PE -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/trimgalore/out_1_val_1.fq.gz -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bowtie/out.sam -s C57BL6J;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bowtie/err"
    condition: ~
    cores: 14
    mem: 7000
    placeholders: 
      - bowtie
      - bowtie_build.touch
      - bowtie_buildcast.touch
      - datasource.SE_PE
      - software.bowtierun
      - datasource.SE_PE
      - trimgalore.output2
      - trimgalore.output4
      - bowtie.out.sam
      - datasource.Strain
      - software.bowtierun
      - datasource.SE_PE
      - trimgalore.output2
      - bowtie.out.sam
      - datasource.Strain
      - bowtie.err
  bowtieinp: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bowtieinp;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tls /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_build/touch /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_buildcast/touch;\n\tif [ PE == \"PE\" ];\n\t\tthen /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/bowtierun -p PE -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/trimgaloreinp/out_1_val_1.fq.gz -2 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/trimgaloreinp/out_2_val_2.fq.gz -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bowtieinp/out.sam -s C57BL6J;\n\telse /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/bowtierun -p PE -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/trimgaloreinp/out_1_val_1.fq.gz -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bowtieinp/out.sam -s C57BL6J;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bowtieinp/err"
    condition: ~
    cores: 14
    mem: 7000
    placeholders: 
      - bowtieinp
      - bowtie_build.touch
      - bowtie_buildcast.touch
      - datasource.SE_PE
      - software.bowtierun
      - datasource.SE_PE
      - trimgaloreinp.output2
      - trimgaloreinp.output4
      - bowtieinp.out.sam
      - datasource.Strain
      - software.bowtierun
      - datasource.SE_PE
      - trimgaloreinp.output2
      - bowtieinp.out.sam
      - datasource.Strain
      - bowtieinp.err
  createhubgroup: 
    cmd: cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/createhubgroup;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc; 	#ls * | grep -v err | xargs rm -rf; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/createhubgroup/err
    condition: groupby
    condition_params: 
      - Mark
    mem: 5000
    placeholders: 
      - createhubgroup
      - createhubgroup.err
  fastquality: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/fastquality;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tgunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/trimgalore/out_1_val_1.fq.gz | fastx_quality_stats -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/fastquality/out1;\n\tfastq_quality_boxplot_graph.sh -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/fastquality/out1 -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/fastquality/out1.png -t BM_B_9M_R_read1;\n\tgunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/trimgaloreinp/out_1_val_1.fq.gz | fastx_quality_stats -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/fastquality/Inpout1;\n\tfastq_quality_boxplot_graph.sh -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/fastquality/Inpout1 -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/fastquality/Inpout1.png -t BM_B_9M_R_input_read1;\n\tif [ PE == \"PE\" ];\n\tthen gunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/trimgalore/out_2_val_2.fq.gz | fastx_quality_stats -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/fastquality/out2;\n\t\tfastq_quality_boxplot_graph.sh -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/fastquality/out2 -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/fastquality/out2.png -t BM_B_9M_R_read2;\n\t\tgunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/trimgaloreinp/out_2_val_2.fq.gz | fastx_quality_stats -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/fastquality/Inpout2;\n\t\tfastq_quality_boxplot_graph.sh -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/fastquality/Inpout2 -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/fastquality/Inpout2.png -t BM_B_9M_R_input_read2;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/fastquality/err"
    condition: ~
    mem: 50
    placeholders: 
      - fastquality
      - trimgalore.output2
      - fastquality.out1
      - fastquality.out1
      - fastquality.out1.png
      - datasource.Name
      - trimgaloreinp.output2
      - fastquality.Inpout1
      - fastquality.Inpout1
      - fastquality.Inpout1.png
      - datasource.Name
      - datasource.SE_PE
      - trimgalore.output4
      - fastquality.out2
      - fastquality.out2
      - fastquality.out2.png
      - datasource.Name
      - trimgaloreinp.output4
      - fastquality.Inpout2
      - fastquality.Inpout2
      - fastquality.Inpout2.png
      - datasource.Name
      - fastquality.err
  macsmergedbroad: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergedbroad;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tlast=$(tail -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bedcorrelate/broadintersect.txt);\n\tint=${last%.*};\n\tif [ $int -gt 75 ];\n\t\tthen macs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -q 0.01 --broad --broad-cutoff 0.1 --fix-bimodal --extsize 250 --keep-dup auto;\n\t\t###\n\t\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergedbroad/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergedbroad/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergedbroad/FoldE.bdg -m FE\";\n\t\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergedbroad/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergedbroad/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergedbroad/FoldE.bdg -m FE;\n\t\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergedbroad/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergedbroad/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergedbroad/logLR.bdg -m logLR -p 0.00001\";\n\t\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergedbroad/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergedbroad/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergedbroad/logLR.bdg -m logLR -p 0.00001;\n\t\t###\n\t\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergedbroad/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\t\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergedbroad/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergedbroad/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\t\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergedbroad/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t\t###\n\t\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergedbroad/ChIPseqout_model.r;\n\t\tbroadpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergedbroad/ChIPseqout_peaks.broadPeak broadout;\n\t\tgappedpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergedbroad/ChIPseqout_peaks.gappedPeak gappedout;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergedbroad/err"
    condition: groupby
    condition_params: 
      - replicate
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.broadPeak
      - ChIPseqout_peaks.gappedPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
    placeholders: 
      - macsmergedbroad
      - datasource.SE_PE
      - bedcorrelate.broadintersect.txt
      - groupby.replicate.samtoolsview.out.sorted.bam
      - groupby.replicate.samtoolsviewInp.out.sorted.bam
      - datasource.sonication
      - macsmergedbroad.output4
      - macsmergedbroad.output5
      - macsmergedbroad.FoldE.bdg
      - macsmergedbroad.output4
      - macsmergedbroad.output5
      - macsmergedbroad.FoldE.bdg
      - macsmergedbroad.output4
      - macsmergedbroad.output5
      - macsmergedbroad.logLR.bdg
      - macsmergedbroad.output4
      - macsmergedbroad.output5
      - macsmergedbroad.logLR.bdg
      - macsmergedbroad.FoldE.bdg
      - input.mm10.len
      - macsmergedbroad.FoldE.bdg
      - input.mm10.len
      - macsmergedbroad.logLR.bdg
      - input.mm10.len
      - macsmergedbroad.logLR.bdg
      - input.mm10.len
      - macsmergedbroad.output3
      - macsmergedbroad.output1
      - macsmergedbroad.output2
      - macsmergedbroad.err
  macsmergednarrow: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergednarrow;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tlast=$(tail -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bedcorrelate/narrowintersect.txt);\n\tint=${last%.*};\n\tif [ $int -gt 75 ];\n\t\tthen macs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -q 0.01 --fix-bimodal --extsize 250 --keep-dup auto;\n\t\t###\n\t\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergednarrow/ChIPseqout_control_lambda.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergednarrow/FoldE.bw -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergednarrow/FoldE.bdg -m FE\";\n\t\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergednarrow/ChIPseqout_control_lambda.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergednarrow/FoldE.bw -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergednarrow/FoldE.bdg -m FE;\n\t\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergednarrow/ChIPseqout_control_lambda.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergednarrow/FoldE.bw -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergednarrow/logLR.bdg -m logLR -p 0.00001\";\n\t\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergednarrow/ChIPseqout_control_lambda.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergednarrow/FoldE.bw -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergednarrow/logLR.bdg -m logLR -p 0.00001;\n\t\t###\n\t\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergednarrow/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\t\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergednarrow/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergednarrow/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\t\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergednarrow/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t\t###\n\t\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergednarrow/ChIPseqout_model.r;\n\t\tnarrowpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergednarrow/ChIPseqout_peaks.narrowPeak narrowout;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsmergednarrow/err"
    condition: groupby
    condition_params: 
      - replicate
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.narrowPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
    placeholders: 
      - macsmergednarrow
      - datasource.SE_PE
      - bedcorrelate.narrowintersect.txt
      - groupby.replicate.samtoolsview.out.sorted.bam
      - groupby.replicate.samtoolsviewInp.out.sorted.bam
      - datasource.sonication
      - macsmergednarrow.output4
      - macsmergednarrow.output5
      - macsmergednarrow.FoldE.bdg
      - macsmergednarrow.output4
      - macsmergednarrow.output5
      - macsmergednarrow.FoldE.bdg
      - macsmergednarrow.output4
      - macsmergednarrow.output5
      - macsmergednarrow.logLR.bdg
      - macsmergednarrow.output4
      - macsmergednarrow.output5
      - macsmergednarrow.logLR.bdg
      - macsmergednarrow.FoldE.bdg
      - input.mm10.len
      - macsmergednarrow.FoldE.bdg
      - input.mm10.len
      - macsmergednarrow.logLR.bdg
      - input.mm10.len
      - macsmergednarrow.logLR.bdg
      - input.mm10.len
      - macsmergednarrow.output2
      - macsmergednarrow.output1
      - macsmergednarrow.err
  macsunmerged: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmerged;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; \tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tmacs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -p 1 --fix-bimodal --extsize 250 --keep-dup auto; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmerged/err"
    condition: ~
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.narrowPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
    placeholders: 
      - macsunmerged
      - datasource.SE_PE
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.sonication
      - macsunmerged.err
  macsunmergedbroadpeak: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergedbroadpeak;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; ls * | grep -v err | xargs rm -rf;\t. /nfs/users/nfs_r/rg12/.bashrc;\n\ttrap SomeErrorHandler ERR;\n\tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tmacs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -q 0.05 --broad --broad-cutoff 0.1 --fix-bimodal --extsize 250 --keep-dup auto;\n\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergedbroadpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergedbroadpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergedbroadpeak/FoldE.bdg -m FE\";\n\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergedbroadpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergedbroadpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergedbroadpeak/FoldE.bdg -m FE;\n\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergedbroadpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergedbroadpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergedbroadpeak/logLR.bdg -m logLR -p 0.00001\";\n\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergedbroadpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergedbroadpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergedbroadpeak/logLR.bdg -m logLR -p 0.00001;\n\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergedbroadpeak/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergedbroadpeak/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergedbroadpeak/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergedbroadpeak/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t>&2 echo \"Rscript\";\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergedbroadpeak/ChIPseqout_model.r;\n\tbroadpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergedbroadpeak/ChIPseqout_peaks.broadPeak broadout;\n\tgappedpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak gappedout;\n\tbedtools genomecov -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergedbroadpeak/ChIPseqout_peaks.broadPeak -g /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len -bg > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergedbroadpeak/broad.bdg;\n\tbedtools genomecov -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak -g /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len -bg > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergedbroadpeak/gapped.bdg; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergedbroadpeak/err"
    condition: ~
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.broadPeak
      - ChIPseqout_peaks.gappedPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
    placeholders: 
      - macsunmergedbroadpeak
      - datasource.SE_PE
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.sonication
      - macsunmergedbroadpeak.output4
      - macsunmergedbroadpeak.output5
      - macsunmergedbroadpeak.FoldE.bdg
      - macsunmergedbroadpeak.output4
      - macsunmergedbroadpeak.output5
      - macsunmergedbroadpeak.FoldE.bdg
      - macsunmergedbroadpeak.output4
      - macsunmergedbroadpeak.output5
      - macsunmergedbroadpeak.logLR.bdg
      - macsunmergedbroadpeak.output4
      - macsunmergedbroadpeak.output5
      - macsunmergedbroadpeak.logLR.bdg
      - macsunmergedbroadpeak.FoldE.bdg
      - input.mm10.len
      - macsunmergedbroadpeak.FoldE.bdg
      - input.mm10.len
      - macsunmergedbroadpeak.logLR.bdg
      - input.mm10.len
      - macsunmergedbroadpeak.logLR.bdg
      - input.mm10.len
      - macsunmergedbroadpeak.output3
      - macsunmergedbroadpeak.output1
      - macsunmergedbroadpeak.output2
      - macsunmergedbroadpeak.output1
      - input.mm10.len
      - macsunmergedbroadpeak.broad.bdg
      - macsunmergedbroadpeak.output2
      - input.mm10.len
      - macsunmergedbroadpeak.gapped.bdg
      - macsunmergedbroadpeak.err
  macsunmergednarrowpeak: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergednarrowpeak;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; ls * | grep -v err | xargs rm -rf;\t. /nfs/users/nfs_r/rg12/.bashrc;\n\ttrap SomeErrorHandler ERR;\n\tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tmacs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -q 0.01 --fix-bimodal --extsize 250 --keep-dup auto;\n\t###\n\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergednarrowpeak/FoldE.bdg -m FE\";\n\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergednarrowpeak/FoldE.bdg -m FE;\n\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergednarrowpeak/logLR.bdg -m logLR -p 0.00001\";\n\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergednarrowpeak/logLR.bdg -m logLR -p 0.00001;\n\t###\n\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergednarrowpeak/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergednarrowpeak/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergednarrowpeak/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergednarrowpeak/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t###\n\t>&2 echo \"Rscript\";\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergednarrowpeak/ChIPseqout_model.r;\n\tnarrowpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak narrowout;\n\t###\n\tbgzip /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg;\n\tbgzip /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg;\n\ttabix -p bed /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg.gz;\n\ttabix -p bed /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg.gz;\n\tbedtools genomecov -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak -g /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len -bg > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergednarrowpeak/narrow.bdg; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergednarrowpeak/err"
    condition: ~
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.narrowPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
      - ChIPseqout_treat_pileup.bdg.gz
      - ChIPseqout_control_lambda.bdg.gz
      - ChIPseqout_treat_pileup.bdg.gz.tbi
      - ChIPseqout_control_lambda.bdg.gz.tbi
    placeholders: 
      - macsunmergednarrowpeak
      - datasource.SE_PE
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.sonication
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.FoldE.bdg
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.FoldE.bdg
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.logLR.bdg
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.logLR.bdg
      - macsunmergednarrowpeak.FoldE.bdg
      - input.mm10.len
      - macsunmergednarrowpeak.FoldE.bdg
      - input.mm10.len
      - macsunmergednarrowpeak.logLR.bdg
      - input.mm10.len
      - macsunmergednarrowpeak.logLR.bdg
      - input.mm10.len
      - macsunmergednarrowpeak.output2
      - macsunmergednarrowpeak.output1
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.output7
      - macsunmergednarrowpeak.output8
      - macsunmergednarrowpeak.output1
      - input.mm10.len
      - macsunmergednarrowpeak.narrow.bdg
      - macsunmergednarrowpeak.err
  pdfmerge: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/pdfmerge;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\tls * | grep -v err | xargs rm -rf;\n\ttrap SomeErrorHandler ERR;\n\tpdfunite /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/annotatepeaksgroup/cluster.4.pdf /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/annotatepeaksgroup/cluster.4.pdf Cluster4.pdf;\n\tpdfunite /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/annotatepeaksgroup/cluster.5.pdf /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/annotatepeaksgroup/cluster.5.pdf Cluster5.pdf;\n\tpdfunite /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/annotatepeaksgroup/cluster.6.pdf /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/annotatepeaksgroup/cluster.6.pdf Cluster6.pdf;\n\tpdfunite /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/annotatepeaksgroup/cluster.7.pdf /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/annotatepeaksgroup/cluster.7.pdf Cluster7.pdf;\n\tpdfunite /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/annotatepeaksgroup/cluster.8.pdf /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/annotatepeaksgroup/cluster.8.pdf Cluster8.pdf;\n\tpdfunite /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/annotatepeaksgroup/cluster.9.pdf /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/annotatepeaksgroup/cluster.9.pdf Cluster9.pdf;\n\tpdfunite /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/annotatepeaksgroup/cluster.10.pdf /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/annotatepeaksgroup/cluster.10.pdf Cluster10.pdf; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/pdfmerge/err"
    condition: groupby
    condition_params: 
      - Mark
    cores: 5
    mem: 5000
    placeholders: 
      - pdfmerge
      - groupby.Mark.annotatepeaksgroup.cluster.4.pdf
      - groupby.Mark.annotatepeaksgroup.cluster.5.pdf
      - groupby.Mark.annotatepeaksgroup.cluster.6.pdf
      - groupby.Mark.annotatepeaksgroup.cluster.7.pdf
      - groupby.Mark.annotatepeaksgroup.cluster.8.pdf
      - groupby.Mark.annotatepeaksgroup.cluster.9.pdf
      - groupby.Mark.annotatepeaksgroup.cluster.10.pdf
      - pdfmerge.err
  pie: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/pie;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; ls * | grep -v err | xargs rm -rf;\t. /nfs/users/nfs_r/rg12/.bashrc;\n\ttrap SomeErrorHandler ERR;\n\t#gapped broad output\n\tbedtools intersect -loj -a /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak -b /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/ens_genes_and_promoter_distal.bed > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/pie/out;\n\tbedtools intersect -loj -a /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak -b /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/ens_genes_and_promoter_distal.bed > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/pie/out2;\n\tbedtools intersect -wa -b /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak -a /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/ens_genes_and_promoter_distal.bed > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/pie/out3;\n\tbedtools intersect -wa -b /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak -a /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/ens_genes_and_promoter_distal.bed > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/pie/out4;\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/pie.R $(grep -c Gene /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/pie/out) $(grep -c Distal /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/pie/out) $(grep -c Promoter /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/pie/out) $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/pie/out |wc -l) rplot_broad.pdf > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/pie/broad\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/pie.R $(grep -c Gene /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/pie/out2) $(grep -c Distal /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/pie/out2) $(grep -c Promoter /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/pie/out2) $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/pie/out2 |wc -l) rplot_narrow.pdf > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/pie/narrow\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/pie.R $(grep -c Gene /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/pie/out3) $(grep -c Distal /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/pie/out3) $(grep -c Promoter /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/pie/out3) $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/pie/out3 |wc -l) rplot_gene_broad.pdf > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/pie/gene_broad\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/pie.R $(grep -c Gene /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/pie/out4) $(grep -c Distal /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/pie/out4) $(grep -c Promoter /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/pie/out4) $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/pie/out4 |wc -l) rplot_gene_narrow.pdf > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/pie/gene_narrow 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/pie/err"
    condition: ~
    mem: 5000
    placeholders: 
      - pie
      - macsunmergedbroadpeak.output2
      - input.ens_genes_and_promoter_distal.bed
      - pie.out
      - macsunmergednarrowpeak.output1
      - input.ens_genes_and_promoter_distal.bed
      - pie.out2
      - macsunmergedbroadpeak.output2
      - input.ens_genes_and_promoter_distal.bed
      - pie.out3
      - macsunmergednarrowpeak.output1
      - input.ens_genes_and_promoter_distal.bed
      - pie.out4
      - software.pie.R
      - pie.out
      - pie.out
      - pie.out
      - pie.out
      - pie.broad
      - software.pie.R
      - pie.out2
      - pie.out2
      - pie.out2
      - pie.out2
      - pie.narrow
      - software.pie.R
      - pie.out3
      - pie.out3
      - pie.out3
      - pie.out3
      - pie.gene_broad
      - software.pie.R
      - pie.out4
      - pie.out4
      - pie.out4
      - pie.out4
      - pie.gene_narrow
      - pie.err
  samtoolsview: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/samtoolsview;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\ttest -e /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bowtie/out.sam;\n\tsamtools view -hSb /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bowtie/out.sam> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/samtoolsview/out.bam;\n\tsamtools sort /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/samtoolsview/out.bam out.sorted;\n\tsamtools index /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/samtoolsview/out.sorted.bam;\n\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bowtie/out.sam; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/samtoolsview/err"
    condition: ~
    mem: 2000
    outputfiles: 
      - out.sorted.bam
      - out.sorted.bam.bai
    placeholders: 
      - samtoolsview
      - bowtie.out.sam
      - bowtie.out.sam
      - samtoolsview.out.bam
      - samtoolsview.out.bam
      - samtoolsview.output1
      - bowtie.out.sam
      - samtoolsview.err
  samtoolsviewInp: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/samtoolsviewInp;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\ttest -e /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bowtieinp/out.sam;\n\tsamtools view -hSb /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bowtieinp/out.sam > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/samtoolsviewInp/out.bam;\n\tsamtools sort /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/samtoolsviewInp/out.bam out.sorted;\n\tsamtools index /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/samtoolsviewInp/out.sorted.bam;\n\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bowtieinp/out.sam; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/samtoolsviewInp/err"
    condition: ~
    mem: 2000
    outputfiles: 
      - out.sorted.bam
      - out.sorted.bam.bai
    placeholders: 
      - samtoolsviewInp
      - bowtieinp.out.sam
      - bowtieinp.out.sam
      - samtoolsviewInp.out.bam
      - samtoolsviewInp.out.bam
      - samtoolsviewInp.output1
      - bowtieinp.out.sam
      - samtoolsviewInp.err
  seperateclusters: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/seperateclusters;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\tls * | grep -v err | xargs rm -rf;\n\ttrap SomeErrorHandler ERR;\n\tclusters=4;\n\tcp /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/annotatepeaksgroup/cluster.4.RData /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/seperateclusters/clusters.RData;\n\tExtractGName.R /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/seperateclusters/clusters.RData;\n\t>&2 echo \"cluster1-4\";\n\tfor i in {1..4}\n\tdo\n\t\t>&2 echo \"cluster\" ${i};\n\t\techo -e \"/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/samtoolsviewInp/out.sorted.bam\tclusters.1.cluster${i}.txt\t\\\"H3K9me3 B Cell\\\"\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/seperateclusters/config.txt;\n\t\t>&2 echo \"ngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/seperateclusters/config.txt -O heatmapclusters.${i} -L 5000 -GO total -CO blue:white:red -P 5\";\n\t\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/seperateclusters/config.txt -O heatmapclusters.${i} -L 3000 -GO total -CO blue:white:red -P 5;\n\t\tconvert -density 150 heatmapclusters.${i}.heatmap.pdf -quality 90 heatmapclusters.${i}.heatmap.png;\n\tdone 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/seperateclusters/err"
    condition: ~
    cores: 5
    mem: 5000
    placeholders: 
      - seperateclusters
      - annotatepeaksgroup.output1
      - seperateclusters.clusters.RData
      - seperateclusters.clusters.RData
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.mark_full
      - datasource.Cell
      - seperateclusters.config.txt
      - seperateclusters.config.txt
      - seperateclusters.config.txt
      - seperateclusters.err
  summarystats: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/summarystats;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;trap SomeErrorHandler ERR;\tif [ PE == \"PE\" ];\n\t\tthen if [ TRUE == \"TRUE\" ];\n\t\t\tthen echo \"BM_B_9M_R_lane1\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_9M_R/BM_B_9M_R_1.bam >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/summarystats/out.flagstat;\n\t\t\techo \"BM_B_9M_R_lane2\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_9M_R/BM_B_9M_R_2.bam >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/summarystats/out.flagstat;\n\t\telse echo \"BM_B_9M_R\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/summarystats/out.flagstat;\n\t\t\techo \"FastQ\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/summarystats/out.flagstat;\n\t\tfi;\n\t\tif [ TRUE == \"TRUE\" ];\n\t\t\tthen echo \"Inp_BM_B_9M_R_lane1\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_INP_R/BM_B_INP_R_1.bam >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/summarystats/out.flagstat;\n\t\t\techo \"Inp_BM_B_9M_R_lane2\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_INP_R/BM_B_INP_R_2.bam >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/summarystats/out.flagstat;\n\t\telse echo \"Inp_BM_B_9M_R\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/summarystats/out.flagstat;\n\t\t\techo \"FastQ\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/summarystats/out.flagstat;\n\t\tfi;\n\telse if [ TRUE == \"TRUE\" ]; ### CHECK THIS!! SHOULD be INP_1 and INP_2\n\t\tthen echo \"BM_B_9M_R_lane1\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_9M_R/BM_B_9M_R_1.bam >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/summarystats/out.flagstat;\n\t\t\techo \"BM_B_9M_R_lane2\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_9M_R/BM_B_9M_R_2.bam >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/summarystats/out.flagstat;\n\t\telse echo \"BM_B_9M_R\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/summarystats/out.flagstat;\n\t\t\techo \"FastQ\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/summarystats/out.flagstat;\n\t\tfi;\n\t\tif [ TRUE == \"TRUE\" ];\n\t\t\tthen echo \"Inp_BM_B_9M_R_lane1\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_INP_R/BM_B_INP_R_1.bam >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/summarystats/out.flagstat;\n\t\t\techo \"Inp_BM_B_9M_R_lane2\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_INP_R/BM_B_INP_R_2.bam >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/summarystats/out.flagstat;\n\t\telse echo \"Inp_BM_B_9M_R\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/summarystats/out.flagstat;\n\t\t\techo \"FastQ\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/summarystats/out.flagstat;\n\t\tfi;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/summarystats/err"
    condition: ~
    mem: 1000
    placeholders: 
      - summarystats
      - datasource.SE_PE
      - datasource.bam
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - summarystats.out.flagstat
      - datasource.Inp_bam
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.Inp_location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.Inp_location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - summarystats.out.flagstat
      - datasource.bam
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - summarystats.out.flagstat
      - datasource.Inp_bam
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.Inp_location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.Inp_location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - summarystats.out.flagstat
      - summarystats.err
  trimgalore: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/trimgalore;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tlength=$(gunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofq/out_1.fq.gz | head -2| tail -1 | wc -c);\n\tlength=$[length-11];\n\tif [ PE == \"PE\" ];\n\tthen\n\t\ttrim_galore --fastqc --gzip --length $length --paired -a CGATGTTT --stringency 4 --trim1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofq/out_1.fq.gz /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofq/out_2.fq.gz;\n\telse\n\t\ttrim_galore --fastqc --gzip --length $length -a CGATGTTT --stringency 4 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofq/out_1.fq.gz;\n\n\t\tmv out_1_trimmed.fq.gz out_1_val_1.fq.gz;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/trimgalore/err"
    condition: ~
    cores: 3
    mem: 2000
    outputfiles: 
      - out_1.fq.gz_trimming_report.txt
      - out_1_val_1.fq.gz
      - out_2.fq.gz_trimming_report.txt
      - out_2_val_2.fq.gz
      - out_1_val_1.html
      - out_1_val_1.zip
      - out_2_val_2.html
      - out_2_val_2.zip
    placeholders: 
      - trimgalore
      - bamtofq.out_1.fq.gz
      - datasource.SE_PE
      - datasource.Tag
      - bamtofq.out_1.fq.gz
      - bamtofq.out_2.fq.gz
      - datasource.Tag
      - bamtofq.out_1.fq.gz
      - trimgalore.err
  trimgaloreinp: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/trimgaloreinp;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tlength=$(gunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofqinp/out_1.fq.gz | head -2| tail -1 | wc -c);\n\tlength=$[length-11];\n\tif [ PE == \"PE\" ];\n\tthen\n\t\ttrim_galore --fastqc --gzip --length $length --paired -a GATCAGCG --stringency 4 --trim1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofqinp/out_1.fq.gz /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofqinp/out_2.fq.gz;\n\telse\n\t\ttrim_galore --fastqc --gzip --length $length -a GATCAGCG --stringency 4 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/bamtofqinp/out_1.fq.gz;\n\t\tmv out_1_trimmed.fq.gz out_1_val_1.fq.gz; ### should FIX\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/trimgaloreinp/err"
    condition: ~
    cores: 3
    mem: 2000
    outputfiles: 
      - out_1.fq.gz_trimming_report.txt
      - out_1_val_1.fq.gz
      - out_2.fq.gz_trimming_report.txt
      - out_2_val_2.fq.gz
      - out_1_val_1.html
      - out_1_val_1.zip
      - out_2_val_2.html
      - out_2_val_2.zip
    placeholders: 
      - trimgaloreinp
      - bamtofqinp.out_1.fq.gz
      - datasource.SE_PE
      - datasource.Inp_Tag
      - bamtofqinp.out_1.fq.gz
      - bamtofqinp.out_2.fq.gz
      - datasource.Inp_Tag
      - bamtofqinp.out_1.fq.gz
      - trimgaloreinp.err
  wigcorrelate: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/wigcorrelate;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tls /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergedbroadpeak/FoldE.bw;\n\tlength=(/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergedbroadpeak/FoldE.bw);\n\t#Change FoldE.bw to output16\n\tif [ ${#length[@]} != 1 ];\n\t\tthen\n\t\twigCorrelate /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmerged/FoldE.bw > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/wigcorrelate/out;\n\tfi; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/wigcorrelate/err"
    condition: groupby
    condition_params: 
      - replicate
    cores: 4
    mem: 5000
    placeholders: 
      - wigcorrelate
      - macsunmergedbroadpeak.output6
      - groupby.replicate.macsunmergedbroadpeak.FoldE.bw
      - groupby.replicate.macsunmerged.FoldE.bw
      - wigcorrelate.out
      - wigcorrelate.err
2: 
  annotatepeaks: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/annotatepeaks;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\tls * | grep -v err | xargs rm -rf;\n\ttrap SomeErrorHandler ERR;\n\tclusters=4\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/samtoolsviewInp/out.sorted.bam -T \"H4K20me3 B Cell\" -O out -L 3000 -GO km -KNC ${clusters} -CO blue:white:red -P 5 -FI 1;\n\t/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/ExtractGeneClusterings.r out;\n\tfor i in $(seq 1 ${clusters});\n\tdo\n\t\techo -e \"/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/samtoolsviewInp/out.sorted.bam\tout.cluster${i}.txt\t\\\"H4K20me3 B Cell Cluster${i}\\\"\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/annotatepeaks/config.txt;\n\tdone\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/annotatepeaks/config.txt -O clusters -L 3000 -GO hc -CO blue:white:red -P 5;\n\tcat > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/annotatepeaks/configB.txt << EOF\n/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/samtoolsviewInp/out.sorted.bam\t/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/B_ordered_TPM.txt\t\"H4K20me3 B cell\"\nEOF\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/annotatepeaks/configB.txt -O TPMorderedB -L 3000 -GO none -CO blue:white:red -P 5;\n\tcat > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/annotatepeaks/configT.txt << EOF\n/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/samtoolsviewInp/out.sorted.bam\t/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/T_ordered_TPM.txt\t\"H4K20me3 T cell\"\nEOF\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/annotatepeaks/configT.txt -O TPMorderedT -L 3000 -GO none -CO blue:white:red -P 5; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/annotatepeaks/err"
    condition: ~
    cores: 5
    mem: 5000
    placeholders: 
      - annotatepeaks
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.mark_full
      - datasource.Cell
      - software.ExtractGeneClusterings.r
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.mark_full
      - datasource.Cell
      - annotatepeaks.config.txt
      - annotatepeaks.config.txt
      - annotatepeaks.configB.txt
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - input.B_ordered_TPM.txt
      - datasource.mark_full
      - annotatepeaks.configB.txt
      - annotatepeaks.configT.txt
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - input.T_ordered_TPM.txt
      - datasource.mark_full
      - annotatepeaks.configT.txt
      - annotatepeaks.err
  annotatepeaksgroup: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/annotatepeaksgroup;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\tls * | grep -v err | xargs rm -rf;\n\ttrap SomeErrorHandler ERR;\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/samtoolsviewInp/out.sorted.bam -T \"H4K20me3 B Cell\" -O out -L 3000 -CO blue:white:red -P 5 -FI 0;\n\tfor clusters in {4..10};\n\t\tdo name=\"cluster.${clusters}\";\n\t\treplot.r heatmap -I out.zip -O ${name} -T \"H4K20me3 B Cell\" -L 3000 -GO km -KNC ${clusters} -CO blue:white:red -P 5;\n\t\tExtractGName.R ${name}.RData;\n\tdone 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/annotatepeaksgroup/err"
    condition: ~
    cores: 5
    mem: 5000
    outputfiles: 
      - cluster.4.RData
    placeholders: 
      - annotatepeaksgroup
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.mark_full
      - datasource.Cell
      - datasource.mark_full
      - datasource.Cell
      - annotatepeaksgroup.err
  bamtofq: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofq;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;trap SomeErrorHandler ERR;\tif [ TRUE == \"TRUE\" ];\n\t\tthen samtools sort /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_20M_R/BM_B_20M_R_1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofq/lane1;\n\t\tsamtools sort /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_20M_R/BM_B_20M_R_2.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofq/lane2;\n\t\tsamtools merge /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofq/merged.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofq/lane1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofq/lane2.bam;\n\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofq/lane1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofq/lane2.bam;\n\t\tif [ PE == \"PE\" ];\n\t\t\tthen\n\t\t\t\tbamtofastq filename=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofq/merged.bam gz=1 F=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofq/out_1.fq.gz F2=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofq/out_2.fq.gz;\n\t\t\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofq/merged.bam;\n\t\t\telse\n\t\t\t\tbamtofastq gz=1 filename=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofq/merged.bam > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofq/out_1.fq.gz;\n\t\t\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofq/merged.bam;\n\t\t\tfi;\n\t\telse\n\t\t\tcat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_20M_R/BM_B_20M_R* > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofq/out_1.fq.gz;\n\t\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofq/err"
    condition: ~
    mem: 1500
    placeholders: 
      - bamtofq
      - datasource.bam
      - datasource.location
      - bamtofq.lane1
      - datasource.location
      - bamtofq.lane2
      - bamtofq.merged.bam
      - bamtofq.lane1
      - bamtofq.lane2
      - bamtofq.lane1
      - bamtofq.lane2
      - datasource.SE_PE
      - bamtofq.merged.bam
      - bamtofq.out_1.fq.gz
      - bamtofq.out_2.fq.gz
      - bamtofq.merged.bam
      - bamtofq.merged.bam
      - bamtofq.out_1.fq.gz
      - bamtofq.merged.bam
      - datasource.location
      - bamtofq.out_1.fq.gz
      - bamtofq.err
  bamtofqinp: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofqinp;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;trap SomeErrorHandler ERR;\tif [ TRUE == \"TRUE\" ];\n\t\tthen samtools sort /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_INP_R/BM_B_INP_R_1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofqinp/lane1;\n\t\tsamtools sort /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_INP_R/BM_B_INP_R_2.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofqinp/lane2;\n\t\tsamtools merge /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofqinp/merged.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofqinp/lane1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofqinp/lane2.bam;\n\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofqinp/lane1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofqinp/lane2.bam;\n\t\tif [ PE == \"PE\" ];\n\t\t\tthen\n\t\t\t\tbamtofastq gz=1 filename=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofqinp/merged.bam F=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofqinp/out_1.fq.gz F2=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofqinp/out_2.fq.gz;\n\t\t\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofqinp/merged.bam;\n\t\t\telse bamtofastq gz=1 filename=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofqinp/merged.bam > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofqinp/out_1.fq.gz;\n\t\t\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofqinp/merged.bam;\n\t\tfi;\n\telse cat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_INP_R/BM_B_INP_R* > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofqinp/out_1.fq.gz;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofqinp/err"
    condition: ~
    mem: 1500
    placeholders: 
      - bamtofqinp
      - datasource.Inp_bam
      - datasource.Inp_location
      - bamtofqinp.lane1
      - datasource.Inp_location
      - bamtofqinp.lane2
      - bamtofqinp.merged.bam
      - bamtofqinp.lane1
      - bamtofqinp.lane2
      - bamtofqinp.lane1
      - bamtofqinp.lane2
      - datasource.SE_PE
      - bamtofqinp.merged.bam
      - bamtofqinp.out_1.fq.gz
      - bamtofqinp.out_2.fq.gz
      - bamtofqinp.merged.bam
      - bamtofqinp.merged.bam
      - bamtofqinp.out_1.fq.gz
      - bamtofqinp.merged.bam
      - datasource.Inp_location
      - bamtofqinp.out_1.fq.gz
      - bamtofqinp.err
  bedcorrelate: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bedcorrelate;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tbroadreplicates=(/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergedbroadpeak/ChIPseqout_peaks.broadPeak);\n\tgappedreplicates=(/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak);\n\tnarrowreplicates=(/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak);\n\t###\n\tbedtools intersect -u -a ${broadreplicates[0]} -b ${broadreplicates[1]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bedcorrelate/broadintersect.bed;\n\tbedtools intersect -u -a ${gappedreplicates[0]} -b ${gappedreplicates[1]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bedcorrelate/gappedintersect.bed;\n\tbedtools intersect -u -a ${narrowreplicates[0]} -b ${narrowreplicates[1]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bedcorrelate/narrowintersect.bed;\n\tbedtools intersect -u -a ${broadreplicates[1]} -b ${broadreplicates[0]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bedcorrelate/broadintersect2.bed;\n\tbedtools intersect -u -a ${gappedreplicates[1]} -b ${gappedreplicates[0]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bedcorrelate/gappedintersect2.bed;\n\tbedtools intersect -u -a ${narrowreplicates[1]} -b ${narrowreplicates[0]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bedcorrelate/narrowintersect2.bed;\n\t###\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bedcorrelate/broadintersect.bed|wc -l ) \"/\" $(cat ${broadreplicates[0]} |wc -l ) \") *100\"|bc >/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bedcorrelate/broadintersect.txt;\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bedcorrelate/gappedintersect.bed|wc -l ) \"/\" $(cat ${gappedreplicates[0]} |wc -l ) \") *100\"|bc >/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bedcorrelate/gappedintersect.txt;\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bedcorrelate/narrowintersect.bed|wc -l ) \"/\" $(cat ${narrowreplicates[0]} |wc -l ) \") *100\"|bc >/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bedcorrelate/narrowintersect.txt;\n\t###\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bedcorrelate/broadintersect2.bed|wc -l ) \"/\" $(cat ${broadreplicates[1]} |wc -l ) \") *100\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bedcorrelate/broadintersect.txt;\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bedcorrelate/gappedintersect2.bed|wc -l ) \"/\" $(cat ${gappedreplicates[1]} |wc -l ) \") *100\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bedcorrelate/gappedintersect.txt;\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bedcorrelate/narrowintersect2.bed|wc -l ) \"/\" $(cat ${narrowreplicates[1]} |wc -l ) \") *100\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bedcorrelate/narrowintersect.txt;\n\t###\n\techo \"scale=4;((\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bedcorrelate/broadintersect.bed|wc -l ) \"/\" $(cat ${broadreplicates[0]} |wc -l ) \")+(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bedcorrelate/broadintersect2.bed|wc -l ) \"/\" $(cat ${broadreplicates[1]} |wc -l ) \")) *50\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bedcorrelate/broadintersect.txt;\n\techo \"scale=4;((\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bedcorrelate/gappedintersect.bed|wc -l ) \"/\" $(cat ${gappedreplicates[0]} |wc -l ) \")+(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bedcorrelate/gappedintersect2.bed|wc -l ) \"/\" $(cat ${gappedreplicates[1]} |wc -l ) \")) *50\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bedcorrelate/gappedintersect.txt;\n\techo \"scale=4;((\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bedcorrelate/narrowintersect.bed|wc -l ) \"/\" $(cat ${narrowreplicates[0]} |wc -l ) \")+(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bedcorrelate/narrowintersect2.bed|wc -l ) \"/\" $(cat ${narrowreplicates[1]} |wc -l ) \")) *50\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bedcorrelate/narrowintersect.txt; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bedcorrelate/err"
    condition: groupby
    condition_params: 
      - replicate
    cores: 4
    mem: 5000
    placeholders: 
      - bedcorrelate
      - groupby.replicate.macsunmergedbroadpeak.ChIPseqout_peaks.broadPeak
      - groupby.replicate.macsunmergedbroadpeak.ChIPseqout_peaks.gappedPeak
      - groupby.replicate.macsunmergednarrowpeak.ChIPseqout_peaks.narrowPeak
      - bedcorrelate.broadintersect.bed
      - bedcorrelate.gappedintersect.bed
      - bedcorrelate.narrowintersect.bed
      - bedcorrelate.broadintersect2.bed
      - bedcorrelate.gappedintersect2.bed
      - bedcorrelate.narrowintersect2.bed
      - bedcorrelate.broadintersect.bed
      - bedcorrelate.broadintersect.txt
      - bedcorrelate.gappedintersect.bed
      - bedcorrelate.gappedintersect.txt
      - bedcorrelate.narrowintersect.bed
      - bedcorrelate.narrowintersect.txt
      - bedcorrelate.broadintersect2.bed
      - bedcorrelate.broadintersect.txt
      - bedcorrelate.gappedintersect2.bed
      - bedcorrelate.gappedintersect.txt
      - bedcorrelate.narrowintersect2.bed
      - bedcorrelate.narrowintersect.txt
      - bedcorrelate.broadintersect.bed
      - bedcorrelate.broadintersect2.bed
      - bedcorrelate.broadintersect.txt
      - bedcorrelate.gappedintersect.bed
      - bedcorrelate.gappedintersect2.bed
      - bedcorrelate.gappedintersect.txt
      - bedcorrelate.narrowintersect.bed
      - bedcorrelate.narrowintersect2.bed
      - bedcorrelate.narrowintersect.txt
      - bedcorrelate.err
  bowtie: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bowtie;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tls /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_build/touch /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_buildcast/touch;\n\tif [ PE == \"PE\" ];\n\t\tthen /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/bowtierun -p PE -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/trimgalore/out_1_val_1.fq.gz -2 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/trimgalore/out_2_val_2.fq.gz -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bowtie/out.sam -s C57BL6J;\n\telse /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/bowtierun -p PE -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/trimgalore/out_1_val_1.fq.gz -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bowtie/out.sam -s C57BL6J;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bowtie/err"
    condition: ~
    cores: 14
    mem: 7000
    placeholders: 
      - bowtie
      - bowtie_build.touch
      - bowtie_buildcast.touch
      - datasource.SE_PE
      - software.bowtierun
      - datasource.SE_PE
      - trimgalore.output2
      - trimgalore.output4
      - bowtie.out.sam
      - datasource.Strain
      - software.bowtierun
      - datasource.SE_PE
      - trimgalore.output2
      - bowtie.out.sam
      - datasource.Strain
      - bowtie.err
  bowtieinp: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bowtieinp;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tls /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_build/touch /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_buildcast/touch;\n\tif [ PE == \"PE\" ];\n\t\tthen /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/bowtierun -p PE -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/trimgaloreinp/out_1_val_1.fq.gz -2 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/trimgaloreinp/out_2_val_2.fq.gz -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bowtieinp/out.sam -s C57BL6J;\n\telse /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/bowtierun -p PE -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/trimgaloreinp/out_1_val_1.fq.gz -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bowtieinp/out.sam -s C57BL6J;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bowtieinp/err"
    condition: ~
    cores: 14
    mem: 7000
    placeholders: 
      - bowtieinp
      - bowtie_build.touch
      - bowtie_buildcast.touch
      - datasource.SE_PE
      - software.bowtierun
      - datasource.SE_PE
      - trimgaloreinp.output2
      - trimgaloreinp.output4
      - bowtieinp.out.sam
      - datasource.Strain
      - software.bowtierun
      - datasource.SE_PE
      - trimgaloreinp.output2
      - bowtieinp.out.sam
      - datasource.Strain
      - bowtieinp.err
  createhubgroup: 
    cmd: cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/createhubgroup;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc; 	#ls * | grep -v err | xargs rm -rf; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/createhubgroup/err
    condition: groupby
    condition_params: 
      - Mark
    mem: 5000
    placeholders: 
      - createhubgroup
      - createhubgroup.err
  fastquality: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/fastquality;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tgunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/trimgalore/out_1_val_1.fq.gz | fastx_quality_stats -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/fastquality/out1;\n\tfastq_quality_boxplot_graph.sh -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/fastquality/out1 -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/fastquality/out1.png -t BM_B_20M_R_read1;\n\tgunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/trimgaloreinp/out_1_val_1.fq.gz | fastx_quality_stats -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/fastquality/Inpout1;\n\tfastq_quality_boxplot_graph.sh -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/fastquality/Inpout1 -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/fastquality/Inpout1.png -t BM_B_20M_R_input_read1;\n\tif [ PE == \"PE\" ];\n\tthen gunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/trimgalore/out_2_val_2.fq.gz | fastx_quality_stats -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/fastquality/out2;\n\t\tfastq_quality_boxplot_graph.sh -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/fastquality/out2 -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/fastquality/out2.png -t BM_B_20M_R_read2;\n\t\tgunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/trimgaloreinp/out_2_val_2.fq.gz | fastx_quality_stats -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/fastquality/Inpout2;\n\t\tfastq_quality_boxplot_graph.sh -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/fastquality/Inpout2 -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/fastquality/Inpout2.png -t BM_B_20M_R_input_read2;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/fastquality/err"
    condition: ~
    mem: 50
    placeholders: 
      - fastquality
      - trimgalore.output2
      - fastquality.out1
      - fastquality.out1
      - fastquality.out1.png
      - datasource.Name
      - trimgaloreinp.output2
      - fastquality.Inpout1
      - fastquality.Inpout1
      - fastquality.Inpout1.png
      - datasource.Name
      - datasource.SE_PE
      - trimgalore.output4
      - fastquality.out2
      - fastquality.out2
      - fastquality.out2.png
      - datasource.Name
      - trimgaloreinp.output4
      - fastquality.Inpout2
      - fastquality.Inpout2
      - fastquality.Inpout2.png
      - datasource.Name
      - fastquality.err
  macsmergedbroad: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergedbroad;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tlast=$(tail -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bedcorrelate/broadintersect.txt);\n\tint=${last%.*};\n\tif [ $int -gt 75 ];\n\t\tthen macs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -q 0.01 --broad --broad-cutoff 0.1 --fix-bimodal --extsize 250 --keep-dup auto;\n\t\t###\n\t\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergedbroad/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergedbroad/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergedbroad/FoldE.bdg -m FE\";\n\t\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergedbroad/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergedbroad/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergedbroad/FoldE.bdg -m FE;\n\t\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergedbroad/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergedbroad/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergedbroad/logLR.bdg -m logLR -p 0.00001\";\n\t\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergedbroad/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergedbroad/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergedbroad/logLR.bdg -m logLR -p 0.00001;\n\t\t###\n\t\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergedbroad/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\t\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergedbroad/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergedbroad/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\t\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergedbroad/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t\t###\n\t\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergedbroad/ChIPseqout_model.r;\n\t\tbroadpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergedbroad/ChIPseqout_peaks.broadPeak broadout;\n\t\tgappedpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergedbroad/ChIPseqout_peaks.gappedPeak gappedout;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergedbroad/err"
    condition: groupby
    condition_params: 
      - replicate
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.broadPeak
      - ChIPseqout_peaks.gappedPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
    placeholders: 
      - macsmergedbroad
      - datasource.SE_PE
      - bedcorrelate.broadintersect.txt
      - groupby.replicate.samtoolsview.out.sorted.bam
      - groupby.replicate.samtoolsviewInp.out.sorted.bam
      - datasource.sonication
      - macsmergedbroad.output4
      - macsmergedbroad.output5
      - macsmergedbroad.FoldE.bdg
      - macsmergedbroad.output4
      - macsmergedbroad.output5
      - macsmergedbroad.FoldE.bdg
      - macsmergedbroad.output4
      - macsmergedbroad.output5
      - macsmergedbroad.logLR.bdg
      - macsmergedbroad.output4
      - macsmergedbroad.output5
      - macsmergedbroad.logLR.bdg
      - macsmergedbroad.FoldE.bdg
      - input.mm10.len
      - macsmergedbroad.FoldE.bdg
      - input.mm10.len
      - macsmergedbroad.logLR.bdg
      - input.mm10.len
      - macsmergedbroad.logLR.bdg
      - input.mm10.len
      - macsmergedbroad.output3
      - macsmergedbroad.output1
      - macsmergedbroad.output2
      - macsmergedbroad.err
  macsmergednarrow: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergednarrow;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tlast=$(tail -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bedcorrelate/narrowintersect.txt);\n\tint=${last%.*};\n\tif [ $int -gt 75 ];\n\t\tthen macs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -q 0.01 --fix-bimodal --extsize 250 --keep-dup auto;\n\t\t###\n\t\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergednarrow/ChIPseqout_control_lambda.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergednarrow/FoldE.bw -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergednarrow/FoldE.bdg -m FE\";\n\t\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergednarrow/ChIPseqout_control_lambda.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergednarrow/FoldE.bw -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergednarrow/FoldE.bdg -m FE;\n\t\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergednarrow/ChIPseqout_control_lambda.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergednarrow/FoldE.bw -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergednarrow/logLR.bdg -m logLR -p 0.00001\";\n\t\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergednarrow/ChIPseqout_control_lambda.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergednarrow/FoldE.bw -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergednarrow/logLR.bdg -m logLR -p 0.00001;\n\t\t###\n\t\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergednarrow/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\t\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergednarrow/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergednarrow/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\t\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergednarrow/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t\t###\n\t\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergednarrow/ChIPseqout_model.r;\n\t\tnarrowpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergednarrow/ChIPseqout_peaks.narrowPeak narrowout;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsmergednarrow/err"
    condition: groupby
    condition_params: 
      - replicate
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.narrowPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
    placeholders: 
      - macsmergednarrow
      - datasource.SE_PE
      - bedcorrelate.narrowintersect.txt
      - groupby.replicate.samtoolsview.out.sorted.bam
      - groupby.replicate.samtoolsviewInp.out.sorted.bam
      - datasource.sonication
      - macsmergednarrow.output4
      - macsmergednarrow.output5
      - macsmergednarrow.FoldE.bdg
      - macsmergednarrow.output4
      - macsmergednarrow.output5
      - macsmergednarrow.FoldE.bdg
      - macsmergednarrow.output4
      - macsmergednarrow.output5
      - macsmergednarrow.logLR.bdg
      - macsmergednarrow.output4
      - macsmergednarrow.output5
      - macsmergednarrow.logLR.bdg
      - macsmergednarrow.FoldE.bdg
      - input.mm10.len
      - macsmergednarrow.FoldE.bdg
      - input.mm10.len
      - macsmergednarrow.logLR.bdg
      - input.mm10.len
      - macsmergednarrow.logLR.bdg
      - input.mm10.len
      - macsmergednarrow.output2
      - macsmergednarrow.output1
      - macsmergednarrow.err
  macsunmerged: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmerged;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; \tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tmacs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -p 1 --fix-bimodal --extsize 250 --keep-dup auto; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmerged/err"
    condition: ~
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.narrowPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
    placeholders: 
      - macsunmerged
      - datasource.SE_PE
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.sonication
      - macsunmerged.err
  macsunmergedbroadpeak: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergedbroadpeak;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; ls * | grep -v err | xargs rm -rf;\t. /nfs/users/nfs_r/rg12/.bashrc;\n\ttrap SomeErrorHandler ERR;\n\tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tmacs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -q 0.05 --broad --broad-cutoff 0.1 --fix-bimodal --extsize 250 --keep-dup auto;\n\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergedbroadpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergedbroadpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergedbroadpeak/FoldE.bdg -m FE\";\n\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergedbroadpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergedbroadpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergedbroadpeak/FoldE.bdg -m FE;\n\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergedbroadpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergedbroadpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergedbroadpeak/logLR.bdg -m logLR -p 0.00001\";\n\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergedbroadpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergedbroadpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergedbroadpeak/logLR.bdg -m logLR -p 0.00001;\n\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergedbroadpeak/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergedbroadpeak/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergedbroadpeak/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergedbroadpeak/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t>&2 echo \"Rscript\";\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergedbroadpeak/ChIPseqout_model.r;\n\tbroadpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergedbroadpeak/ChIPseqout_peaks.broadPeak broadout;\n\tgappedpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak gappedout;\n\tbedtools genomecov -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergedbroadpeak/ChIPseqout_peaks.broadPeak -g /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len -bg > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergedbroadpeak/broad.bdg;\n\tbedtools genomecov -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak -g /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len -bg > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergedbroadpeak/gapped.bdg; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergedbroadpeak/err"
    condition: ~
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.broadPeak
      - ChIPseqout_peaks.gappedPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
    placeholders: 
      - macsunmergedbroadpeak
      - datasource.SE_PE
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.sonication
      - macsunmergedbroadpeak.output4
      - macsunmergedbroadpeak.output5
      - macsunmergedbroadpeak.FoldE.bdg
      - macsunmergedbroadpeak.output4
      - macsunmergedbroadpeak.output5
      - macsunmergedbroadpeak.FoldE.bdg
      - macsunmergedbroadpeak.output4
      - macsunmergedbroadpeak.output5
      - macsunmergedbroadpeak.logLR.bdg
      - macsunmergedbroadpeak.output4
      - macsunmergedbroadpeak.output5
      - macsunmergedbroadpeak.logLR.bdg
      - macsunmergedbroadpeak.FoldE.bdg
      - input.mm10.len
      - macsunmergedbroadpeak.FoldE.bdg
      - input.mm10.len
      - macsunmergedbroadpeak.logLR.bdg
      - input.mm10.len
      - macsunmergedbroadpeak.logLR.bdg
      - input.mm10.len
      - macsunmergedbroadpeak.output3
      - macsunmergedbroadpeak.output1
      - macsunmergedbroadpeak.output2
      - macsunmergedbroadpeak.output1
      - input.mm10.len
      - macsunmergedbroadpeak.broad.bdg
      - macsunmergedbroadpeak.output2
      - input.mm10.len
      - macsunmergedbroadpeak.gapped.bdg
      - macsunmergedbroadpeak.err
  macsunmergednarrowpeak: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergednarrowpeak;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; ls * | grep -v err | xargs rm -rf;\t. /nfs/users/nfs_r/rg12/.bashrc;\n\ttrap SomeErrorHandler ERR;\n\tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tmacs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -q 0.01 --fix-bimodal --extsize 250 --keep-dup auto;\n\t###\n\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergednarrowpeak/FoldE.bdg -m FE\";\n\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergednarrowpeak/FoldE.bdg -m FE;\n\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergednarrowpeak/logLR.bdg -m logLR -p 0.00001\";\n\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergednarrowpeak/logLR.bdg -m logLR -p 0.00001;\n\t###\n\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergednarrowpeak/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergednarrowpeak/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergednarrowpeak/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergednarrowpeak/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t###\n\t>&2 echo \"Rscript\";\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergednarrowpeak/ChIPseqout_model.r;\n\tnarrowpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak narrowout;\n\t###\n\tbgzip /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg;\n\tbgzip /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg;\n\ttabix -p bed /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg.gz;\n\ttabix -p bed /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg.gz;\n\tbedtools genomecov -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak -g /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len -bg > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergednarrowpeak/narrow.bdg; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergednarrowpeak/err"
    condition: ~
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.narrowPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
      - ChIPseqout_treat_pileup.bdg.gz
      - ChIPseqout_control_lambda.bdg.gz
      - ChIPseqout_treat_pileup.bdg.gz.tbi
      - ChIPseqout_control_lambda.bdg.gz.tbi
    placeholders: 
      - macsunmergednarrowpeak
      - datasource.SE_PE
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.sonication
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.FoldE.bdg
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.FoldE.bdg
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.logLR.bdg
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.logLR.bdg
      - macsunmergednarrowpeak.FoldE.bdg
      - input.mm10.len
      - macsunmergednarrowpeak.FoldE.bdg
      - input.mm10.len
      - macsunmergednarrowpeak.logLR.bdg
      - input.mm10.len
      - macsunmergednarrowpeak.logLR.bdg
      - input.mm10.len
      - macsunmergednarrowpeak.output2
      - macsunmergednarrowpeak.output1
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.output7
      - macsunmergednarrowpeak.output8
      - macsunmergednarrowpeak.output1
      - input.mm10.len
      - macsunmergednarrowpeak.narrow.bdg
      - macsunmergednarrowpeak.err
  pdfmerge: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/pdfmerge;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\tls * | grep -v err | xargs rm -rf;\n\ttrap SomeErrorHandler ERR;\n\tpdfunite /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/annotatepeaksgroup/cluster.4.pdf /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/annotatepeaksgroup/cluster.4.pdf Cluster4.pdf;\n\tpdfunite /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/annotatepeaksgroup/cluster.5.pdf /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/annotatepeaksgroup/cluster.5.pdf Cluster5.pdf;\n\tpdfunite /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/annotatepeaksgroup/cluster.6.pdf /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/annotatepeaksgroup/cluster.6.pdf Cluster6.pdf;\n\tpdfunite /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/annotatepeaksgroup/cluster.7.pdf /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/annotatepeaksgroup/cluster.7.pdf Cluster7.pdf;\n\tpdfunite /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/annotatepeaksgroup/cluster.8.pdf /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/annotatepeaksgroup/cluster.8.pdf Cluster8.pdf;\n\tpdfunite /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/annotatepeaksgroup/cluster.9.pdf /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/annotatepeaksgroup/cluster.9.pdf Cluster9.pdf;\n\tpdfunite /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/annotatepeaksgroup/cluster.10.pdf /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/annotatepeaksgroup/cluster.10.pdf Cluster10.pdf; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/pdfmerge/err"
    condition: groupby
    condition_params: 
      - Mark
    cores: 5
    mem: 5000
    placeholders: 
      - pdfmerge
      - groupby.Mark.annotatepeaksgroup.cluster.4.pdf
      - groupby.Mark.annotatepeaksgroup.cluster.5.pdf
      - groupby.Mark.annotatepeaksgroup.cluster.6.pdf
      - groupby.Mark.annotatepeaksgroup.cluster.7.pdf
      - groupby.Mark.annotatepeaksgroup.cluster.8.pdf
      - groupby.Mark.annotatepeaksgroup.cluster.9.pdf
      - groupby.Mark.annotatepeaksgroup.cluster.10.pdf
      - pdfmerge.err
  pie: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/pie;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; ls * | grep -v err | xargs rm -rf;\t. /nfs/users/nfs_r/rg12/.bashrc;\n\ttrap SomeErrorHandler ERR;\n\t#gapped broad output\n\tbedtools intersect -loj -a /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak -b /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/ens_genes_and_promoter_distal.bed > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/pie/out;\n\tbedtools intersect -loj -a /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak -b /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/ens_genes_and_promoter_distal.bed > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/pie/out2;\n\tbedtools intersect -wa -b /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak -a /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/ens_genes_and_promoter_distal.bed > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/pie/out3;\n\tbedtools intersect -wa -b /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak -a /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/ens_genes_and_promoter_distal.bed > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/pie/out4;\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/pie.R $(grep -c Gene /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/pie/out) $(grep -c Distal /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/pie/out) $(grep -c Promoter /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/pie/out) $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/pie/out |wc -l) rplot_broad.pdf > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/pie/broad\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/pie.R $(grep -c Gene /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/pie/out2) $(grep -c Distal /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/pie/out2) $(grep -c Promoter /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/pie/out2) $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/pie/out2 |wc -l) rplot_narrow.pdf > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/pie/narrow\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/pie.R $(grep -c Gene /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/pie/out3) $(grep -c Distal /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/pie/out3) $(grep -c Promoter /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/pie/out3) $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/pie/out3 |wc -l) rplot_gene_broad.pdf > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/pie/gene_broad\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/pie.R $(grep -c Gene /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/pie/out4) $(grep -c Distal /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/pie/out4) $(grep -c Promoter /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/pie/out4) $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/pie/out4 |wc -l) rplot_gene_narrow.pdf > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/pie/gene_narrow 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/pie/err"
    condition: ~
    mem: 5000
    placeholders: 
      - pie
      - macsunmergedbroadpeak.output2
      - input.ens_genes_and_promoter_distal.bed
      - pie.out
      - macsunmergednarrowpeak.output1
      - input.ens_genes_and_promoter_distal.bed
      - pie.out2
      - macsunmergedbroadpeak.output2
      - input.ens_genes_and_promoter_distal.bed
      - pie.out3
      - macsunmergednarrowpeak.output1
      - input.ens_genes_and_promoter_distal.bed
      - pie.out4
      - software.pie.R
      - pie.out
      - pie.out
      - pie.out
      - pie.out
      - pie.broad
      - software.pie.R
      - pie.out2
      - pie.out2
      - pie.out2
      - pie.out2
      - pie.narrow
      - software.pie.R
      - pie.out3
      - pie.out3
      - pie.out3
      - pie.out3
      - pie.gene_broad
      - software.pie.R
      - pie.out4
      - pie.out4
      - pie.out4
      - pie.out4
      - pie.gene_narrow
      - pie.err
  samtoolsview: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/samtoolsview;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\ttest -e /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bowtie/out.sam;\n\tsamtools view -hSb /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bowtie/out.sam> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/samtoolsview/out.bam;\n\tsamtools sort /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/samtoolsview/out.bam out.sorted;\n\tsamtools index /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/samtoolsview/out.sorted.bam;\n\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bowtie/out.sam; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/samtoolsview/err"
    condition: ~
    mem: 2000
    outputfiles: 
      - out.sorted.bam
      - out.sorted.bam.bai
    placeholders: 
      - samtoolsview
      - bowtie.out.sam
      - bowtie.out.sam
      - samtoolsview.out.bam
      - samtoolsview.out.bam
      - samtoolsview.output1
      - bowtie.out.sam
      - samtoolsview.err
  samtoolsviewInp: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/samtoolsviewInp;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\ttest -e /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bowtieinp/out.sam;\n\tsamtools view -hSb /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bowtieinp/out.sam > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/samtoolsviewInp/out.bam;\n\tsamtools sort /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/samtoolsviewInp/out.bam out.sorted;\n\tsamtools index /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/samtoolsviewInp/out.sorted.bam;\n\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bowtieinp/out.sam; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/samtoolsviewInp/err"
    condition: ~
    mem: 2000
    outputfiles: 
      - out.sorted.bam
      - out.sorted.bam.bai
    placeholders: 
      - samtoolsviewInp
      - bowtieinp.out.sam
      - bowtieinp.out.sam
      - samtoolsviewInp.out.bam
      - samtoolsviewInp.out.bam
      - samtoolsviewInp.output1
      - bowtieinp.out.sam
      - samtoolsviewInp.err
  seperateclusters: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/seperateclusters;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\tls * | grep -v err | xargs rm -rf;\n\ttrap SomeErrorHandler ERR;\n\tclusters=4;\n\tcp /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/annotatepeaksgroup/cluster.4.RData /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/seperateclusters/clusters.RData;\n\tExtractGName.R /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/seperateclusters/clusters.RData;\n\t>&2 echo \"cluster1-4\";\n\tfor i in {1..4}\n\tdo\n\t\t>&2 echo \"cluster\" ${i};\n\t\techo -e \"/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/samtoolsviewInp/out.sorted.bam\tclusters.1.cluster${i}.txt\t\\\"H4K20me3 B Cell\\\"\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/seperateclusters/config.txt;\n\t\t>&2 echo \"ngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/seperateclusters/config.txt -O heatmapclusters.${i} -L 5000 -GO total -CO blue:white:red -P 5\";\n\t\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/seperateclusters/config.txt -O heatmapclusters.${i} -L 3000 -GO total -CO blue:white:red -P 5;\n\t\tconvert -density 150 heatmapclusters.${i}.heatmap.pdf -quality 90 heatmapclusters.${i}.heatmap.png;\n\tdone 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/seperateclusters/err"
    condition: ~
    cores: 5
    mem: 5000
    placeholders: 
      - seperateclusters
      - annotatepeaksgroup.output1
      - seperateclusters.clusters.RData
      - seperateclusters.clusters.RData
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.mark_full
      - datasource.Cell
      - seperateclusters.config.txt
      - seperateclusters.config.txt
      - seperateclusters.config.txt
      - seperateclusters.err
  summarystats: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/summarystats;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;trap SomeErrorHandler ERR;\tif [ PE == \"PE\" ];\n\t\tthen if [ TRUE == \"TRUE\" ];\n\t\t\tthen echo \"BM_B_20M_R_lane1\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_20M_R/BM_B_20M_R_1.bam >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/summarystats/out.flagstat;\n\t\t\techo \"BM_B_20M_R_lane2\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_20M_R/BM_B_20M_R_2.bam >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/summarystats/out.flagstat;\n\t\telse echo \"BM_B_20M_R\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/summarystats/out.flagstat;\n\t\t\techo \"FastQ\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/summarystats/out.flagstat;\n\t\tfi;\n\t\tif [ TRUE == \"TRUE\" ];\n\t\t\tthen echo \"Inp_BM_B_20M_R_lane1\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_INP_R/BM_B_INP_R_1.bam >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/summarystats/out.flagstat;\n\t\t\techo \"Inp_BM_B_20M_R_lane2\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_INP_R/BM_B_INP_R_2.bam >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/summarystats/out.flagstat;\n\t\telse echo \"Inp_BM_B_20M_R\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/summarystats/out.flagstat;\n\t\t\techo \"FastQ\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/summarystats/out.flagstat;\n\t\tfi;\n\telse if [ TRUE == \"TRUE\" ]; ### CHECK THIS!! SHOULD be INP_1 and INP_2\n\t\tthen echo \"BM_B_20M_R_lane1\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_20M_R/BM_B_20M_R_1.bam >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/summarystats/out.flagstat;\n\t\t\techo \"BM_B_20M_R_lane2\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_20M_R/BM_B_20M_R_2.bam >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/summarystats/out.flagstat;\n\t\telse echo \"BM_B_20M_R\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/summarystats/out.flagstat;\n\t\t\techo \"FastQ\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/summarystats/out.flagstat;\n\t\tfi;\n\t\tif [ TRUE == \"TRUE\" ];\n\t\t\tthen echo \"Inp_BM_B_20M_R_lane1\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_INP_R/BM_B_INP_R_1.bam >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/summarystats/out.flagstat;\n\t\t\techo \"Inp_BM_B_20M_R_lane2\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_INP_R/BM_B_INP_R_2.bam >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/summarystats/out.flagstat;\n\t\telse echo \"Inp_BM_B_20M_R\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/summarystats/out.flagstat;\n\t\t\techo \"FastQ\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/summarystats/out.flagstat;\n\t\tfi;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/summarystats/err"
    condition: ~
    mem: 1000
    placeholders: 
      - summarystats
      - datasource.SE_PE
      - datasource.bam
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - summarystats.out.flagstat
      - datasource.Inp_bam
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.Inp_location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.Inp_location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - summarystats.out.flagstat
      - datasource.bam
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - summarystats.out.flagstat
      - datasource.Inp_bam
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.Inp_location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.Inp_location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - summarystats.out.flagstat
      - summarystats.err
  trimgalore: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/trimgalore;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tlength=$(gunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofq/out_1.fq.gz | head -2| tail -1 | wc -c);\n\tlength=$[length-11];\n\tif [ PE == \"PE\" ];\n\tthen\n\t\ttrim_galore --fastqc --gzip --length $length --paired -a TTAGGCAT --stringency 4 --trim1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofq/out_1.fq.gz /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofq/out_2.fq.gz;\n\telse\n\t\ttrim_galore --fastqc --gzip --length $length -a TTAGGCAT --stringency 4 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofq/out_1.fq.gz;\n\n\t\tmv out_1_trimmed.fq.gz out_1_val_1.fq.gz;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/trimgalore/err"
    condition: ~
    cores: 3
    mem: 2000
    outputfiles: 
      - out_1.fq.gz_trimming_report.txt
      - out_1_val_1.fq.gz
      - out_2.fq.gz_trimming_report.txt
      - out_2_val_2.fq.gz
      - out_1_val_1.html
      - out_1_val_1.zip
      - out_2_val_2.html
      - out_2_val_2.zip
    placeholders: 
      - trimgalore
      - bamtofq.out_1.fq.gz
      - datasource.SE_PE
      - datasource.Tag
      - bamtofq.out_1.fq.gz
      - bamtofq.out_2.fq.gz
      - datasource.Tag
      - bamtofq.out_1.fq.gz
      - trimgalore.err
  trimgaloreinp: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/trimgaloreinp;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tlength=$(gunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofqinp/out_1.fq.gz | head -2| tail -1 | wc -c);\n\tlength=$[length-11];\n\tif [ PE == \"PE\" ];\n\tthen\n\t\ttrim_galore --fastqc --gzip --length $length --paired -a GATCAGCG --stringency 4 --trim1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofqinp/out_1.fq.gz /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofqinp/out_2.fq.gz;\n\telse\n\t\ttrim_galore --fastqc --gzip --length $length -a GATCAGCG --stringency 4 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/bamtofqinp/out_1.fq.gz;\n\t\tmv out_1_trimmed.fq.gz out_1_val_1.fq.gz; ### should FIX\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/trimgaloreinp/err"
    condition: ~
    cores: 3
    mem: 2000
    outputfiles: 
      - out_1.fq.gz_trimming_report.txt
      - out_1_val_1.fq.gz
      - out_2.fq.gz_trimming_report.txt
      - out_2_val_2.fq.gz
      - out_1_val_1.html
      - out_1_val_1.zip
      - out_2_val_2.html
      - out_2_val_2.zip
    placeholders: 
      - trimgaloreinp
      - bamtofqinp.out_1.fq.gz
      - datasource.SE_PE
      - datasource.Inp_Tag
      - bamtofqinp.out_1.fq.gz
      - bamtofqinp.out_2.fq.gz
      - datasource.Inp_Tag
      - bamtofqinp.out_1.fq.gz
      - trimgaloreinp.err
  wigcorrelate: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/wigcorrelate;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tls /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/macsunmergedbroadpeak/FoldE.bw;\n\tlength=(/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmergedbroadpeak/FoldE.bw);\n\t#Change FoldE.bw to output16\n\tif [ ${#length[@]} != 1 ];\n\t\tthen\n\t\twigCorrelate /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/macsunmerged/FoldE.bw > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/wigcorrelate/out;\n\tfi; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job2/wigcorrelate/err"
    condition: groupby
    condition_params: 
      - replicate
    cores: 4
    mem: 5000
    placeholders: 
      - wigcorrelate
      - macsunmergedbroadpeak.output6
      - groupby.replicate.macsunmergedbroadpeak.FoldE.bw
      - groupby.replicate.macsunmerged.FoldE.bw
      - wigcorrelate.out
      - wigcorrelate.err
3: 
  annotatepeaks: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/annotatepeaks;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\tls * | grep -v err | xargs rm -rf;\n\ttrap SomeErrorHandler ERR;\n\tclusters=4\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/samtoolsviewInp/out.sorted.bam -T \"H3K36me3 B Cell\" -O out -L 3000 -GO km -KNC ${clusters} -CO blue:white:red -P 5 -FI 1;\n\t/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/ExtractGeneClusterings.r out;\n\tfor i in $(seq 1 ${clusters});\n\tdo\n\t\techo -e \"/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/samtoolsviewInp/out.sorted.bam\tout.cluster${i}.txt\t\\\"H3K36me3 B Cell Cluster${i}\\\"\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/annotatepeaks/config.txt;\n\tdone\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/annotatepeaks/config.txt -O clusters -L 3000 -GO hc -CO blue:white:red -P 5;\n\tcat > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/annotatepeaks/configB.txt << EOF\n/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/samtoolsviewInp/out.sorted.bam\t/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/B_ordered_TPM.txt\t\"H3K36me3 B cell\"\nEOF\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/annotatepeaks/configB.txt -O TPMorderedB -L 3000 -GO none -CO blue:white:red -P 5;\n\tcat > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/annotatepeaks/configT.txt << EOF\n/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/samtoolsviewInp/out.sorted.bam\t/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/T_ordered_TPM.txt\t\"H3K36me3 T cell\"\nEOF\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/annotatepeaks/configT.txt -O TPMorderedT -L 3000 -GO none -CO blue:white:red -P 5; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/annotatepeaks/err"
    condition: ~
    cores: 5
    mem: 5000
    placeholders: 
      - annotatepeaks
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.mark_full
      - datasource.Cell
      - software.ExtractGeneClusterings.r
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.mark_full
      - datasource.Cell
      - annotatepeaks.config.txt
      - annotatepeaks.config.txt
      - annotatepeaks.configB.txt
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - input.B_ordered_TPM.txt
      - datasource.mark_full
      - annotatepeaks.configB.txt
      - annotatepeaks.configT.txt
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - input.T_ordered_TPM.txt
      - datasource.mark_full
      - annotatepeaks.configT.txt
      - annotatepeaks.err
  annotatepeaksgroup: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/annotatepeaksgroup;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\tls * | grep -v err | xargs rm -rf;\n\ttrap SomeErrorHandler ERR;\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/samtoolsviewInp/out.sorted.bam -T \"H3K36me3 B Cell\" -O out -L 3000 -CO blue:white:red -P 5 -FI 0;\n\tfor clusters in {4..10};\n\t\tdo name=\"cluster.${clusters}\";\n\t\treplot.r heatmap -I out.zip -O ${name} -T \"H3K36me3 B Cell\" -L 3000 -GO km -KNC ${clusters} -CO blue:white:red -P 5;\n\t\tExtractGName.R ${name}.RData;\n\tdone 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/annotatepeaksgroup/err"
    condition: ~
    cores: 5
    mem: 5000
    outputfiles: 
      - cluster.4.RData
    placeholders: 
      - annotatepeaksgroup
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.mark_full
      - datasource.Cell
      - datasource.mark_full
      - datasource.Cell
      - annotatepeaksgroup.err
  bamtofq: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofq;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;trap SomeErrorHandler ERR;\tif [ TRUE == \"TRUE\" ];\n\t\tthen samtools sort /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_36M_R/BM_B_36M_R_1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofq/lane1;\n\t\tsamtools sort /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_36M_R/BM_B_36M_R_2.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofq/lane2;\n\t\tsamtools merge /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofq/merged.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofq/lane1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofq/lane2.bam;\n\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofq/lane1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofq/lane2.bam;\n\t\tif [ PE == \"PE\" ];\n\t\t\tthen\n\t\t\t\tbamtofastq filename=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofq/merged.bam gz=1 F=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofq/out_1.fq.gz F2=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofq/out_2.fq.gz;\n\t\t\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofq/merged.bam;\n\t\t\telse\n\t\t\t\tbamtofastq gz=1 filename=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofq/merged.bam > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofq/out_1.fq.gz;\n\t\t\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofq/merged.bam;\n\t\t\tfi;\n\t\telse\n\t\t\tcat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_36M_R/BM_B_36M_R* > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofq/out_1.fq.gz;\n\t\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofq/err"
    condition: ~
    mem: 1500
    placeholders: 
      - bamtofq
      - datasource.bam
      - datasource.location
      - bamtofq.lane1
      - datasource.location
      - bamtofq.lane2
      - bamtofq.merged.bam
      - bamtofq.lane1
      - bamtofq.lane2
      - bamtofq.lane1
      - bamtofq.lane2
      - datasource.SE_PE
      - bamtofq.merged.bam
      - bamtofq.out_1.fq.gz
      - bamtofq.out_2.fq.gz
      - bamtofq.merged.bam
      - bamtofq.merged.bam
      - bamtofq.out_1.fq.gz
      - bamtofq.merged.bam
      - datasource.location
      - bamtofq.out_1.fq.gz
      - bamtofq.err
  bamtofqinp: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofqinp;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;trap SomeErrorHandler ERR;\tif [ TRUE == \"TRUE\" ];\n\t\tthen samtools sort /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_INP_R/BM_B_INP_R_1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofqinp/lane1;\n\t\tsamtools sort /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_INP_R/BM_B_INP_R_2.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofqinp/lane2;\n\t\tsamtools merge /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofqinp/merged.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofqinp/lane1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofqinp/lane2.bam;\n\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofqinp/lane1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofqinp/lane2.bam;\n\t\tif [ PE == \"PE\" ];\n\t\t\tthen\n\t\t\t\tbamtofastq gz=1 filename=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofqinp/merged.bam F=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofqinp/out_1.fq.gz F2=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofqinp/out_2.fq.gz;\n\t\t\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofqinp/merged.bam;\n\t\t\telse bamtofastq gz=1 filename=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofqinp/merged.bam > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofqinp/out_1.fq.gz;\n\t\t\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofqinp/merged.bam;\n\t\tfi;\n\telse cat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_INP_R/BM_B_INP_R* > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofqinp/out_1.fq.gz;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofqinp/err"
    condition: ~
    mem: 1500
    placeholders: 
      - bamtofqinp
      - datasource.Inp_bam
      - datasource.Inp_location
      - bamtofqinp.lane1
      - datasource.Inp_location
      - bamtofqinp.lane2
      - bamtofqinp.merged.bam
      - bamtofqinp.lane1
      - bamtofqinp.lane2
      - bamtofqinp.lane1
      - bamtofqinp.lane2
      - datasource.SE_PE
      - bamtofqinp.merged.bam
      - bamtofqinp.out_1.fq.gz
      - bamtofqinp.out_2.fq.gz
      - bamtofqinp.merged.bam
      - bamtofqinp.merged.bam
      - bamtofqinp.out_1.fq.gz
      - bamtofqinp.merged.bam
      - datasource.Inp_location
      - bamtofqinp.out_1.fq.gz
      - bamtofqinp.err
  bedcorrelate: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bedcorrelate;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tbroadreplicates=(/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergedbroadpeak/ChIPseqout_peaks.broadPeak);\n\tgappedreplicates=(/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak);\n\tnarrowreplicates=(/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak);\n\t###\n\tbedtools intersect -u -a ${broadreplicates[0]} -b ${broadreplicates[1]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bedcorrelate/broadintersect.bed;\n\tbedtools intersect -u -a ${gappedreplicates[0]} -b ${gappedreplicates[1]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bedcorrelate/gappedintersect.bed;\n\tbedtools intersect -u -a ${narrowreplicates[0]} -b ${narrowreplicates[1]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bedcorrelate/narrowintersect.bed;\n\tbedtools intersect -u -a ${broadreplicates[1]} -b ${broadreplicates[0]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bedcorrelate/broadintersect2.bed;\n\tbedtools intersect -u -a ${gappedreplicates[1]} -b ${gappedreplicates[0]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bedcorrelate/gappedintersect2.bed;\n\tbedtools intersect -u -a ${narrowreplicates[1]} -b ${narrowreplicates[0]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bedcorrelate/narrowintersect2.bed;\n\t###\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bedcorrelate/broadintersect.bed|wc -l ) \"/\" $(cat ${broadreplicates[0]} |wc -l ) \") *100\"|bc >/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bedcorrelate/broadintersect.txt;\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bedcorrelate/gappedintersect.bed|wc -l ) \"/\" $(cat ${gappedreplicates[0]} |wc -l ) \") *100\"|bc >/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bedcorrelate/gappedintersect.txt;\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bedcorrelate/narrowintersect.bed|wc -l ) \"/\" $(cat ${narrowreplicates[0]} |wc -l ) \") *100\"|bc >/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bedcorrelate/narrowintersect.txt;\n\t###\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bedcorrelate/broadintersect2.bed|wc -l ) \"/\" $(cat ${broadreplicates[1]} |wc -l ) \") *100\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bedcorrelate/broadintersect.txt;\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bedcorrelate/gappedintersect2.bed|wc -l ) \"/\" $(cat ${gappedreplicates[1]} |wc -l ) \") *100\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bedcorrelate/gappedintersect.txt;\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bedcorrelate/narrowintersect2.bed|wc -l ) \"/\" $(cat ${narrowreplicates[1]} |wc -l ) \") *100\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bedcorrelate/narrowintersect.txt;\n\t###\n\techo \"scale=4;((\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bedcorrelate/broadintersect.bed|wc -l ) \"/\" $(cat ${broadreplicates[0]} |wc -l ) \")+(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bedcorrelate/broadintersect2.bed|wc -l ) \"/\" $(cat ${broadreplicates[1]} |wc -l ) \")) *50\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bedcorrelate/broadintersect.txt;\n\techo \"scale=4;((\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bedcorrelate/gappedintersect.bed|wc -l ) \"/\" $(cat ${gappedreplicates[0]} |wc -l ) \")+(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bedcorrelate/gappedintersect2.bed|wc -l ) \"/\" $(cat ${gappedreplicates[1]} |wc -l ) \")) *50\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bedcorrelate/gappedintersect.txt;\n\techo \"scale=4;((\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bedcorrelate/narrowintersect.bed|wc -l ) \"/\" $(cat ${narrowreplicates[0]} |wc -l ) \")+(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bedcorrelate/narrowintersect2.bed|wc -l ) \"/\" $(cat ${narrowreplicates[1]} |wc -l ) \")) *50\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bedcorrelate/narrowintersect.txt; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bedcorrelate/err"
    condition: groupby
    condition_params: 
      - replicate
    cores: 4
    mem: 5000
    placeholders: 
      - bedcorrelate
      - groupby.replicate.macsunmergedbroadpeak.ChIPseqout_peaks.broadPeak
      - groupby.replicate.macsunmergedbroadpeak.ChIPseqout_peaks.gappedPeak
      - groupby.replicate.macsunmergednarrowpeak.ChIPseqout_peaks.narrowPeak
      - bedcorrelate.broadintersect.bed
      - bedcorrelate.gappedintersect.bed
      - bedcorrelate.narrowintersect.bed
      - bedcorrelate.broadintersect2.bed
      - bedcorrelate.gappedintersect2.bed
      - bedcorrelate.narrowintersect2.bed
      - bedcorrelate.broadintersect.bed
      - bedcorrelate.broadintersect.txt
      - bedcorrelate.gappedintersect.bed
      - bedcorrelate.gappedintersect.txt
      - bedcorrelate.narrowintersect.bed
      - bedcorrelate.narrowintersect.txt
      - bedcorrelate.broadintersect2.bed
      - bedcorrelate.broadintersect.txt
      - bedcorrelate.gappedintersect2.bed
      - bedcorrelate.gappedintersect.txt
      - bedcorrelate.narrowintersect2.bed
      - bedcorrelate.narrowintersect.txt
      - bedcorrelate.broadintersect.bed
      - bedcorrelate.broadintersect2.bed
      - bedcorrelate.broadintersect.txt
      - bedcorrelate.gappedintersect.bed
      - bedcorrelate.gappedintersect2.bed
      - bedcorrelate.gappedintersect.txt
      - bedcorrelate.narrowintersect.bed
      - bedcorrelate.narrowintersect2.bed
      - bedcorrelate.narrowintersect.txt
      - bedcorrelate.err
  bowtie: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bowtie;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tls /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_build/touch /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_buildcast/touch;\n\tif [ PE == \"PE\" ];\n\t\tthen /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/bowtierun -p PE -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/trimgalore/out_1_val_1.fq.gz -2 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/trimgalore/out_2_val_2.fq.gz -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bowtie/out.sam -s C57BL6J;\n\telse /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/bowtierun -p PE -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/trimgalore/out_1_val_1.fq.gz -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bowtie/out.sam -s C57BL6J;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bowtie/err"
    condition: ~
    cores: 14
    mem: 7000
    placeholders: 
      - bowtie
      - bowtie_build.touch
      - bowtie_buildcast.touch
      - datasource.SE_PE
      - software.bowtierun
      - datasource.SE_PE
      - trimgalore.output2
      - trimgalore.output4
      - bowtie.out.sam
      - datasource.Strain
      - software.bowtierun
      - datasource.SE_PE
      - trimgalore.output2
      - bowtie.out.sam
      - datasource.Strain
      - bowtie.err
  bowtieinp: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bowtieinp;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tls /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_build/touch /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_buildcast/touch;\n\tif [ PE == \"PE\" ];\n\t\tthen /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/bowtierun -p PE -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/trimgaloreinp/out_1_val_1.fq.gz -2 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/trimgaloreinp/out_2_val_2.fq.gz -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bowtieinp/out.sam -s C57BL6J;\n\telse /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/bowtierun -p PE -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/trimgaloreinp/out_1_val_1.fq.gz -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bowtieinp/out.sam -s C57BL6J;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bowtieinp/err"
    condition: ~
    cores: 14
    mem: 7000
    placeholders: 
      - bowtieinp
      - bowtie_build.touch
      - bowtie_buildcast.touch
      - datasource.SE_PE
      - software.bowtierun
      - datasource.SE_PE
      - trimgaloreinp.output2
      - trimgaloreinp.output4
      - bowtieinp.out.sam
      - datasource.Strain
      - software.bowtierun
      - datasource.SE_PE
      - trimgaloreinp.output2
      - bowtieinp.out.sam
      - datasource.Strain
      - bowtieinp.err
  createhubgroup: 
    cmd: cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/createhubgroup;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc; 	#ls * | grep -v err | xargs rm -rf; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/createhubgroup/err
    condition: groupby
    condition_params: 
      - Mark
    mem: 5000
    placeholders: 
      - createhubgroup
      - createhubgroup.err
  fastquality: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/fastquality;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tgunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/trimgalore/out_1_val_1.fq.gz | fastx_quality_stats -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/fastquality/out1;\n\tfastq_quality_boxplot_graph.sh -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/fastquality/out1 -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/fastquality/out1.png -t BM_B_36M_R_read1;\n\tgunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/trimgaloreinp/out_1_val_1.fq.gz | fastx_quality_stats -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/fastquality/Inpout1;\n\tfastq_quality_boxplot_graph.sh -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/fastquality/Inpout1 -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/fastquality/Inpout1.png -t BM_B_36M_R_input_read1;\n\tif [ PE == \"PE\" ];\n\tthen gunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/trimgalore/out_2_val_2.fq.gz | fastx_quality_stats -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/fastquality/out2;\n\t\tfastq_quality_boxplot_graph.sh -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/fastquality/out2 -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/fastquality/out2.png -t BM_B_36M_R_read2;\n\t\tgunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/trimgaloreinp/out_2_val_2.fq.gz | fastx_quality_stats -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/fastquality/Inpout2;\n\t\tfastq_quality_boxplot_graph.sh -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/fastquality/Inpout2 -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/fastquality/Inpout2.png -t BM_B_36M_R_input_read2;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/fastquality/err"
    condition: ~
    mem: 50
    placeholders: 
      - fastquality
      - trimgalore.output2
      - fastquality.out1
      - fastquality.out1
      - fastquality.out1.png
      - datasource.Name
      - trimgaloreinp.output2
      - fastquality.Inpout1
      - fastquality.Inpout1
      - fastquality.Inpout1.png
      - datasource.Name
      - datasource.SE_PE
      - trimgalore.output4
      - fastquality.out2
      - fastquality.out2
      - fastquality.out2.png
      - datasource.Name
      - trimgaloreinp.output4
      - fastquality.Inpout2
      - fastquality.Inpout2
      - fastquality.Inpout2.png
      - datasource.Name
      - fastquality.err
  macsmergedbroad: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergedbroad;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tlast=$(tail -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bedcorrelate/broadintersect.txt);\n\tint=${last%.*};\n\tif [ $int -gt 75 ];\n\t\tthen macs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -q 0.01 --broad --broad-cutoff 0.1 --fix-bimodal --extsize 250 --keep-dup auto;\n\t\t###\n\t\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergedbroad/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergedbroad/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergedbroad/FoldE.bdg -m FE\";\n\t\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergedbroad/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergedbroad/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergedbroad/FoldE.bdg -m FE;\n\t\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergedbroad/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergedbroad/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergedbroad/logLR.bdg -m logLR -p 0.00001\";\n\t\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergedbroad/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergedbroad/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergedbroad/logLR.bdg -m logLR -p 0.00001;\n\t\t###\n\t\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergedbroad/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\t\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergedbroad/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergedbroad/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\t\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergedbroad/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t\t###\n\t\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergedbroad/ChIPseqout_model.r;\n\t\tbroadpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergedbroad/ChIPseqout_peaks.broadPeak broadout;\n\t\tgappedpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergedbroad/ChIPseqout_peaks.gappedPeak gappedout;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergedbroad/err"
    condition: groupby
    condition_params: 
      - replicate
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.broadPeak
      - ChIPseqout_peaks.gappedPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
    placeholders: 
      - macsmergedbroad
      - datasource.SE_PE
      - bedcorrelate.broadintersect.txt
      - groupby.replicate.samtoolsview.out.sorted.bam
      - groupby.replicate.samtoolsviewInp.out.sorted.bam
      - datasource.sonication
      - macsmergedbroad.output4
      - macsmergedbroad.output5
      - macsmergedbroad.FoldE.bdg
      - macsmergedbroad.output4
      - macsmergedbroad.output5
      - macsmergedbroad.FoldE.bdg
      - macsmergedbroad.output4
      - macsmergedbroad.output5
      - macsmergedbroad.logLR.bdg
      - macsmergedbroad.output4
      - macsmergedbroad.output5
      - macsmergedbroad.logLR.bdg
      - macsmergedbroad.FoldE.bdg
      - input.mm10.len
      - macsmergedbroad.FoldE.bdg
      - input.mm10.len
      - macsmergedbroad.logLR.bdg
      - input.mm10.len
      - macsmergedbroad.logLR.bdg
      - input.mm10.len
      - macsmergedbroad.output3
      - macsmergedbroad.output1
      - macsmergedbroad.output2
      - macsmergedbroad.err
  macsmergednarrow: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergednarrow;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tlast=$(tail -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bedcorrelate/narrowintersect.txt);\n\tint=${last%.*};\n\tif [ $int -gt 75 ];\n\t\tthen macs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -q 0.01 --fix-bimodal --extsize 250 --keep-dup auto;\n\t\t###\n\t\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergednarrow/ChIPseqout_control_lambda.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergednarrow/FoldE.bw -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergednarrow/FoldE.bdg -m FE\";\n\t\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergednarrow/ChIPseqout_control_lambda.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergednarrow/FoldE.bw -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergednarrow/FoldE.bdg -m FE;\n\t\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergednarrow/ChIPseqout_control_lambda.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergednarrow/FoldE.bw -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergednarrow/logLR.bdg -m logLR -p 0.00001\";\n\t\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergednarrow/ChIPseqout_control_lambda.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergednarrow/FoldE.bw -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergednarrow/logLR.bdg -m logLR -p 0.00001;\n\t\t###\n\t\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergednarrow/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\t\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergednarrow/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergednarrow/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\t\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergednarrow/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t\t###\n\t\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergednarrow/ChIPseqout_model.r;\n\t\tnarrowpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergednarrow/ChIPseqout_peaks.narrowPeak narrowout;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsmergednarrow/err"
    condition: groupby
    condition_params: 
      - replicate
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.narrowPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
    placeholders: 
      - macsmergednarrow
      - datasource.SE_PE
      - bedcorrelate.narrowintersect.txt
      - groupby.replicate.samtoolsview.out.sorted.bam
      - groupby.replicate.samtoolsviewInp.out.sorted.bam
      - datasource.sonication
      - macsmergednarrow.output4
      - macsmergednarrow.output5
      - macsmergednarrow.FoldE.bdg
      - macsmergednarrow.output4
      - macsmergednarrow.output5
      - macsmergednarrow.FoldE.bdg
      - macsmergednarrow.output4
      - macsmergednarrow.output5
      - macsmergednarrow.logLR.bdg
      - macsmergednarrow.output4
      - macsmergednarrow.output5
      - macsmergednarrow.logLR.bdg
      - macsmergednarrow.FoldE.bdg
      - input.mm10.len
      - macsmergednarrow.FoldE.bdg
      - input.mm10.len
      - macsmergednarrow.logLR.bdg
      - input.mm10.len
      - macsmergednarrow.logLR.bdg
      - input.mm10.len
      - macsmergednarrow.output2
      - macsmergednarrow.output1
      - macsmergednarrow.err
  macsunmerged: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmerged;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; \tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tmacs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -p 1 --fix-bimodal --extsize 250 --keep-dup auto; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmerged/err"
    condition: ~
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.narrowPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
    placeholders: 
      - macsunmerged
      - datasource.SE_PE
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.sonication
      - macsunmerged.err
  macsunmergedbroadpeak: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergedbroadpeak;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; ls * | grep -v err | xargs rm -rf;\t. /nfs/users/nfs_r/rg12/.bashrc;\n\ttrap SomeErrorHandler ERR;\n\tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tmacs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -q 0.05 --broad --broad-cutoff 0.1 --fix-bimodal --extsize 250 --keep-dup auto;\n\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergedbroadpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergedbroadpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergedbroadpeak/FoldE.bdg -m FE\";\n\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergedbroadpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergedbroadpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergedbroadpeak/FoldE.bdg -m FE;\n\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergedbroadpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergedbroadpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergedbroadpeak/logLR.bdg -m logLR -p 0.00001\";\n\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergedbroadpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergedbroadpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergedbroadpeak/logLR.bdg -m logLR -p 0.00001;\n\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergedbroadpeak/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergedbroadpeak/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergedbroadpeak/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergedbroadpeak/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t>&2 echo \"Rscript\";\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergedbroadpeak/ChIPseqout_model.r;\n\tbroadpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergedbroadpeak/ChIPseqout_peaks.broadPeak broadout;\n\tgappedpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak gappedout;\n\tbedtools genomecov -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergedbroadpeak/ChIPseqout_peaks.broadPeak -g /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len -bg > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergedbroadpeak/broad.bdg;\n\tbedtools genomecov -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak -g /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len -bg > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergedbroadpeak/gapped.bdg; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergedbroadpeak/err"
    condition: ~
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.broadPeak
      - ChIPseqout_peaks.gappedPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
    placeholders: 
      - macsunmergedbroadpeak
      - datasource.SE_PE
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.sonication
      - macsunmergedbroadpeak.output4
      - macsunmergedbroadpeak.output5
      - macsunmergedbroadpeak.FoldE.bdg
      - macsunmergedbroadpeak.output4
      - macsunmergedbroadpeak.output5
      - macsunmergedbroadpeak.FoldE.bdg
      - macsunmergedbroadpeak.output4
      - macsunmergedbroadpeak.output5
      - macsunmergedbroadpeak.logLR.bdg
      - macsunmergedbroadpeak.output4
      - macsunmergedbroadpeak.output5
      - macsunmergedbroadpeak.logLR.bdg
      - macsunmergedbroadpeak.FoldE.bdg
      - input.mm10.len
      - macsunmergedbroadpeak.FoldE.bdg
      - input.mm10.len
      - macsunmergedbroadpeak.logLR.bdg
      - input.mm10.len
      - macsunmergedbroadpeak.logLR.bdg
      - input.mm10.len
      - macsunmergedbroadpeak.output3
      - macsunmergedbroadpeak.output1
      - macsunmergedbroadpeak.output2
      - macsunmergedbroadpeak.output1
      - input.mm10.len
      - macsunmergedbroadpeak.broad.bdg
      - macsunmergedbroadpeak.output2
      - input.mm10.len
      - macsunmergedbroadpeak.gapped.bdg
      - macsunmergedbroadpeak.err
  macsunmergednarrowpeak: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergednarrowpeak;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; ls * | grep -v err | xargs rm -rf;\t. /nfs/users/nfs_r/rg12/.bashrc;\n\ttrap SomeErrorHandler ERR;\n\tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tmacs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -q 0.01 --fix-bimodal --extsize 250 --keep-dup auto;\n\t###\n\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergednarrowpeak/FoldE.bdg -m FE\";\n\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergednarrowpeak/FoldE.bdg -m FE;\n\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergednarrowpeak/logLR.bdg -m logLR -p 0.00001\";\n\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergednarrowpeak/logLR.bdg -m logLR -p 0.00001;\n\t###\n\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergednarrowpeak/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergednarrowpeak/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergednarrowpeak/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergednarrowpeak/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t###\n\t>&2 echo \"Rscript\";\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergednarrowpeak/ChIPseqout_model.r;\n\tnarrowpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak narrowout;\n\t###\n\tbgzip /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg;\n\tbgzip /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg;\n\ttabix -p bed /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg.gz;\n\ttabix -p bed /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg.gz;\n\tbedtools genomecov -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak -g /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len -bg > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergednarrowpeak/narrow.bdg; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergednarrowpeak/err"
    condition: ~
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.narrowPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
      - ChIPseqout_treat_pileup.bdg.gz
      - ChIPseqout_control_lambda.bdg.gz
      - ChIPseqout_treat_pileup.bdg.gz.tbi
      - ChIPseqout_control_lambda.bdg.gz.tbi
    placeholders: 
      - macsunmergednarrowpeak
      - datasource.SE_PE
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.sonication
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.FoldE.bdg
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.FoldE.bdg
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.logLR.bdg
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.logLR.bdg
      - macsunmergednarrowpeak.FoldE.bdg
      - input.mm10.len
      - macsunmergednarrowpeak.FoldE.bdg
      - input.mm10.len
      - macsunmergednarrowpeak.logLR.bdg
      - input.mm10.len
      - macsunmergednarrowpeak.logLR.bdg
      - input.mm10.len
      - macsunmergednarrowpeak.output2
      - macsunmergednarrowpeak.output1
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.output7
      - macsunmergednarrowpeak.output8
      - macsunmergednarrowpeak.output1
      - input.mm10.len
      - macsunmergednarrowpeak.narrow.bdg
      - macsunmergednarrowpeak.err
  pdfmerge: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/pdfmerge;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\tls * | grep -v err | xargs rm -rf;\n\ttrap SomeErrorHandler ERR;\n\tpdfunite /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/annotatepeaksgroup/cluster.4.pdf /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/annotatepeaksgroup/cluster.4.pdf Cluster4.pdf;\n\tpdfunite /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/annotatepeaksgroup/cluster.5.pdf /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/annotatepeaksgroup/cluster.5.pdf Cluster5.pdf;\n\tpdfunite /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/annotatepeaksgroup/cluster.6.pdf /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/annotatepeaksgroup/cluster.6.pdf Cluster6.pdf;\n\tpdfunite /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/annotatepeaksgroup/cluster.7.pdf /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/annotatepeaksgroup/cluster.7.pdf Cluster7.pdf;\n\tpdfunite /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/annotatepeaksgroup/cluster.8.pdf /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/annotatepeaksgroup/cluster.8.pdf Cluster8.pdf;\n\tpdfunite /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/annotatepeaksgroup/cluster.9.pdf /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/annotatepeaksgroup/cluster.9.pdf Cluster9.pdf;\n\tpdfunite /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/annotatepeaksgroup/cluster.10.pdf /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/annotatepeaksgroup/cluster.10.pdf Cluster10.pdf; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/pdfmerge/err"
    condition: groupby
    condition_params: 
      - Mark
    cores: 5
    mem: 5000
    placeholders: 
      - pdfmerge
      - groupby.Mark.annotatepeaksgroup.cluster.4.pdf
      - groupby.Mark.annotatepeaksgroup.cluster.5.pdf
      - groupby.Mark.annotatepeaksgroup.cluster.6.pdf
      - groupby.Mark.annotatepeaksgroup.cluster.7.pdf
      - groupby.Mark.annotatepeaksgroup.cluster.8.pdf
      - groupby.Mark.annotatepeaksgroup.cluster.9.pdf
      - groupby.Mark.annotatepeaksgroup.cluster.10.pdf
      - pdfmerge.err
  pie: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/pie;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; ls * | grep -v err | xargs rm -rf;\t. /nfs/users/nfs_r/rg12/.bashrc;\n\ttrap SomeErrorHandler ERR;\n\t#gapped broad output\n\tbedtools intersect -loj -a /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak -b /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/ens_genes_and_promoter_distal.bed > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/pie/out;\n\tbedtools intersect -loj -a /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak -b /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/ens_genes_and_promoter_distal.bed > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/pie/out2;\n\tbedtools intersect -wa -b /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak -a /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/ens_genes_and_promoter_distal.bed > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/pie/out3;\n\tbedtools intersect -wa -b /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak -a /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/ens_genes_and_promoter_distal.bed > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/pie/out4;\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/pie.R $(grep -c Gene /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/pie/out) $(grep -c Distal /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/pie/out) $(grep -c Promoter /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/pie/out) $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/pie/out |wc -l) rplot_broad.pdf > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/pie/broad\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/pie.R $(grep -c Gene /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/pie/out2) $(grep -c Distal /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/pie/out2) $(grep -c Promoter /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/pie/out2) $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/pie/out2 |wc -l) rplot_narrow.pdf > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/pie/narrow\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/pie.R $(grep -c Gene /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/pie/out3) $(grep -c Distal /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/pie/out3) $(grep -c Promoter /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/pie/out3) $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/pie/out3 |wc -l) rplot_gene_broad.pdf > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/pie/gene_broad\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/pie.R $(grep -c Gene /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/pie/out4) $(grep -c Distal /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/pie/out4) $(grep -c Promoter /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/pie/out4) $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/pie/out4 |wc -l) rplot_gene_narrow.pdf > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/pie/gene_narrow 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/pie/err"
    condition: ~
    mem: 5000
    placeholders: 
      - pie
      - macsunmergedbroadpeak.output2
      - input.ens_genes_and_promoter_distal.bed
      - pie.out
      - macsunmergednarrowpeak.output1
      - input.ens_genes_and_promoter_distal.bed
      - pie.out2
      - macsunmergedbroadpeak.output2
      - input.ens_genes_and_promoter_distal.bed
      - pie.out3
      - macsunmergednarrowpeak.output1
      - input.ens_genes_and_promoter_distal.bed
      - pie.out4
      - software.pie.R
      - pie.out
      - pie.out
      - pie.out
      - pie.out
      - pie.broad
      - software.pie.R
      - pie.out2
      - pie.out2
      - pie.out2
      - pie.out2
      - pie.narrow
      - software.pie.R
      - pie.out3
      - pie.out3
      - pie.out3
      - pie.out3
      - pie.gene_broad
      - software.pie.R
      - pie.out4
      - pie.out4
      - pie.out4
      - pie.out4
      - pie.gene_narrow
      - pie.err
  samtoolsview: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/samtoolsview;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\ttest -e /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bowtie/out.sam;\n\tsamtools view -hSb /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bowtie/out.sam> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/samtoolsview/out.bam;\n\tsamtools sort /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/samtoolsview/out.bam out.sorted;\n\tsamtools index /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/samtoolsview/out.sorted.bam;\n\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bowtie/out.sam; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/samtoolsview/err"
    condition: ~
    mem: 2000
    outputfiles: 
      - out.sorted.bam
      - out.sorted.bam.bai
    placeholders: 
      - samtoolsview
      - bowtie.out.sam
      - bowtie.out.sam
      - samtoolsview.out.bam
      - samtoolsview.out.bam
      - samtoolsview.output1
      - bowtie.out.sam
      - samtoolsview.err
  samtoolsviewInp: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/samtoolsviewInp;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\ttest -e /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bowtieinp/out.sam;\n\tsamtools view -hSb /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bowtieinp/out.sam > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/samtoolsviewInp/out.bam;\n\tsamtools sort /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/samtoolsviewInp/out.bam out.sorted;\n\tsamtools index /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/samtoolsviewInp/out.sorted.bam;\n\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bowtieinp/out.sam; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/samtoolsviewInp/err"
    condition: ~
    mem: 2000
    outputfiles: 
      - out.sorted.bam
      - out.sorted.bam.bai
    placeholders: 
      - samtoolsviewInp
      - bowtieinp.out.sam
      - bowtieinp.out.sam
      - samtoolsviewInp.out.bam
      - samtoolsviewInp.out.bam
      - samtoolsviewInp.output1
      - bowtieinp.out.sam
      - samtoolsviewInp.err
  seperateclusters: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/seperateclusters;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\tls * | grep -v err | xargs rm -rf;\n\ttrap SomeErrorHandler ERR;\n\tclusters=4;\n\tcp /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/annotatepeaksgroup/cluster.4.RData /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/seperateclusters/clusters.RData;\n\tExtractGName.R /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/seperateclusters/clusters.RData;\n\t>&2 echo \"cluster1-4\";\n\tfor i in {1..4}\n\tdo\n\t\t>&2 echo \"cluster\" ${i};\n\t\techo -e \"/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/samtoolsviewInp/out.sorted.bam\tclusters.1.cluster${i}.txt\t\\\"H3K36me3 B Cell\\\"\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/seperateclusters/config.txt;\n\t\t>&2 echo \"ngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/seperateclusters/config.txt -O heatmapclusters.${i} -L 5000 -GO total -CO blue:white:red -P 5\";\n\t\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/seperateclusters/config.txt -O heatmapclusters.${i} -L 3000 -GO total -CO blue:white:red -P 5;\n\t\tconvert -density 150 heatmapclusters.${i}.heatmap.pdf -quality 90 heatmapclusters.${i}.heatmap.png;\n\tdone 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/seperateclusters/err"
    condition: ~
    cores: 5
    mem: 5000
    placeholders: 
      - seperateclusters
      - annotatepeaksgroup.output1
      - seperateclusters.clusters.RData
      - seperateclusters.clusters.RData
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.mark_full
      - datasource.Cell
      - seperateclusters.config.txt
      - seperateclusters.config.txt
      - seperateclusters.config.txt
      - seperateclusters.err
  summarystats: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/summarystats;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;trap SomeErrorHandler ERR;\tif [ PE == \"PE\" ];\n\t\tthen if [ TRUE == \"TRUE\" ];\n\t\t\tthen echo \"BM_B_36M_R_lane1\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_36M_R/BM_B_36M_R_1.bam >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/summarystats/out.flagstat;\n\t\t\techo \"BM_B_36M_R_lane2\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_36M_R/BM_B_36M_R_2.bam >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/summarystats/out.flagstat;\n\t\telse echo \"BM_B_36M_R\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/summarystats/out.flagstat;\n\t\t\techo \"FastQ\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/summarystats/out.flagstat;\n\t\tfi;\n\t\tif [ TRUE == \"TRUE\" ];\n\t\t\tthen echo \"Inp_BM_B_36M_R_lane1\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_INP_R/BM_B_INP_R_1.bam >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/summarystats/out.flagstat;\n\t\t\techo \"Inp_BM_B_36M_R_lane2\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_INP_R/BM_B_INP_R_2.bam >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/summarystats/out.flagstat;\n\t\telse echo \"Inp_BM_B_36M_R\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/summarystats/out.flagstat;\n\t\t\techo \"FastQ\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/summarystats/out.flagstat;\n\t\tfi;\n\telse if [ TRUE == \"TRUE\" ]; ### CHECK THIS!! SHOULD be INP_1 and INP_2\n\t\tthen echo \"BM_B_36M_R_lane1\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_36M_R/BM_B_36M_R_1.bam >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/summarystats/out.flagstat;\n\t\t\techo \"BM_B_36M_R_lane2\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_36M_R/BM_B_36M_R_2.bam >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/summarystats/out.flagstat;\n\t\telse echo \"BM_B_36M_R\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/summarystats/out.flagstat;\n\t\t\techo \"FastQ\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/summarystats/out.flagstat;\n\t\tfi;\n\t\tif [ TRUE == \"TRUE\" ];\n\t\t\tthen echo \"Inp_BM_B_36M_R_lane1\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_INP_R/BM_B_INP_R_1.bam >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/summarystats/out.flagstat;\n\t\t\techo \"Inp_BM_B_36M_R_lane2\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_B_INP_R/BM_B_INP_R_2.bam >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/summarystats/out.flagstat;\n\t\telse echo \"Inp_BM_B_36M_R\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/summarystats/out.flagstat;\n\t\t\techo \"FastQ\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/summarystats/out.flagstat;\n\t\tfi;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/summarystats/err"
    condition: ~
    mem: 1000
    placeholders: 
      - summarystats
      - datasource.SE_PE
      - datasource.bam
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - summarystats.out.flagstat
      - datasource.Inp_bam
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.Inp_location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.Inp_location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - summarystats.out.flagstat
      - datasource.bam
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - summarystats.out.flagstat
      - datasource.Inp_bam
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.Inp_location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.Inp_location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - summarystats.out.flagstat
      - summarystats.err
  trimgalore: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/trimgalore;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tlength=$(gunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofq/out_1.fq.gz | head -2| tail -1 | wc -c);\n\tlength=$[length-11];\n\tif [ PE == \"PE\" ];\n\tthen\n\t\ttrim_galore --fastqc --gzip --length $length --paired -a TGACCACT --stringency 4 --trim1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofq/out_1.fq.gz /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofq/out_2.fq.gz;\n\telse\n\t\ttrim_galore --fastqc --gzip --length $length -a TGACCACT --stringency 4 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofq/out_1.fq.gz;\n\n\t\tmv out_1_trimmed.fq.gz out_1_val_1.fq.gz;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/trimgalore/err"
    condition: ~
    cores: 3
    mem: 2000
    outputfiles: 
      - out_1.fq.gz_trimming_report.txt
      - out_1_val_1.fq.gz
      - out_2.fq.gz_trimming_report.txt
      - out_2_val_2.fq.gz
      - out_1_val_1.html
      - out_1_val_1.zip
      - out_2_val_2.html
      - out_2_val_2.zip
    placeholders: 
      - trimgalore
      - bamtofq.out_1.fq.gz
      - datasource.SE_PE
      - datasource.Tag
      - bamtofq.out_1.fq.gz
      - bamtofq.out_2.fq.gz
      - datasource.Tag
      - bamtofq.out_1.fq.gz
      - trimgalore.err
  trimgaloreinp: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/trimgaloreinp;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tlength=$(gunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofqinp/out_1.fq.gz | head -2| tail -1 | wc -c);\n\tlength=$[length-11];\n\tif [ PE == \"PE\" ];\n\tthen\n\t\ttrim_galore --fastqc --gzip --length $length --paired -a GATCAGCG --stringency 4 --trim1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofqinp/out_1.fq.gz /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofqinp/out_2.fq.gz;\n\telse\n\t\ttrim_galore --fastqc --gzip --length $length -a GATCAGCG --stringency 4 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/bamtofqinp/out_1.fq.gz;\n\t\tmv out_1_trimmed.fq.gz out_1_val_1.fq.gz; ### should FIX\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/trimgaloreinp/err"
    condition: ~
    cores: 3
    mem: 2000
    outputfiles: 
      - out_1.fq.gz_trimming_report.txt
      - out_1_val_1.fq.gz
      - out_2.fq.gz_trimming_report.txt
      - out_2_val_2.fq.gz
      - out_1_val_1.html
      - out_1_val_1.zip
      - out_2_val_2.html
      - out_2_val_2.zip
    placeholders: 
      - trimgaloreinp
      - bamtofqinp.out_1.fq.gz
      - datasource.SE_PE
      - datasource.Inp_Tag
      - bamtofqinp.out_1.fq.gz
      - bamtofqinp.out_2.fq.gz
      - datasource.Inp_Tag
      - bamtofqinp.out_1.fq.gz
      - trimgaloreinp.err
  wigcorrelate: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/wigcorrelate;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tls /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/macsunmergedbroadpeak/FoldE.bw;\n\tlength=(/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmergedbroadpeak/FoldE.bw);\n\t#Change FoldE.bw to output16\n\tif [ ${#length[@]} != 1 ];\n\t\tthen\n\t\twigCorrelate /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job1/macsunmerged/FoldE.bw > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/wigcorrelate/out;\n\tfi; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job3/wigcorrelate/err"
    condition: groupby
    condition_params: 
      - replicate
    cores: 4
    mem: 5000
    placeholders: 
      - wigcorrelate
      - macsunmergedbroadpeak.output6
      - groupby.replicate.macsunmergedbroadpeak.FoldE.bw
      - groupby.replicate.macsunmerged.FoldE.bw
      - wigcorrelate.out
      - wigcorrelate.err
4: 
  annotatepeaks: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/annotatepeaks;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\tls * | grep -v err | xargs rm -rf;\n\ttrap SomeErrorHandler ERR;\n\tclusters=4\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/samtoolsviewInp/out.sorted.bam -T \"H3K4me3 T Cell\" -O out -L 3000 -GO km -KNC ${clusters} -CO blue:white:red -P 5 -FI 1;\n\t/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/ExtractGeneClusterings.r out;\n\tfor i in $(seq 1 ${clusters});\n\tdo\n\t\techo -e \"/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/samtoolsviewInp/out.sorted.bam\tout.cluster${i}.txt\t\\\"H3K4me3 T Cell Cluster${i}\\\"\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/annotatepeaks/config.txt;\n\tdone\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/annotatepeaks/config.txt -O clusters -L 3000 -GO hc -CO blue:white:red -P 5;\n\tcat > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/annotatepeaks/configB.txt << EOF\n/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/samtoolsviewInp/out.sorted.bam\t/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/B_ordered_TPM.txt\t\"H3K4me3 B cell\"\nEOF\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/annotatepeaks/configB.txt -O TPMorderedB -L 3000 -GO none -CO blue:white:red -P 5;\n\tcat > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/annotatepeaks/configT.txt << EOF\n/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/samtoolsviewInp/out.sorted.bam\t/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/T_ordered_TPM.txt\t\"H3K4me3 T cell\"\nEOF\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/annotatepeaks/configT.txt -O TPMorderedT -L 3000 -GO none -CO blue:white:red -P 5; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/annotatepeaks/err"
    condition: ~
    cores: 5
    mem: 5000
    placeholders: 
      - annotatepeaks
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.mark_full
      - datasource.Cell
      - software.ExtractGeneClusterings.r
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.mark_full
      - datasource.Cell
      - annotatepeaks.config.txt
      - annotatepeaks.config.txt
      - annotatepeaks.configB.txt
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - input.B_ordered_TPM.txt
      - datasource.mark_full
      - annotatepeaks.configB.txt
      - annotatepeaks.configT.txt
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - input.T_ordered_TPM.txt
      - datasource.mark_full
      - annotatepeaks.configT.txt
      - annotatepeaks.err
  annotatepeaksgroup: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/annotatepeaksgroup;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\tls * | grep -v err | xargs rm -rf;\n\ttrap SomeErrorHandler ERR;\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/samtoolsviewInp/out.sorted.bam -T \"H3K4me3 T Cell\" -O out -L 3000 -CO blue:white:red -P 5 -FI 0;\n\tfor clusters in {4..10};\n\t\tdo name=\"cluster.${clusters}\";\n\t\treplot.r heatmap -I out.zip -O ${name} -T \"H3K4me3 T Cell\" -L 3000 -GO km -KNC ${clusters} -CO blue:white:red -P 5;\n\t\tExtractGName.R ${name}.RData;\n\tdone 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/annotatepeaksgroup/err"
    condition: ~
    cores: 5
    mem: 5000
    outputfiles: 
      - cluster.4.RData
    placeholders: 
      - annotatepeaksgroup
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.mark_full
      - datasource.Cell
      - datasource.mark_full
      - datasource.Cell
      - annotatepeaksgroup.err
  bamtofq: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofq;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;trap SomeErrorHandler ERR;\tif [ TRUE == \"TRUE\" ];\n\t\tthen samtools sort /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_4M_R/BM_T_4M_R_1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofq/lane1;\n\t\tsamtools sort /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_4M_R/BM_T_4M_R_2.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofq/lane2;\n\t\tsamtools merge /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofq/merged.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofq/lane1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofq/lane2.bam;\n\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofq/lane1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofq/lane2.bam;\n\t\tif [ PE == \"PE\" ];\n\t\t\tthen\n\t\t\t\tbamtofastq filename=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofq/merged.bam gz=1 F=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofq/out_1.fq.gz F2=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofq/out_2.fq.gz;\n\t\t\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofq/merged.bam;\n\t\t\telse\n\t\t\t\tbamtofastq gz=1 filename=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofq/merged.bam > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofq/out_1.fq.gz;\n\t\t\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofq/merged.bam;\n\t\t\tfi;\n\t\telse\n\t\t\tcat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_4M_R/BM_T_4M_R* > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofq/out_1.fq.gz;\n\t\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofq/err"
    condition: ~
    mem: 1500
    placeholders: 
      - bamtofq
      - datasource.bam
      - datasource.location
      - bamtofq.lane1
      - datasource.location
      - bamtofq.lane2
      - bamtofq.merged.bam
      - bamtofq.lane1
      - bamtofq.lane2
      - bamtofq.lane1
      - bamtofq.lane2
      - datasource.SE_PE
      - bamtofq.merged.bam
      - bamtofq.out_1.fq.gz
      - bamtofq.out_2.fq.gz
      - bamtofq.merged.bam
      - bamtofq.merged.bam
      - bamtofq.out_1.fq.gz
      - bamtofq.merged.bam
      - datasource.location
      - bamtofq.out_1.fq.gz
      - bamtofq.err
  bamtofqinp: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofqinp;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;trap SomeErrorHandler ERR;\tif [ TRUE == \"TRUE\" ];\n\t\tthen samtools sort /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_INP_R/BM_T_INP_R_1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofqinp/lane1;\n\t\tsamtools sort /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_INP_R/BM_T_INP_R_2.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofqinp/lane2;\n\t\tsamtools merge /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofqinp/merged.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofqinp/lane1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofqinp/lane2.bam;\n\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofqinp/lane1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofqinp/lane2.bam;\n\t\tif [ PE == \"PE\" ];\n\t\t\tthen\n\t\t\t\tbamtofastq gz=1 filename=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofqinp/merged.bam F=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofqinp/out_1.fq.gz F2=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofqinp/out_2.fq.gz;\n\t\t\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofqinp/merged.bam;\n\t\t\telse bamtofastq gz=1 filename=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofqinp/merged.bam > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofqinp/out_1.fq.gz;\n\t\t\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofqinp/merged.bam;\n\t\tfi;\n\telse cat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_INP_R/BM_T_INP_R* > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofqinp/out_1.fq.gz;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofqinp/err"
    condition: ~
    mem: 1500
    placeholders: 
      - bamtofqinp
      - datasource.Inp_bam
      - datasource.Inp_location
      - bamtofqinp.lane1
      - datasource.Inp_location
      - bamtofqinp.lane2
      - bamtofqinp.merged.bam
      - bamtofqinp.lane1
      - bamtofqinp.lane2
      - bamtofqinp.lane1
      - bamtofqinp.lane2
      - datasource.SE_PE
      - bamtofqinp.merged.bam
      - bamtofqinp.out_1.fq.gz
      - bamtofqinp.out_2.fq.gz
      - bamtofqinp.merged.bam
      - bamtofqinp.merged.bam
      - bamtofqinp.out_1.fq.gz
      - bamtofqinp.merged.bam
      - datasource.Inp_location
      - bamtofqinp.out_1.fq.gz
      - bamtofqinp.err
  bedcorrelate: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bedcorrelate;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tbroadreplicates=(/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergedbroadpeak/ChIPseqout_peaks.broadPeak);\n\tgappedreplicates=(/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak);\n\tnarrowreplicates=(/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak);\n\t###\n\tbedtools intersect -u -a ${broadreplicates[0]} -b ${broadreplicates[1]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bedcorrelate/broadintersect.bed;\n\tbedtools intersect -u -a ${gappedreplicates[0]} -b ${gappedreplicates[1]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bedcorrelate/gappedintersect.bed;\n\tbedtools intersect -u -a ${narrowreplicates[0]} -b ${narrowreplicates[1]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bedcorrelate/narrowintersect.bed;\n\tbedtools intersect -u -a ${broadreplicates[1]} -b ${broadreplicates[0]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bedcorrelate/broadintersect2.bed;\n\tbedtools intersect -u -a ${gappedreplicates[1]} -b ${gappedreplicates[0]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bedcorrelate/gappedintersect2.bed;\n\tbedtools intersect -u -a ${narrowreplicates[1]} -b ${narrowreplicates[0]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bedcorrelate/narrowintersect2.bed;\n\t###\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bedcorrelate/broadintersect.bed|wc -l ) \"/\" $(cat ${broadreplicates[0]} |wc -l ) \") *100\"|bc >/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bedcorrelate/broadintersect.txt;\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bedcorrelate/gappedintersect.bed|wc -l ) \"/\" $(cat ${gappedreplicates[0]} |wc -l ) \") *100\"|bc >/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bedcorrelate/gappedintersect.txt;\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bedcorrelate/narrowintersect.bed|wc -l ) \"/\" $(cat ${narrowreplicates[0]} |wc -l ) \") *100\"|bc >/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bedcorrelate/narrowintersect.txt;\n\t###\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bedcorrelate/broadintersect2.bed|wc -l ) \"/\" $(cat ${broadreplicates[1]} |wc -l ) \") *100\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bedcorrelate/broadintersect.txt;\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bedcorrelate/gappedintersect2.bed|wc -l ) \"/\" $(cat ${gappedreplicates[1]} |wc -l ) \") *100\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bedcorrelate/gappedintersect.txt;\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bedcorrelate/narrowintersect2.bed|wc -l ) \"/\" $(cat ${narrowreplicates[1]} |wc -l ) \") *100\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bedcorrelate/narrowintersect.txt;\n\t###\n\techo \"scale=4;((\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bedcorrelate/broadintersect.bed|wc -l ) \"/\" $(cat ${broadreplicates[0]} |wc -l ) \")+(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bedcorrelate/broadintersect2.bed|wc -l ) \"/\" $(cat ${broadreplicates[1]} |wc -l ) \")) *50\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bedcorrelate/broadintersect.txt;\n\techo \"scale=4;((\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bedcorrelate/gappedintersect.bed|wc -l ) \"/\" $(cat ${gappedreplicates[0]} |wc -l ) \")+(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bedcorrelate/gappedintersect2.bed|wc -l ) \"/\" $(cat ${gappedreplicates[1]} |wc -l ) \")) *50\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bedcorrelate/gappedintersect.txt;\n\techo \"scale=4;((\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bedcorrelate/narrowintersect.bed|wc -l ) \"/\" $(cat ${narrowreplicates[0]} |wc -l ) \")+(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bedcorrelate/narrowintersect2.bed|wc -l ) \"/\" $(cat ${narrowreplicates[1]} |wc -l ) \")) *50\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bedcorrelate/narrowintersect.txt; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bedcorrelate/err"
    condition: groupby
    condition_params: 
      - replicate
    cores: 4
    mem: 5000
    placeholders: 
      - bedcorrelate
      - groupby.replicate.macsunmergedbroadpeak.ChIPseqout_peaks.broadPeak
      - groupby.replicate.macsunmergedbroadpeak.ChIPseqout_peaks.gappedPeak
      - groupby.replicate.macsunmergednarrowpeak.ChIPseqout_peaks.narrowPeak
      - bedcorrelate.broadintersect.bed
      - bedcorrelate.gappedintersect.bed
      - bedcorrelate.narrowintersect.bed
      - bedcorrelate.broadintersect2.bed
      - bedcorrelate.gappedintersect2.bed
      - bedcorrelate.narrowintersect2.bed
      - bedcorrelate.broadintersect.bed
      - bedcorrelate.broadintersect.txt
      - bedcorrelate.gappedintersect.bed
      - bedcorrelate.gappedintersect.txt
      - bedcorrelate.narrowintersect.bed
      - bedcorrelate.narrowintersect.txt
      - bedcorrelate.broadintersect2.bed
      - bedcorrelate.broadintersect.txt
      - bedcorrelate.gappedintersect2.bed
      - bedcorrelate.gappedintersect.txt
      - bedcorrelate.narrowintersect2.bed
      - bedcorrelate.narrowintersect.txt
      - bedcorrelate.broadintersect.bed
      - bedcorrelate.broadintersect2.bed
      - bedcorrelate.broadintersect.txt
      - bedcorrelate.gappedintersect.bed
      - bedcorrelate.gappedintersect2.bed
      - bedcorrelate.gappedintersect.txt
      - bedcorrelate.narrowintersect.bed
      - bedcorrelate.narrowintersect2.bed
      - bedcorrelate.narrowintersect.txt
      - bedcorrelate.err
  bowtie: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bowtie;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tls /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_build/touch /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_buildcast/touch;\n\tif [ PE == \"PE\" ];\n\t\tthen /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/bowtierun -p PE -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/trimgalore/out_1_val_1.fq.gz -2 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/trimgalore/out_2_val_2.fq.gz -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bowtie/out.sam -s C57BL6J;\n\telse /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/bowtierun -p PE -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/trimgalore/out_1_val_1.fq.gz -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bowtie/out.sam -s C57BL6J;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bowtie/err"
    condition: ~
    cores: 14
    mem: 7000
    placeholders: 
      - bowtie
      - bowtie_build.touch
      - bowtie_buildcast.touch
      - datasource.SE_PE
      - software.bowtierun
      - datasource.SE_PE
      - trimgalore.output2
      - trimgalore.output4
      - bowtie.out.sam
      - datasource.Strain
      - software.bowtierun
      - datasource.SE_PE
      - trimgalore.output2
      - bowtie.out.sam
      - datasource.Strain
      - bowtie.err
  bowtieinp: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bowtieinp;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tls /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_build/touch /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_buildcast/touch;\n\tif [ PE == \"PE\" ];\n\t\tthen /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/bowtierun -p PE -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/trimgaloreinp/out_1_val_1.fq.gz -2 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/trimgaloreinp/out_2_val_2.fq.gz -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bowtieinp/out.sam -s C57BL6J;\n\telse /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/bowtierun -p PE -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/trimgaloreinp/out_1_val_1.fq.gz -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bowtieinp/out.sam -s C57BL6J;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bowtieinp/err"
    condition: ~
    cores: 14
    mem: 7000
    placeholders: 
      - bowtieinp
      - bowtie_build.touch
      - bowtie_buildcast.touch
      - datasource.SE_PE
      - software.bowtierun
      - datasource.SE_PE
      - trimgaloreinp.output2
      - trimgaloreinp.output4
      - bowtieinp.out.sam
      - datasource.Strain
      - software.bowtierun
      - datasource.SE_PE
      - trimgaloreinp.output2
      - bowtieinp.out.sam
      - datasource.Strain
      - bowtieinp.err
  fastquality: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/fastquality;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tgunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/trimgalore/out_1_val_1.fq.gz | fastx_quality_stats -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/fastquality/out1;\n\tfastq_quality_boxplot_graph.sh -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/fastquality/out1 -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/fastquality/out1.png -t BM_T_4M_R_read1;\n\tgunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/trimgaloreinp/out_1_val_1.fq.gz | fastx_quality_stats -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/fastquality/Inpout1;\n\tfastq_quality_boxplot_graph.sh -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/fastquality/Inpout1 -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/fastquality/Inpout1.png -t BM_T_4M_R_input_read1;\n\tif [ PE == \"PE\" ];\n\tthen gunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/trimgalore/out_2_val_2.fq.gz | fastx_quality_stats -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/fastquality/out2;\n\t\tfastq_quality_boxplot_graph.sh -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/fastquality/out2 -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/fastquality/out2.png -t BM_T_4M_R_read2;\n\t\tgunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/trimgaloreinp/out_2_val_2.fq.gz | fastx_quality_stats -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/fastquality/Inpout2;\n\t\tfastq_quality_boxplot_graph.sh -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/fastquality/Inpout2 -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/fastquality/Inpout2.png -t BM_T_4M_R_input_read2;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/fastquality/err"
    condition: ~
    mem: 50
    placeholders: 
      - fastquality
      - trimgalore.output2
      - fastquality.out1
      - fastquality.out1
      - fastquality.out1.png
      - datasource.Name
      - trimgaloreinp.output2
      - fastquality.Inpout1
      - fastquality.Inpout1
      - fastquality.Inpout1.png
      - datasource.Name
      - datasource.SE_PE
      - trimgalore.output4
      - fastquality.out2
      - fastquality.out2
      - fastquality.out2.png
      - datasource.Name
      - trimgaloreinp.output4
      - fastquality.Inpout2
      - fastquality.Inpout2
      - fastquality.Inpout2.png
      - datasource.Name
      - fastquality.err
  macsmergedbroad: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergedbroad;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tlast=$(tail -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bedcorrelate/broadintersect.txt);\n\tint=${last%.*};\n\tif [ $int -gt 75 ];\n\t\tthen macs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -q 0.01 --broad --broad-cutoff 0.1 --fix-bimodal --extsize 250 --keep-dup auto;\n\t\t###\n\t\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergedbroad/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergedbroad/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergedbroad/FoldE.bdg -m FE\";\n\t\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergedbroad/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergedbroad/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergedbroad/FoldE.bdg -m FE;\n\t\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergedbroad/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergedbroad/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergedbroad/logLR.bdg -m logLR -p 0.00001\";\n\t\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergedbroad/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergedbroad/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergedbroad/logLR.bdg -m logLR -p 0.00001;\n\t\t###\n\t\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergedbroad/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\t\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergedbroad/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergedbroad/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\t\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergedbroad/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t\t###\n\t\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergedbroad/ChIPseqout_model.r;\n\t\tbroadpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergedbroad/ChIPseqout_peaks.broadPeak broadout;\n\t\tgappedpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergedbroad/ChIPseqout_peaks.gappedPeak gappedout;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergedbroad/err"
    condition: groupby
    condition_params: 
      - replicate
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.broadPeak
      - ChIPseqout_peaks.gappedPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
    placeholders: 
      - macsmergedbroad
      - datasource.SE_PE
      - bedcorrelate.broadintersect.txt
      - groupby.replicate.samtoolsview.out.sorted.bam
      - groupby.replicate.samtoolsviewInp.out.sorted.bam
      - datasource.sonication
      - macsmergedbroad.output4
      - macsmergedbroad.output5
      - macsmergedbroad.FoldE.bdg
      - macsmergedbroad.output4
      - macsmergedbroad.output5
      - macsmergedbroad.FoldE.bdg
      - macsmergedbroad.output4
      - macsmergedbroad.output5
      - macsmergedbroad.logLR.bdg
      - macsmergedbroad.output4
      - macsmergedbroad.output5
      - macsmergedbroad.logLR.bdg
      - macsmergedbroad.FoldE.bdg
      - input.mm10.len
      - macsmergedbroad.FoldE.bdg
      - input.mm10.len
      - macsmergedbroad.logLR.bdg
      - input.mm10.len
      - macsmergedbroad.logLR.bdg
      - input.mm10.len
      - macsmergedbroad.output3
      - macsmergedbroad.output1
      - macsmergedbroad.output2
      - macsmergedbroad.err
  macsmergednarrow: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergednarrow;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tlast=$(tail -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bedcorrelate/narrowintersect.txt);\n\tint=${last%.*};\n\tif [ $int -gt 75 ];\n\t\tthen macs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -q 0.01 --fix-bimodal --extsize 250 --keep-dup auto;\n\t\t###\n\t\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergednarrow/ChIPseqout_control_lambda.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergednarrow/FoldE.bw -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergednarrow/FoldE.bdg -m FE\";\n\t\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergednarrow/ChIPseqout_control_lambda.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergednarrow/FoldE.bw -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergednarrow/FoldE.bdg -m FE;\n\t\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergednarrow/ChIPseqout_control_lambda.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergednarrow/FoldE.bw -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergednarrow/logLR.bdg -m logLR -p 0.00001\";\n\t\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergednarrow/ChIPseqout_control_lambda.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergednarrow/FoldE.bw -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergednarrow/logLR.bdg -m logLR -p 0.00001;\n\t\t###\n\t\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergednarrow/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\t\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergednarrow/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergednarrow/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\t\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergednarrow/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t\t###\n\t\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergednarrow/ChIPseqout_model.r;\n\t\tnarrowpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergednarrow/ChIPseqout_peaks.narrowPeak narrowout;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsmergednarrow/err"
    condition: groupby
    condition_params: 
      - replicate
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.narrowPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
    placeholders: 
      - macsmergednarrow
      - datasource.SE_PE
      - bedcorrelate.narrowintersect.txt
      - groupby.replicate.samtoolsview.out.sorted.bam
      - groupby.replicate.samtoolsviewInp.out.sorted.bam
      - datasource.sonication
      - macsmergednarrow.output4
      - macsmergednarrow.output5
      - macsmergednarrow.FoldE.bdg
      - macsmergednarrow.output4
      - macsmergednarrow.output5
      - macsmergednarrow.FoldE.bdg
      - macsmergednarrow.output4
      - macsmergednarrow.output5
      - macsmergednarrow.logLR.bdg
      - macsmergednarrow.output4
      - macsmergednarrow.output5
      - macsmergednarrow.logLR.bdg
      - macsmergednarrow.FoldE.bdg
      - input.mm10.len
      - macsmergednarrow.FoldE.bdg
      - input.mm10.len
      - macsmergednarrow.logLR.bdg
      - input.mm10.len
      - macsmergednarrow.logLR.bdg
      - input.mm10.len
      - macsmergednarrow.output2
      - macsmergednarrow.output1
      - macsmergednarrow.err
  macsunmerged: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmerged;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; \tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tmacs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -p 1 --fix-bimodal --extsize 250 --keep-dup auto; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmerged/err"
    condition: ~
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.narrowPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
    placeholders: 
      - macsunmerged
      - datasource.SE_PE
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.sonication
      - macsunmerged.err
  macsunmergedbroadpeak: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergedbroadpeak;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; ls * | grep -v err | xargs rm -rf;\t. /nfs/users/nfs_r/rg12/.bashrc;\n\ttrap SomeErrorHandler ERR;\n\tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tmacs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -q 0.05 --broad --broad-cutoff 0.1 --fix-bimodal --extsize 250 --keep-dup auto;\n\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergedbroadpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergedbroadpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergedbroadpeak/FoldE.bdg -m FE\";\n\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergedbroadpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergedbroadpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergedbroadpeak/FoldE.bdg -m FE;\n\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergedbroadpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergedbroadpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergedbroadpeak/logLR.bdg -m logLR -p 0.00001\";\n\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergedbroadpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergedbroadpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergedbroadpeak/logLR.bdg -m logLR -p 0.00001;\n\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergedbroadpeak/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergedbroadpeak/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergedbroadpeak/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergedbroadpeak/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t>&2 echo \"Rscript\";\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergedbroadpeak/ChIPseqout_model.r;\n\tbroadpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergedbroadpeak/ChIPseqout_peaks.broadPeak broadout;\n\tgappedpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak gappedout;\n\tbedtools genomecov -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergedbroadpeak/ChIPseqout_peaks.broadPeak -g /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len -bg > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergedbroadpeak/broad.bdg;\n\tbedtools genomecov -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak -g /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len -bg > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergedbroadpeak/gapped.bdg; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergedbroadpeak/err"
    condition: ~
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.broadPeak
      - ChIPseqout_peaks.gappedPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
    placeholders: 
      - macsunmergedbroadpeak
      - datasource.SE_PE
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.sonication
      - macsunmergedbroadpeak.output4
      - macsunmergedbroadpeak.output5
      - macsunmergedbroadpeak.FoldE.bdg
      - macsunmergedbroadpeak.output4
      - macsunmergedbroadpeak.output5
      - macsunmergedbroadpeak.FoldE.bdg
      - macsunmergedbroadpeak.output4
      - macsunmergedbroadpeak.output5
      - macsunmergedbroadpeak.logLR.bdg
      - macsunmergedbroadpeak.output4
      - macsunmergedbroadpeak.output5
      - macsunmergedbroadpeak.logLR.bdg
      - macsunmergedbroadpeak.FoldE.bdg
      - input.mm10.len
      - macsunmergedbroadpeak.FoldE.bdg
      - input.mm10.len
      - macsunmergedbroadpeak.logLR.bdg
      - input.mm10.len
      - macsunmergedbroadpeak.logLR.bdg
      - input.mm10.len
      - macsunmergedbroadpeak.output3
      - macsunmergedbroadpeak.output1
      - macsunmergedbroadpeak.output2
      - macsunmergedbroadpeak.output1
      - input.mm10.len
      - macsunmergedbroadpeak.broad.bdg
      - macsunmergedbroadpeak.output2
      - input.mm10.len
      - macsunmergedbroadpeak.gapped.bdg
      - macsunmergedbroadpeak.err
  macsunmergednarrowpeak: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergednarrowpeak;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; ls * | grep -v err | xargs rm -rf;\t. /nfs/users/nfs_r/rg12/.bashrc;\n\ttrap SomeErrorHandler ERR;\n\tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tmacs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -q 0.01 --fix-bimodal --extsize 250 --keep-dup auto;\n\t###\n\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergednarrowpeak/FoldE.bdg -m FE\";\n\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergednarrowpeak/FoldE.bdg -m FE;\n\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergednarrowpeak/logLR.bdg -m logLR -p 0.00001\";\n\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergednarrowpeak/logLR.bdg -m logLR -p 0.00001;\n\t###\n\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergednarrowpeak/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergednarrowpeak/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergednarrowpeak/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergednarrowpeak/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t###\n\t>&2 echo \"Rscript\";\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergednarrowpeak/ChIPseqout_model.r;\n\tnarrowpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak narrowout;\n\t###\n\tbgzip /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg;\n\tbgzip /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg;\n\ttabix -p bed /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg.gz;\n\ttabix -p bed /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg.gz;\n\tbedtools genomecov -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak -g /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len -bg > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergednarrowpeak/narrow.bdg; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergednarrowpeak/err"
    condition: ~
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.narrowPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
      - ChIPseqout_treat_pileup.bdg.gz
      - ChIPseqout_control_lambda.bdg.gz
      - ChIPseqout_treat_pileup.bdg.gz.tbi
      - ChIPseqout_control_lambda.bdg.gz.tbi
    placeholders: 
      - macsunmergednarrowpeak
      - datasource.SE_PE
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.sonication
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.FoldE.bdg
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.FoldE.bdg
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.logLR.bdg
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.logLR.bdg
      - macsunmergednarrowpeak.FoldE.bdg
      - input.mm10.len
      - macsunmergednarrowpeak.FoldE.bdg
      - input.mm10.len
      - macsunmergednarrowpeak.logLR.bdg
      - input.mm10.len
      - macsunmergednarrowpeak.logLR.bdg
      - input.mm10.len
      - macsunmergednarrowpeak.output2
      - macsunmergednarrowpeak.output1
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.output7
      - macsunmergednarrowpeak.output8
      - macsunmergednarrowpeak.output1
      - input.mm10.len
      - macsunmergednarrowpeak.narrow.bdg
      - macsunmergednarrowpeak.err
  pie: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/pie;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; ls * | grep -v err | xargs rm -rf;\t. /nfs/users/nfs_r/rg12/.bashrc;\n\ttrap SomeErrorHandler ERR;\n\t#gapped broad output\n\tbedtools intersect -loj -a /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak -b /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/ens_genes_and_promoter_distal.bed > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/pie/out;\n\tbedtools intersect -loj -a /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak -b /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/ens_genes_and_promoter_distal.bed > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/pie/out2;\n\tbedtools intersect -wa -b /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak -a /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/ens_genes_and_promoter_distal.bed > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/pie/out3;\n\tbedtools intersect -wa -b /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak -a /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/ens_genes_and_promoter_distal.bed > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/pie/out4;\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/pie.R $(grep -c Gene /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/pie/out) $(grep -c Distal /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/pie/out) $(grep -c Promoter /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/pie/out) $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/pie/out |wc -l) rplot_broad.pdf > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/pie/broad\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/pie.R $(grep -c Gene /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/pie/out2) $(grep -c Distal /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/pie/out2) $(grep -c Promoter /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/pie/out2) $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/pie/out2 |wc -l) rplot_narrow.pdf > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/pie/narrow\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/pie.R $(grep -c Gene /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/pie/out3) $(grep -c Distal /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/pie/out3) $(grep -c Promoter /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/pie/out3) $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/pie/out3 |wc -l) rplot_gene_broad.pdf > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/pie/gene_broad\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/pie.R $(grep -c Gene /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/pie/out4) $(grep -c Distal /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/pie/out4) $(grep -c Promoter /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/pie/out4) $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/pie/out4 |wc -l) rplot_gene_narrow.pdf > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/pie/gene_narrow 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/pie/err"
    condition: ~
    mem: 5000
    placeholders: 
      - pie
      - macsunmergedbroadpeak.output2
      - input.ens_genes_and_promoter_distal.bed
      - pie.out
      - macsunmergednarrowpeak.output1
      - input.ens_genes_and_promoter_distal.bed
      - pie.out2
      - macsunmergedbroadpeak.output2
      - input.ens_genes_and_promoter_distal.bed
      - pie.out3
      - macsunmergednarrowpeak.output1
      - input.ens_genes_and_promoter_distal.bed
      - pie.out4
      - software.pie.R
      - pie.out
      - pie.out
      - pie.out
      - pie.out
      - pie.broad
      - software.pie.R
      - pie.out2
      - pie.out2
      - pie.out2
      - pie.out2
      - pie.narrow
      - software.pie.R
      - pie.out3
      - pie.out3
      - pie.out3
      - pie.out3
      - pie.gene_broad
      - software.pie.R
      - pie.out4
      - pie.out4
      - pie.out4
      - pie.out4
      - pie.gene_narrow
      - pie.err
  samtoolsview: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/samtoolsview;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\ttest -e /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bowtie/out.sam;\n\tsamtools view -hSb /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bowtie/out.sam> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/samtoolsview/out.bam;\n\tsamtools sort /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/samtoolsview/out.bam out.sorted;\n\tsamtools index /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/samtoolsview/out.sorted.bam;\n\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bowtie/out.sam; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/samtoolsview/err"
    condition: ~
    mem: 2000
    outputfiles: 
      - out.sorted.bam
      - out.sorted.bam.bai
    placeholders: 
      - samtoolsview
      - bowtie.out.sam
      - bowtie.out.sam
      - samtoolsview.out.bam
      - samtoolsview.out.bam
      - samtoolsview.output1
      - bowtie.out.sam
      - samtoolsview.err
  samtoolsviewInp: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/samtoolsviewInp;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\ttest -e /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bowtieinp/out.sam;\n\tsamtools view -hSb /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bowtieinp/out.sam > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/samtoolsviewInp/out.bam;\n\tsamtools sort /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/samtoolsviewInp/out.bam out.sorted;\n\tsamtools index /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/samtoolsviewInp/out.sorted.bam;\n\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bowtieinp/out.sam; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/samtoolsviewInp/err"
    condition: ~
    mem: 2000
    outputfiles: 
      - out.sorted.bam
      - out.sorted.bam.bai
    placeholders: 
      - samtoolsviewInp
      - bowtieinp.out.sam
      - bowtieinp.out.sam
      - samtoolsviewInp.out.bam
      - samtoolsviewInp.out.bam
      - samtoolsviewInp.output1
      - bowtieinp.out.sam
      - samtoolsviewInp.err
  seperateclusters: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/seperateclusters;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\tls * | grep -v err | xargs rm -rf;\n\ttrap SomeErrorHandler ERR;\n\tclusters=4;\n\tcp /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/annotatepeaksgroup/cluster.4.RData /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/seperateclusters/clusters.RData;\n\tExtractGName.R /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/seperateclusters/clusters.RData;\n\t>&2 echo \"cluster1-4\";\n\tfor i in {1..4}\n\tdo\n\t\t>&2 echo \"cluster\" ${i};\n\t\techo -e \"/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/samtoolsviewInp/out.sorted.bam\tclusters.1.cluster${i}.txt\t\\\"H3K4me3 T Cell\\\"\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/seperateclusters/config.txt;\n\t\t>&2 echo \"ngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/seperateclusters/config.txt -O heatmapclusters.${i} -L 5000 -GO total -CO blue:white:red -P 5\";\n\t\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/seperateclusters/config.txt -O heatmapclusters.${i} -L 3000 -GO total -CO blue:white:red -P 5;\n\t\tconvert -density 150 heatmapclusters.${i}.heatmap.pdf -quality 90 heatmapclusters.${i}.heatmap.png;\n\tdone 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/seperateclusters/err"
    condition: ~
    cores: 5
    mem: 5000
    placeholders: 
      - seperateclusters
      - annotatepeaksgroup.output1
      - seperateclusters.clusters.RData
      - seperateclusters.clusters.RData
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.mark_full
      - datasource.Cell
      - seperateclusters.config.txt
      - seperateclusters.config.txt
      - seperateclusters.config.txt
      - seperateclusters.err
  summarystats: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/summarystats;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;trap SomeErrorHandler ERR;\tif [ PE == \"PE\" ];\n\t\tthen if [ TRUE == \"TRUE\" ];\n\t\t\tthen echo \"BM_T_4M_R_lane1\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_4M_R/BM_T_4M_R_1.bam >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/summarystats/out.flagstat;\n\t\t\techo \"BM_T_4M_R_lane2\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_4M_R/BM_T_4M_R_2.bam >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/summarystats/out.flagstat;\n\t\telse echo \"BM_T_4M_R\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/summarystats/out.flagstat;\n\t\t\techo \"FastQ\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/summarystats/out.flagstat;\n\t\tfi;\n\t\tif [ TRUE == \"TRUE\" ];\n\t\t\tthen echo \"Inp_BM_T_4M_R_lane1\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_INP_R/BM_T_INP_R_1.bam >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/summarystats/out.flagstat;\n\t\t\techo \"Inp_BM_T_4M_R_lane2\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_INP_R/BM_T_INP_R_2.bam >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/summarystats/out.flagstat;\n\t\telse echo \"Inp_BM_T_4M_R\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/summarystats/out.flagstat;\n\t\t\techo \"FastQ\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/summarystats/out.flagstat;\n\t\tfi;\n\telse if [ TRUE == \"TRUE\" ]; ### CHECK THIS!! SHOULD be INP_1 and INP_2\n\t\tthen echo \"BM_T_4M_R_lane1\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_4M_R/BM_T_4M_R_1.bam >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/summarystats/out.flagstat;\n\t\t\techo \"BM_T_4M_R_lane2\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_4M_R/BM_T_4M_R_2.bam >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/summarystats/out.flagstat;\n\t\telse echo \"BM_T_4M_R\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/summarystats/out.flagstat;\n\t\t\techo \"FastQ\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/summarystats/out.flagstat;\n\t\tfi;\n\t\tif [ TRUE == \"TRUE\" ];\n\t\t\tthen echo \"Inp_BM_T_4M_R_lane1\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_INP_R/BM_T_INP_R_1.bam >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/summarystats/out.flagstat;\n\t\t\techo \"Inp_BM_T_4M_R_lane2\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_INP_R/BM_T_INP_R_2.bam >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/summarystats/out.flagstat;\n\t\telse echo \"Inp_BM_T_4M_R\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/summarystats/out.flagstat;\n\t\t\techo \"FastQ\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/summarystats/out.flagstat;\n\t\tfi;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/summarystats/err"
    condition: ~
    mem: 1000
    placeholders: 
      - summarystats
      - datasource.SE_PE
      - datasource.bam
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - summarystats.out.flagstat
      - datasource.Inp_bam
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.Inp_location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.Inp_location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - summarystats.out.flagstat
      - datasource.bam
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - summarystats.out.flagstat
      - datasource.Inp_bam
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.Inp_location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.Inp_location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - summarystats.out.flagstat
      - summarystats.err
  trimgalore: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/trimgalore;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tlength=$(gunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofq/out_1.fq.gz | head -2| tail -1 | wc -c);\n\tlength=$[length-11];\n\tif [ PE == \"PE\" ];\n\tthen\n\t\ttrim_galore --fastqc --gzip --length $length --paired -a ACAGTGGT --stringency 4 --trim1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofq/out_1.fq.gz /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofq/out_2.fq.gz;\n\telse\n\t\ttrim_galore --fastqc --gzip --length $length -a ACAGTGGT --stringency 4 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofq/out_1.fq.gz;\n\n\t\tmv out_1_trimmed.fq.gz out_1_val_1.fq.gz;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/trimgalore/err"
    condition: ~
    cores: 3
    mem: 2000
    outputfiles: 
      - out_1.fq.gz_trimming_report.txt
      - out_1_val_1.fq.gz
      - out_2.fq.gz_trimming_report.txt
      - out_2_val_2.fq.gz
      - out_1_val_1.html
      - out_1_val_1.zip
      - out_2_val_2.html
      - out_2_val_2.zip
    placeholders: 
      - trimgalore
      - bamtofq.out_1.fq.gz
      - datasource.SE_PE
      - datasource.Tag
      - bamtofq.out_1.fq.gz
      - bamtofq.out_2.fq.gz
      - datasource.Tag
      - bamtofq.out_1.fq.gz
      - trimgalore.err
  trimgaloreinp: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/trimgaloreinp;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tlength=$(gunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofqinp/out_1.fq.gz | head -2| tail -1 | wc -c);\n\tlength=$[length-11];\n\tif [ PE == \"PE\" ];\n\tthen\n\t\ttrim_galore --fastqc --gzip --length $length --paired -a TAGCTTGT --stringency 4 --trim1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofqinp/out_1.fq.gz /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofqinp/out_2.fq.gz;\n\telse\n\t\ttrim_galore --fastqc --gzip --length $length -a TAGCTTGT --stringency 4 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/bamtofqinp/out_1.fq.gz;\n\t\tmv out_1_trimmed.fq.gz out_1_val_1.fq.gz; ### should FIX\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/trimgaloreinp/err"
    condition: ~
    cores: 3
    mem: 2000
    outputfiles: 
      - out_1.fq.gz_trimming_report.txt
      - out_1_val_1.fq.gz
      - out_2.fq.gz_trimming_report.txt
      - out_2_val_2.fq.gz
      - out_1_val_1.html
      - out_1_val_1.zip
      - out_2_val_2.html
      - out_2_val_2.zip
    placeholders: 
      - trimgaloreinp
      - bamtofqinp.out_1.fq.gz
      - datasource.SE_PE
      - datasource.Inp_Tag
      - bamtofqinp.out_1.fq.gz
      - bamtofqinp.out_2.fq.gz
      - datasource.Inp_Tag
      - bamtofqinp.out_1.fq.gz
      - trimgaloreinp.err
  wigcorrelate: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/wigcorrelate;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tls /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergedbroadpeak/FoldE.bw;\n\tlength=(/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergedbroadpeak/FoldE.bw);\n\t#Change FoldE.bw to output16\n\tif [ ${#length[@]} != 1 ];\n\t\tthen\n\t\twigCorrelate /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmerged/FoldE.bw > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/wigcorrelate/out;\n\tfi; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/wigcorrelate/err"
    condition: groupby
    condition_params: 
      - replicate
    cores: 4
    mem: 5000
    placeholders: 
      - wigcorrelate
      - macsunmergedbroadpeak.output6
      - groupby.replicate.macsunmergedbroadpeak.FoldE.bw
      - groupby.replicate.macsunmerged.FoldE.bw
      - wigcorrelate.out
      - wigcorrelate.err
5: 
  annotatepeaks: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/annotatepeaks;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\tls * | grep -v err | xargs rm -rf;\n\ttrap SomeErrorHandler ERR;\n\tclusters=4\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/samtoolsviewInp/out.sorted.bam -T \"H3K9me3 T Cell\" -O out -L 3000 -GO km -KNC ${clusters} -CO blue:white:red -P 5 -FI 1;\n\t/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/ExtractGeneClusterings.r out;\n\tfor i in $(seq 1 ${clusters});\n\tdo\n\t\techo -e \"/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/samtoolsviewInp/out.sorted.bam\tout.cluster${i}.txt\t\\\"H3K9me3 T Cell Cluster${i}\\\"\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/annotatepeaks/config.txt;\n\tdone\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/annotatepeaks/config.txt -O clusters -L 3000 -GO hc -CO blue:white:red -P 5;\n\tcat > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/annotatepeaks/configB.txt << EOF\n/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/samtoolsviewInp/out.sorted.bam\t/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/B_ordered_TPM.txt\t\"H3K9me3 B cell\"\nEOF\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/annotatepeaks/configB.txt -O TPMorderedB -L 3000 -GO none -CO blue:white:red -P 5;\n\tcat > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/annotatepeaks/configT.txt << EOF\n/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/samtoolsviewInp/out.sorted.bam\t/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/T_ordered_TPM.txt\t\"H3K9me3 T cell\"\nEOF\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/annotatepeaks/configT.txt -O TPMorderedT -L 3000 -GO none -CO blue:white:red -P 5; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/annotatepeaks/err"
    condition: ~
    cores: 5
    mem: 5000
    placeholders: 
      - annotatepeaks
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.mark_full
      - datasource.Cell
      - software.ExtractGeneClusterings.r
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.mark_full
      - datasource.Cell
      - annotatepeaks.config.txt
      - annotatepeaks.config.txt
      - annotatepeaks.configB.txt
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - input.B_ordered_TPM.txt
      - datasource.mark_full
      - annotatepeaks.configB.txt
      - annotatepeaks.configT.txt
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - input.T_ordered_TPM.txt
      - datasource.mark_full
      - annotatepeaks.configT.txt
      - annotatepeaks.err
  annotatepeaksgroup: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/annotatepeaksgroup;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\tls * | grep -v err | xargs rm -rf;\n\ttrap SomeErrorHandler ERR;\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/samtoolsviewInp/out.sorted.bam -T \"H3K9me3 T Cell\" -O out -L 3000 -CO blue:white:red -P 5 -FI 0;\n\tfor clusters in {4..10};\n\t\tdo name=\"cluster.${clusters}\";\n\t\treplot.r heatmap -I out.zip -O ${name} -T \"H3K9me3 T Cell\" -L 3000 -GO km -KNC ${clusters} -CO blue:white:red -P 5;\n\t\tExtractGName.R ${name}.RData;\n\tdone 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/annotatepeaksgroup/err"
    condition: ~
    cores: 5
    mem: 5000
    outputfiles: 
      - cluster.4.RData
    placeholders: 
      - annotatepeaksgroup
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.mark_full
      - datasource.Cell
      - datasource.mark_full
      - datasource.Cell
      - annotatepeaksgroup.err
  bamtofq: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofq;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;trap SomeErrorHandler ERR;\tif [ TRUE == \"TRUE\" ];\n\t\tthen samtools sort /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_9M_R/BM_T_9M_R_1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofq/lane1;\n\t\tsamtools sort /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_9M_R/BM_T_9M_R_2.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofq/lane2;\n\t\tsamtools merge /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofq/merged.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofq/lane1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofq/lane2.bam;\n\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofq/lane1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofq/lane2.bam;\n\t\tif [ PE == \"PE\" ];\n\t\t\tthen\n\t\t\t\tbamtofastq filename=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofq/merged.bam gz=1 F=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofq/out_1.fq.gz F2=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofq/out_2.fq.gz;\n\t\t\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofq/merged.bam;\n\t\t\telse\n\t\t\t\tbamtofastq gz=1 filename=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofq/merged.bam > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofq/out_1.fq.gz;\n\t\t\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofq/merged.bam;\n\t\t\tfi;\n\t\telse\n\t\t\tcat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_9M_R/BM_T_9M_R* > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofq/out_1.fq.gz;\n\t\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofq/err"
    condition: ~
    mem: 1500
    placeholders: 
      - bamtofq
      - datasource.bam
      - datasource.location
      - bamtofq.lane1
      - datasource.location
      - bamtofq.lane2
      - bamtofq.merged.bam
      - bamtofq.lane1
      - bamtofq.lane2
      - bamtofq.lane1
      - bamtofq.lane2
      - datasource.SE_PE
      - bamtofq.merged.bam
      - bamtofq.out_1.fq.gz
      - bamtofq.out_2.fq.gz
      - bamtofq.merged.bam
      - bamtofq.merged.bam
      - bamtofq.out_1.fq.gz
      - bamtofq.merged.bam
      - datasource.location
      - bamtofq.out_1.fq.gz
      - bamtofq.err
  bamtofqinp: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofqinp;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;trap SomeErrorHandler ERR;\tif [ TRUE == \"TRUE\" ];\n\t\tthen samtools sort /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_INP_R/BM_T_INP_R_1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofqinp/lane1;\n\t\tsamtools sort /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_INP_R/BM_T_INP_R_2.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofqinp/lane2;\n\t\tsamtools merge /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofqinp/merged.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofqinp/lane1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofqinp/lane2.bam;\n\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofqinp/lane1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofqinp/lane2.bam;\n\t\tif [ PE == \"PE\" ];\n\t\t\tthen\n\t\t\t\tbamtofastq gz=1 filename=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofqinp/merged.bam F=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofqinp/out_1.fq.gz F2=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofqinp/out_2.fq.gz;\n\t\t\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofqinp/merged.bam;\n\t\t\telse bamtofastq gz=1 filename=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofqinp/merged.bam > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofqinp/out_1.fq.gz;\n\t\t\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofqinp/merged.bam;\n\t\tfi;\n\telse cat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_INP_R/BM_T_INP_R* > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofqinp/out_1.fq.gz;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofqinp/err"
    condition: ~
    mem: 1500
    placeholders: 
      - bamtofqinp
      - datasource.Inp_bam
      - datasource.Inp_location
      - bamtofqinp.lane1
      - datasource.Inp_location
      - bamtofqinp.lane2
      - bamtofqinp.merged.bam
      - bamtofqinp.lane1
      - bamtofqinp.lane2
      - bamtofqinp.lane1
      - bamtofqinp.lane2
      - datasource.SE_PE
      - bamtofqinp.merged.bam
      - bamtofqinp.out_1.fq.gz
      - bamtofqinp.out_2.fq.gz
      - bamtofqinp.merged.bam
      - bamtofqinp.merged.bam
      - bamtofqinp.out_1.fq.gz
      - bamtofqinp.merged.bam
      - datasource.Inp_location
      - bamtofqinp.out_1.fq.gz
      - bamtofqinp.err
  bedcorrelate: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bedcorrelate;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tbroadreplicates=(/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergedbroadpeak/ChIPseqout_peaks.broadPeak);\n\tgappedreplicates=(/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak);\n\tnarrowreplicates=(/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak);\n\t###\n\tbedtools intersect -u -a ${broadreplicates[0]} -b ${broadreplicates[1]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bedcorrelate/broadintersect.bed;\n\tbedtools intersect -u -a ${gappedreplicates[0]} -b ${gappedreplicates[1]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bedcorrelate/gappedintersect.bed;\n\tbedtools intersect -u -a ${narrowreplicates[0]} -b ${narrowreplicates[1]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bedcorrelate/narrowintersect.bed;\n\tbedtools intersect -u -a ${broadreplicates[1]} -b ${broadreplicates[0]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bedcorrelate/broadintersect2.bed;\n\tbedtools intersect -u -a ${gappedreplicates[1]} -b ${gappedreplicates[0]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bedcorrelate/gappedintersect2.bed;\n\tbedtools intersect -u -a ${narrowreplicates[1]} -b ${narrowreplicates[0]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bedcorrelate/narrowintersect2.bed;\n\t###\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bedcorrelate/broadintersect.bed|wc -l ) \"/\" $(cat ${broadreplicates[0]} |wc -l ) \") *100\"|bc >/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bedcorrelate/broadintersect.txt;\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bedcorrelate/gappedintersect.bed|wc -l ) \"/\" $(cat ${gappedreplicates[0]} |wc -l ) \") *100\"|bc >/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bedcorrelate/gappedintersect.txt;\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bedcorrelate/narrowintersect.bed|wc -l ) \"/\" $(cat ${narrowreplicates[0]} |wc -l ) \") *100\"|bc >/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bedcorrelate/narrowintersect.txt;\n\t###\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bedcorrelate/broadintersect2.bed|wc -l ) \"/\" $(cat ${broadreplicates[1]} |wc -l ) \") *100\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bedcorrelate/broadintersect.txt;\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bedcorrelate/gappedintersect2.bed|wc -l ) \"/\" $(cat ${gappedreplicates[1]} |wc -l ) \") *100\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bedcorrelate/gappedintersect.txt;\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bedcorrelate/narrowintersect2.bed|wc -l ) \"/\" $(cat ${narrowreplicates[1]} |wc -l ) \") *100\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bedcorrelate/narrowintersect.txt;\n\t###\n\techo \"scale=4;((\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bedcorrelate/broadintersect.bed|wc -l ) \"/\" $(cat ${broadreplicates[0]} |wc -l ) \")+(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bedcorrelate/broadintersect2.bed|wc -l ) \"/\" $(cat ${broadreplicates[1]} |wc -l ) \")) *50\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bedcorrelate/broadintersect.txt;\n\techo \"scale=4;((\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bedcorrelate/gappedintersect.bed|wc -l ) \"/\" $(cat ${gappedreplicates[0]} |wc -l ) \")+(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bedcorrelate/gappedintersect2.bed|wc -l ) \"/\" $(cat ${gappedreplicates[1]} |wc -l ) \")) *50\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bedcorrelate/gappedintersect.txt;\n\techo \"scale=4;((\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bedcorrelate/narrowintersect.bed|wc -l ) \"/\" $(cat ${narrowreplicates[0]} |wc -l ) \")+(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bedcorrelate/narrowintersect2.bed|wc -l ) \"/\" $(cat ${narrowreplicates[1]} |wc -l ) \")) *50\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bedcorrelate/narrowintersect.txt; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bedcorrelate/err"
    condition: groupby
    condition_params: 
      - replicate
    cores: 4
    mem: 5000
    placeholders: 
      - bedcorrelate
      - groupby.replicate.macsunmergedbroadpeak.ChIPseqout_peaks.broadPeak
      - groupby.replicate.macsunmergedbroadpeak.ChIPseqout_peaks.gappedPeak
      - groupby.replicate.macsunmergednarrowpeak.ChIPseqout_peaks.narrowPeak
      - bedcorrelate.broadintersect.bed
      - bedcorrelate.gappedintersect.bed
      - bedcorrelate.narrowintersect.bed
      - bedcorrelate.broadintersect2.bed
      - bedcorrelate.gappedintersect2.bed
      - bedcorrelate.narrowintersect2.bed
      - bedcorrelate.broadintersect.bed
      - bedcorrelate.broadintersect.txt
      - bedcorrelate.gappedintersect.bed
      - bedcorrelate.gappedintersect.txt
      - bedcorrelate.narrowintersect.bed
      - bedcorrelate.narrowintersect.txt
      - bedcorrelate.broadintersect2.bed
      - bedcorrelate.broadintersect.txt
      - bedcorrelate.gappedintersect2.bed
      - bedcorrelate.gappedintersect.txt
      - bedcorrelate.narrowintersect2.bed
      - bedcorrelate.narrowintersect.txt
      - bedcorrelate.broadintersect.bed
      - bedcorrelate.broadintersect2.bed
      - bedcorrelate.broadintersect.txt
      - bedcorrelate.gappedintersect.bed
      - bedcorrelate.gappedintersect2.bed
      - bedcorrelate.gappedintersect.txt
      - bedcorrelate.narrowintersect.bed
      - bedcorrelate.narrowintersect2.bed
      - bedcorrelate.narrowintersect.txt
      - bedcorrelate.err
  bowtie: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bowtie;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tls /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_build/touch /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_buildcast/touch;\n\tif [ PE == \"PE\" ];\n\t\tthen /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/bowtierun -p PE -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/trimgalore/out_1_val_1.fq.gz -2 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/trimgalore/out_2_val_2.fq.gz -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bowtie/out.sam -s C57BL6J;\n\telse /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/bowtierun -p PE -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/trimgalore/out_1_val_1.fq.gz -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bowtie/out.sam -s C57BL6J;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bowtie/err"
    condition: ~
    cores: 14
    mem: 7000
    placeholders: 
      - bowtie
      - bowtie_build.touch
      - bowtie_buildcast.touch
      - datasource.SE_PE
      - software.bowtierun
      - datasource.SE_PE
      - trimgalore.output2
      - trimgalore.output4
      - bowtie.out.sam
      - datasource.Strain
      - software.bowtierun
      - datasource.SE_PE
      - trimgalore.output2
      - bowtie.out.sam
      - datasource.Strain
      - bowtie.err
  bowtieinp: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bowtieinp;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tls /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_build/touch /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_buildcast/touch;\n\tif [ PE == \"PE\" ];\n\t\tthen /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/bowtierun -p PE -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/trimgaloreinp/out_1_val_1.fq.gz -2 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/trimgaloreinp/out_2_val_2.fq.gz -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bowtieinp/out.sam -s C57BL6J;\n\telse /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/bowtierun -p PE -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/trimgaloreinp/out_1_val_1.fq.gz -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bowtieinp/out.sam -s C57BL6J;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bowtieinp/err"
    condition: ~
    cores: 14
    mem: 7000
    placeholders: 
      - bowtieinp
      - bowtie_build.touch
      - bowtie_buildcast.touch
      - datasource.SE_PE
      - software.bowtierun
      - datasource.SE_PE
      - trimgaloreinp.output2
      - trimgaloreinp.output4
      - bowtieinp.out.sam
      - datasource.Strain
      - software.bowtierun
      - datasource.SE_PE
      - trimgaloreinp.output2
      - bowtieinp.out.sam
      - datasource.Strain
      - bowtieinp.err
  fastquality: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/fastquality;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tgunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/trimgalore/out_1_val_1.fq.gz | fastx_quality_stats -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/fastquality/out1;\n\tfastq_quality_boxplot_graph.sh -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/fastquality/out1 -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/fastquality/out1.png -t BM_T_9M_R_read1;\n\tgunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/trimgaloreinp/out_1_val_1.fq.gz | fastx_quality_stats -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/fastquality/Inpout1;\n\tfastq_quality_boxplot_graph.sh -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/fastquality/Inpout1 -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/fastquality/Inpout1.png -t BM_T_9M_R_input_read1;\n\tif [ PE == \"PE\" ];\n\tthen gunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/trimgalore/out_2_val_2.fq.gz | fastx_quality_stats -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/fastquality/out2;\n\t\tfastq_quality_boxplot_graph.sh -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/fastquality/out2 -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/fastquality/out2.png -t BM_T_9M_R_read2;\n\t\tgunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/trimgaloreinp/out_2_val_2.fq.gz | fastx_quality_stats -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/fastquality/Inpout2;\n\t\tfastq_quality_boxplot_graph.sh -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/fastquality/Inpout2 -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/fastquality/Inpout2.png -t BM_T_9M_R_input_read2;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/fastquality/err"
    condition: ~
    mem: 50
    placeholders: 
      - fastquality
      - trimgalore.output2
      - fastquality.out1
      - fastquality.out1
      - fastquality.out1.png
      - datasource.Name
      - trimgaloreinp.output2
      - fastquality.Inpout1
      - fastquality.Inpout1
      - fastquality.Inpout1.png
      - datasource.Name
      - datasource.SE_PE
      - trimgalore.output4
      - fastquality.out2
      - fastquality.out2
      - fastquality.out2.png
      - datasource.Name
      - trimgaloreinp.output4
      - fastquality.Inpout2
      - fastquality.Inpout2
      - fastquality.Inpout2.png
      - datasource.Name
      - fastquality.err
  macsmergedbroad: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergedbroad;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tlast=$(tail -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bedcorrelate/broadintersect.txt);\n\tint=${last%.*};\n\tif [ $int -gt 75 ];\n\t\tthen macs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -q 0.01 --broad --broad-cutoff 0.1 --fix-bimodal --extsize 250 --keep-dup auto;\n\t\t###\n\t\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergedbroad/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergedbroad/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergedbroad/FoldE.bdg -m FE\";\n\t\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergedbroad/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergedbroad/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergedbroad/FoldE.bdg -m FE;\n\t\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergedbroad/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergedbroad/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergedbroad/logLR.bdg -m logLR -p 0.00001\";\n\t\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergedbroad/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergedbroad/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergedbroad/logLR.bdg -m logLR -p 0.00001;\n\t\t###\n\t\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergedbroad/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\t\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergedbroad/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergedbroad/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\t\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergedbroad/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t\t###\n\t\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergedbroad/ChIPseqout_model.r;\n\t\tbroadpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergedbroad/ChIPseqout_peaks.broadPeak broadout;\n\t\tgappedpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergedbroad/ChIPseqout_peaks.gappedPeak gappedout;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergedbroad/err"
    condition: groupby
    condition_params: 
      - replicate
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.broadPeak
      - ChIPseqout_peaks.gappedPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
    placeholders: 
      - macsmergedbroad
      - datasource.SE_PE
      - bedcorrelate.broadintersect.txt
      - groupby.replicate.samtoolsview.out.sorted.bam
      - groupby.replicate.samtoolsviewInp.out.sorted.bam
      - datasource.sonication
      - macsmergedbroad.output4
      - macsmergedbroad.output5
      - macsmergedbroad.FoldE.bdg
      - macsmergedbroad.output4
      - macsmergedbroad.output5
      - macsmergedbroad.FoldE.bdg
      - macsmergedbroad.output4
      - macsmergedbroad.output5
      - macsmergedbroad.logLR.bdg
      - macsmergedbroad.output4
      - macsmergedbroad.output5
      - macsmergedbroad.logLR.bdg
      - macsmergedbroad.FoldE.bdg
      - input.mm10.len
      - macsmergedbroad.FoldE.bdg
      - input.mm10.len
      - macsmergedbroad.logLR.bdg
      - input.mm10.len
      - macsmergedbroad.logLR.bdg
      - input.mm10.len
      - macsmergedbroad.output3
      - macsmergedbroad.output1
      - macsmergedbroad.output2
      - macsmergedbroad.err
  macsmergednarrow: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergednarrow;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tlast=$(tail -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bedcorrelate/narrowintersect.txt);\n\tint=${last%.*};\n\tif [ $int -gt 75 ];\n\t\tthen macs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -q 0.01 --fix-bimodal --extsize 250 --keep-dup auto;\n\t\t###\n\t\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergednarrow/ChIPseqout_control_lambda.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergednarrow/FoldE.bw -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergednarrow/FoldE.bdg -m FE\";\n\t\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergednarrow/ChIPseqout_control_lambda.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergednarrow/FoldE.bw -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergednarrow/FoldE.bdg -m FE;\n\t\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergednarrow/ChIPseqout_control_lambda.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergednarrow/FoldE.bw -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergednarrow/logLR.bdg -m logLR -p 0.00001\";\n\t\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergednarrow/ChIPseqout_control_lambda.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergednarrow/FoldE.bw -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergednarrow/logLR.bdg -m logLR -p 0.00001;\n\t\t###\n\t\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergednarrow/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\t\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergednarrow/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergednarrow/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\t\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergednarrow/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t\t###\n\t\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergednarrow/ChIPseqout_model.r;\n\t\tnarrowpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergednarrow/ChIPseqout_peaks.narrowPeak narrowout;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsmergednarrow/err"
    condition: groupby
    condition_params: 
      - replicate
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.narrowPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
    placeholders: 
      - macsmergednarrow
      - datasource.SE_PE
      - bedcorrelate.narrowintersect.txt
      - groupby.replicate.samtoolsview.out.sorted.bam
      - groupby.replicate.samtoolsviewInp.out.sorted.bam
      - datasource.sonication
      - macsmergednarrow.output4
      - macsmergednarrow.output5
      - macsmergednarrow.FoldE.bdg
      - macsmergednarrow.output4
      - macsmergednarrow.output5
      - macsmergednarrow.FoldE.bdg
      - macsmergednarrow.output4
      - macsmergednarrow.output5
      - macsmergednarrow.logLR.bdg
      - macsmergednarrow.output4
      - macsmergednarrow.output5
      - macsmergednarrow.logLR.bdg
      - macsmergednarrow.FoldE.bdg
      - input.mm10.len
      - macsmergednarrow.FoldE.bdg
      - input.mm10.len
      - macsmergednarrow.logLR.bdg
      - input.mm10.len
      - macsmergednarrow.logLR.bdg
      - input.mm10.len
      - macsmergednarrow.output2
      - macsmergednarrow.output1
      - macsmergednarrow.err
  macsunmerged: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmerged;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; \tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tmacs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -p 1 --fix-bimodal --extsize 250 --keep-dup auto; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmerged/err"
    condition: ~
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.narrowPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
    placeholders: 
      - macsunmerged
      - datasource.SE_PE
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.sonication
      - macsunmerged.err
  macsunmergedbroadpeak: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergedbroadpeak;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; ls * | grep -v err | xargs rm -rf;\t. /nfs/users/nfs_r/rg12/.bashrc;\n\ttrap SomeErrorHandler ERR;\n\tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tmacs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -q 0.05 --broad --broad-cutoff 0.1 --fix-bimodal --extsize 250 --keep-dup auto;\n\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergedbroadpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergedbroadpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergedbroadpeak/FoldE.bdg -m FE\";\n\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergedbroadpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergedbroadpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergedbroadpeak/FoldE.bdg -m FE;\n\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergedbroadpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergedbroadpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergedbroadpeak/logLR.bdg -m logLR -p 0.00001\";\n\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergedbroadpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergedbroadpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergedbroadpeak/logLR.bdg -m logLR -p 0.00001;\n\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergedbroadpeak/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergedbroadpeak/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergedbroadpeak/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergedbroadpeak/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t>&2 echo \"Rscript\";\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergedbroadpeak/ChIPseqout_model.r;\n\tbroadpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergedbroadpeak/ChIPseqout_peaks.broadPeak broadout;\n\tgappedpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak gappedout;\n\tbedtools genomecov -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergedbroadpeak/ChIPseqout_peaks.broadPeak -g /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len -bg > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergedbroadpeak/broad.bdg;\n\tbedtools genomecov -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak -g /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len -bg > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergedbroadpeak/gapped.bdg; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergedbroadpeak/err"
    condition: ~
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.broadPeak
      - ChIPseqout_peaks.gappedPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
    placeholders: 
      - macsunmergedbroadpeak
      - datasource.SE_PE
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.sonication
      - macsunmergedbroadpeak.output4
      - macsunmergedbroadpeak.output5
      - macsunmergedbroadpeak.FoldE.bdg
      - macsunmergedbroadpeak.output4
      - macsunmergedbroadpeak.output5
      - macsunmergedbroadpeak.FoldE.bdg
      - macsunmergedbroadpeak.output4
      - macsunmergedbroadpeak.output5
      - macsunmergedbroadpeak.logLR.bdg
      - macsunmergedbroadpeak.output4
      - macsunmergedbroadpeak.output5
      - macsunmergedbroadpeak.logLR.bdg
      - macsunmergedbroadpeak.FoldE.bdg
      - input.mm10.len
      - macsunmergedbroadpeak.FoldE.bdg
      - input.mm10.len
      - macsunmergedbroadpeak.logLR.bdg
      - input.mm10.len
      - macsunmergedbroadpeak.logLR.bdg
      - input.mm10.len
      - macsunmergedbroadpeak.output3
      - macsunmergedbroadpeak.output1
      - macsunmergedbroadpeak.output2
      - macsunmergedbroadpeak.output1
      - input.mm10.len
      - macsunmergedbroadpeak.broad.bdg
      - macsunmergedbroadpeak.output2
      - input.mm10.len
      - macsunmergedbroadpeak.gapped.bdg
      - macsunmergedbroadpeak.err
  macsunmergednarrowpeak: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergednarrowpeak;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; ls * | grep -v err | xargs rm -rf;\t. /nfs/users/nfs_r/rg12/.bashrc;\n\ttrap SomeErrorHandler ERR;\n\tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tmacs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -q 0.01 --fix-bimodal --extsize 250 --keep-dup auto;\n\t###\n\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergednarrowpeak/FoldE.bdg -m FE\";\n\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergednarrowpeak/FoldE.bdg -m FE;\n\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergednarrowpeak/logLR.bdg -m logLR -p 0.00001\";\n\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergednarrowpeak/logLR.bdg -m logLR -p 0.00001;\n\t###\n\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergednarrowpeak/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergednarrowpeak/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergednarrowpeak/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergednarrowpeak/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t###\n\t>&2 echo \"Rscript\";\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergednarrowpeak/ChIPseqout_model.r;\n\tnarrowpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak narrowout;\n\t###\n\tbgzip /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg;\n\tbgzip /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg;\n\ttabix -p bed /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg.gz;\n\ttabix -p bed /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg.gz;\n\tbedtools genomecov -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak -g /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len -bg > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergednarrowpeak/narrow.bdg; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergednarrowpeak/err"
    condition: ~
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.narrowPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
      - ChIPseqout_treat_pileup.bdg.gz
      - ChIPseqout_control_lambda.bdg.gz
      - ChIPseqout_treat_pileup.bdg.gz.tbi
      - ChIPseqout_control_lambda.bdg.gz.tbi
    placeholders: 
      - macsunmergednarrowpeak
      - datasource.SE_PE
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.sonication
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.FoldE.bdg
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.FoldE.bdg
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.logLR.bdg
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.logLR.bdg
      - macsunmergednarrowpeak.FoldE.bdg
      - input.mm10.len
      - macsunmergednarrowpeak.FoldE.bdg
      - input.mm10.len
      - macsunmergednarrowpeak.logLR.bdg
      - input.mm10.len
      - macsunmergednarrowpeak.logLR.bdg
      - input.mm10.len
      - macsunmergednarrowpeak.output2
      - macsunmergednarrowpeak.output1
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.output7
      - macsunmergednarrowpeak.output8
      - macsunmergednarrowpeak.output1
      - input.mm10.len
      - macsunmergednarrowpeak.narrow.bdg
      - macsunmergednarrowpeak.err
  pie: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/pie;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; ls * | grep -v err | xargs rm -rf;\t. /nfs/users/nfs_r/rg12/.bashrc;\n\ttrap SomeErrorHandler ERR;\n\t#gapped broad output\n\tbedtools intersect -loj -a /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak -b /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/ens_genes_and_promoter_distal.bed > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/pie/out;\n\tbedtools intersect -loj -a /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak -b /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/ens_genes_and_promoter_distal.bed > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/pie/out2;\n\tbedtools intersect -wa -b /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak -a /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/ens_genes_and_promoter_distal.bed > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/pie/out3;\n\tbedtools intersect -wa -b /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak -a /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/ens_genes_and_promoter_distal.bed > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/pie/out4;\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/pie.R $(grep -c Gene /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/pie/out) $(grep -c Distal /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/pie/out) $(grep -c Promoter /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/pie/out) $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/pie/out |wc -l) rplot_broad.pdf > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/pie/broad\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/pie.R $(grep -c Gene /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/pie/out2) $(grep -c Distal /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/pie/out2) $(grep -c Promoter /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/pie/out2) $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/pie/out2 |wc -l) rplot_narrow.pdf > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/pie/narrow\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/pie.R $(grep -c Gene /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/pie/out3) $(grep -c Distal /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/pie/out3) $(grep -c Promoter /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/pie/out3) $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/pie/out3 |wc -l) rplot_gene_broad.pdf > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/pie/gene_broad\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/pie.R $(grep -c Gene /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/pie/out4) $(grep -c Distal /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/pie/out4) $(grep -c Promoter /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/pie/out4) $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/pie/out4 |wc -l) rplot_gene_narrow.pdf > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/pie/gene_narrow 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/pie/err"
    condition: ~
    mem: 5000
    placeholders: 
      - pie
      - macsunmergedbroadpeak.output2
      - input.ens_genes_and_promoter_distal.bed
      - pie.out
      - macsunmergednarrowpeak.output1
      - input.ens_genes_and_promoter_distal.bed
      - pie.out2
      - macsunmergedbroadpeak.output2
      - input.ens_genes_and_promoter_distal.bed
      - pie.out3
      - macsunmergednarrowpeak.output1
      - input.ens_genes_and_promoter_distal.bed
      - pie.out4
      - software.pie.R
      - pie.out
      - pie.out
      - pie.out
      - pie.out
      - pie.broad
      - software.pie.R
      - pie.out2
      - pie.out2
      - pie.out2
      - pie.out2
      - pie.narrow
      - software.pie.R
      - pie.out3
      - pie.out3
      - pie.out3
      - pie.out3
      - pie.gene_broad
      - software.pie.R
      - pie.out4
      - pie.out4
      - pie.out4
      - pie.out4
      - pie.gene_narrow
      - pie.err
  samtoolsview: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/samtoolsview;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\ttest -e /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bowtie/out.sam;\n\tsamtools view -hSb /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bowtie/out.sam> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/samtoolsview/out.bam;\n\tsamtools sort /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/samtoolsview/out.bam out.sorted;\n\tsamtools index /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/samtoolsview/out.sorted.bam;\n\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bowtie/out.sam; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/samtoolsview/err"
    condition: ~
    mem: 2000
    outputfiles: 
      - out.sorted.bam
      - out.sorted.bam.bai
    placeholders: 
      - samtoolsview
      - bowtie.out.sam
      - bowtie.out.sam
      - samtoolsview.out.bam
      - samtoolsview.out.bam
      - samtoolsview.output1
      - bowtie.out.sam
      - samtoolsview.err
  samtoolsviewInp: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/samtoolsviewInp;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\ttest -e /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bowtieinp/out.sam;\n\tsamtools view -hSb /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bowtieinp/out.sam > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/samtoolsviewInp/out.bam;\n\tsamtools sort /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/samtoolsviewInp/out.bam out.sorted;\n\tsamtools index /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/samtoolsviewInp/out.sorted.bam;\n\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bowtieinp/out.sam; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/samtoolsviewInp/err"
    condition: ~
    mem: 2000
    outputfiles: 
      - out.sorted.bam
      - out.sorted.bam.bai
    placeholders: 
      - samtoolsviewInp
      - bowtieinp.out.sam
      - bowtieinp.out.sam
      - samtoolsviewInp.out.bam
      - samtoolsviewInp.out.bam
      - samtoolsviewInp.output1
      - bowtieinp.out.sam
      - samtoolsviewInp.err
  seperateclusters: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/seperateclusters;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\tls * | grep -v err | xargs rm -rf;\n\ttrap SomeErrorHandler ERR;\n\tclusters=4;\n\tcp /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/annotatepeaksgroup/cluster.4.RData /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/seperateclusters/clusters.RData;\n\tExtractGName.R /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/seperateclusters/clusters.RData;\n\t>&2 echo \"cluster1-4\";\n\tfor i in {1..4}\n\tdo\n\t\t>&2 echo \"cluster\" ${i};\n\t\techo -e \"/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/samtoolsviewInp/out.sorted.bam\tclusters.1.cluster${i}.txt\t\\\"H3K9me3 T Cell\\\"\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/seperateclusters/config.txt;\n\t\t>&2 echo \"ngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/seperateclusters/config.txt -O heatmapclusters.${i} -L 5000 -GO total -CO blue:white:red -P 5\";\n\t\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/seperateclusters/config.txt -O heatmapclusters.${i} -L 3000 -GO total -CO blue:white:red -P 5;\n\t\tconvert -density 150 heatmapclusters.${i}.heatmap.pdf -quality 90 heatmapclusters.${i}.heatmap.png;\n\tdone 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/seperateclusters/err"
    condition: ~
    cores: 5
    mem: 5000
    placeholders: 
      - seperateclusters
      - annotatepeaksgroup.output1
      - seperateclusters.clusters.RData
      - seperateclusters.clusters.RData
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.mark_full
      - datasource.Cell
      - seperateclusters.config.txt
      - seperateclusters.config.txt
      - seperateclusters.config.txt
      - seperateclusters.err
  summarystats: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/summarystats;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;trap SomeErrorHandler ERR;\tif [ PE == \"PE\" ];\n\t\tthen if [ TRUE == \"TRUE\" ];\n\t\t\tthen echo \"BM_T_9M_R_lane1\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_9M_R/BM_T_9M_R_1.bam >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/summarystats/out.flagstat;\n\t\t\techo \"BM_T_9M_R_lane2\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_9M_R/BM_T_9M_R_2.bam >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/summarystats/out.flagstat;\n\t\telse echo \"BM_T_9M_R\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/summarystats/out.flagstat;\n\t\t\techo \"FastQ\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/summarystats/out.flagstat;\n\t\tfi;\n\t\tif [ TRUE == \"TRUE\" ];\n\t\t\tthen echo \"Inp_BM_T_9M_R_lane1\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_INP_R/BM_T_INP_R_1.bam >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/summarystats/out.flagstat;\n\t\t\techo \"Inp_BM_T_9M_R_lane2\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_INP_R/BM_T_INP_R_2.bam >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/summarystats/out.flagstat;\n\t\telse echo \"Inp_BM_T_9M_R\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/summarystats/out.flagstat;\n\t\t\techo \"FastQ\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/summarystats/out.flagstat;\n\t\tfi;\n\telse if [ TRUE == \"TRUE\" ]; ### CHECK THIS!! SHOULD be INP_1 and INP_2\n\t\tthen echo \"BM_T_9M_R_lane1\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_9M_R/BM_T_9M_R_1.bam >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/summarystats/out.flagstat;\n\t\t\techo \"BM_T_9M_R_lane2\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_9M_R/BM_T_9M_R_2.bam >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/summarystats/out.flagstat;\n\t\telse echo \"BM_T_9M_R\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/summarystats/out.flagstat;\n\t\t\techo \"FastQ\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/summarystats/out.flagstat;\n\t\tfi;\n\t\tif [ TRUE == \"TRUE\" ];\n\t\t\tthen echo \"Inp_BM_T_9M_R_lane1\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_INP_R/BM_T_INP_R_1.bam >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/summarystats/out.flagstat;\n\t\t\techo \"Inp_BM_T_9M_R_lane2\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_INP_R/BM_T_INP_R_2.bam >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/summarystats/out.flagstat;\n\t\telse echo \"Inp_BM_T_9M_R\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/summarystats/out.flagstat;\n\t\t\techo \"FastQ\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/summarystats/out.flagstat;\n\t\tfi;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/summarystats/err"
    condition: ~
    mem: 1000
    placeholders: 
      - summarystats
      - datasource.SE_PE
      - datasource.bam
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - summarystats.out.flagstat
      - datasource.Inp_bam
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.Inp_location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.Inp_location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - summarystats.out.flagstat
      - datasource.bam
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - summarystats.out.flagstat
      - datasource.Inp_bam
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.Inp_location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.Inp_location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - summarystats.out.flagstat
      - summarystats.err
  trimgalore: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/trimgalore;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tlength=$(gunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofq/out_1.fq.gz | head -2| tail -1 | wc -c);\n\tlength=$[length-11];\n\tif [ PE == \"PE\" ];\n\tthen\n\t\ttrim_galore --fastqc --gzip --length $length --paired -a GCCAATGT --stringency 4 --trim1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofq/out_1.fq.gz /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofq/out_2.fq.gz;\n\telse\n\t\ttrim_galore --fastqc --gzip --length $length -a GCCAATGT --stringency 4 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofq/out_1.fq.gz;\n\n\t\tmv out_1_trimmed.fq.gz out_1_val_1.fq.gz;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/trimgalore/err"
    condition: ~
    cores: 3
    mem: 2000
    outputfiles: 
      - out_1.fq.gz_trimming_report.txt
      - out_1_val_1.fq.gz
      - out_2.fq.gz_trimming_report.txt
      - out_2_val_2.fq.gz
      - out_1_val_1.html
      - out_1_val_1.zip
      - out_2_val_2.html
      - out_2_val_2.zip
    placeholders: 
      - trimgalore
      - bamtofq.out_1.fq.gz
      - datasource.SE_PE
      - datasource.Tag
      - bamtofq.out_1.fq.gz
      - bamtofq.out_2.fq.gz
      - datasource.Tag
      - bamtofq.out_1.fq.gz
      - trimgalore.err
  trimgaloreinp: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/trimgaloreinp;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tlength=$(gunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofqinp/out_1.fq.gz | head -2| tail -1 | wc -c);\n\tlength=$[length-11];\n\tif [ PE == \"PE\" ];\n\tthen\n\t\ttrim_galore --fastqc --gzip --length $length --paired -a TAGCTTGT --stringency 4 --trim1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofqinp/out_1.fq.gz /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofqinp/out_2.fq.gz;\n\telse\n\t\ttrim_galore --fastqc --gzip --length $length -a TAGCTTGT --stringency 4 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/bamtofqinp/out_1.fq.gz;\n\t\tmv out_1_trimmed.fq.gz out_1_val_1.fq.gz; ### should FIX\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/trimgaloreinp/err"
    condition: ~
    cores: 3
    mem: 2000
    outputfiles: 
      - out_1.fq.gz_trimming_report.txt
      - out_1_val_1.fq.gz
      - out_2.fq.gz_trimming_report.txt
      - out_2_val_2.fq.gz
      - out_1_val_1.html
      - out_1_val_1.zip
      - out_2_val_2.html
      - out_2_val_2.zip
    placeholders: 
      - trimgaloreinp
      - bamtofqinp.out_1.fq.gz
      - datasource.SE_PE
      - datasource.Inp_Tag
      - bamtofqinp.out_1.fq.gz
      - bamtofqinp.out_2.fq.gz
      - datasource.Inp_Tag
      - bamtofqinp.out_1.fq.gz
      - trimgaloreinp.err
  wigcorrelate: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/wigcorrelate;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tls /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergedbroadpeak/FoldE.bw;\n\tlength=(/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergedbroadpeak/FoldE.bw);\n\t#Change FoldE.bw to output16\n\tif [ ${#length[@]} != 1 ];\n\t\tthen\n\t\twigCorrelate /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmerged/FoldE.bw > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/wigcorrelate/out;\n\tfi; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/wigcorrelate/err"
    condition: groupby
    condition_params: 
      - replicate
    cores: 4
    mem: 5000
    placeholders: 
      - wigcorrelate
      - macsunmergedbroadpeak.output6
      - groupby.replicate.macsunmergedbroadpeak.FoldE.bw
      - groupby.replicate.macsunmerged.FoldE.bw
      - wigcorrelate.out
      - wigcorrelate.err
6: 
  annotatepeaks: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/annotatepeaks;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\tls * | grep -v err | xargs rm -rf;\n\ttrap SomeErrorHandler ERR;\n\tclusters=4\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/samtoolsviewInp/out.sorted.bam -T \"H4K20me3 T Cell\" -O out -L 3000 -GO km -KNC ${clusters} -CO blue:white:red -P 5 -FI 1;\n\t/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/ExtractGeneClusterings.r out;\n\tfor i in $(seq 1 ${clusters});\n\tdo\n\t\techo -e \"/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/samtoolsviewInp/out.sorted.bam\tout.cluster${i}.txt\t\\\"H4K20me3 T Cell Cluster${i}\\\"\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/annotatepeaks/config.txt;\n\tdone\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/annotatepeaks/config.txt -O clusters -L 3000 -GO hc -CO blue:white:red -P 5;\n\tcat > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/annotatepeaks/configB.txt << EOF\n/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/samtoolsviewInp/out.sorted.bam\t/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/B_ordered_TPM.txt\t\"H4K20me3 B cell\"\nEOF\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/annotatepeaks/configB.txt -O TPMorderedB -L 3000 -GO none -CO blue:white:red -P 5;\n\tcat > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/annotatepeaks/configT.txt << EOF\n/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/samtoolsviewInp/out.sorted.bam\t/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/T_ordered_TPM.txt\t\"H4K20me3 T cell\"\nEOF\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/annotatepeaks/configT.txt -O TPMorderedT -L 3000 -GO none -CO blue:white:red -P 5; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/annotatepeaks/err"
    condition: ~
    cores: 5
    mem: 5000
    placeholders: 
      - annotatepeaks
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.mark_full
      - datasource.Cell
      - software.ExtractGeneClusterings.r
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.mark_full
      - datasource.Cell
      - annotatepeaks.config.txt
      - annotatepeaks.config.txt
      - annotatepeaks.configB.txt
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - input.B_ordered_TPM.txt
      - datasource.mark_full
      - annotatepeaks.configB.txt
      - annotatepeaks.configT.txt
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - input.T_ordered_TPM.txt
      - datasource.mark_full
      - annotatepeaks.configT.txt
      - annotatepeaks.err
  annotatepeaksgroup: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/annotatepeaksgroup;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\tls * | grep -v err | xargs rm -rf;\n\ttrap SomeErrorHandler ERR;\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/samtoolsviewInp/out.sorted.bam -T \"H4K20me3 T Cell\" -O out -L 3000 -CO blue:white:red -P 5 -FI 0;\n\tfor clusters in {4..10};\n\t\tdo name=\"cluster.${clusters}\";\n\t\treplot.r heatmap -I out.zip -O ${name} -T \"H4K20me3 T Cell\" -L 3000 -GO km -KNC ${clusters} -CO blue:white:red -P 5;\n\t\tExtractGName.R ${name}.RData;\n\tdone 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/annotatepeaksgroup/err"
    condition: ~
    cores: 5
    mem: 5000
    outputfiles: 
      - cluster.4.RData
    placeholders: 
      - annotatepeaksgroup
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.mark_full
      - datasource.Cell
      - datasource.mark_full
      - datasource.Cell
      - annotatepeaksgroup.err
  bamtofq: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofq;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;trap SomeErrorHandler ERR;\tif [ TRUE == \"TRUE\" ];\n\t\tthen samtools sort /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_20M_R/BM_T_20M_R_1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofq/lane1;\n\t\tsamtools sort /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_20M_R/BM_T_20M_R_2.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofq/lane2;\n\t\tsamtools merge /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofq/merged.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofq/lane1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofq/lane2.bam;\n\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofq/lane1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofq/lane2.bam;\n\t\tif [ PE == \"PE\" ];\n\t\t\tthen\n\t\t\t\tbamtofastq filename=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofq/merged.bam gz=1 F=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofq/out_1.fq.gz F2=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofq/out_2.fq.gz;\n\t\t\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofq/merged.bam;\n\t\t\telse\n\t\t\t\tbamtofastq gz=1 filename=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofq/merged.bam > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofq/out_1.fq.gz;\n\t\t\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofq/merged.bam;\n\t\t\tfi;\n\t\telse\n\t\t\tcat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_20M_R/BM_T_20M_R* > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofq/out_1.fq.gz;\n\t\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofq/err"
    condition: ~
    mem: 1500
    placeholders: 
      - bamtofq
      - datasource.bam
      - datasource.location
      - bamtofq.lane1
      - datasource.location
      - bamtofq.lane2
      - bamtofq.merged.bam
      - bamtofq.lane1
      - bamtofq.lane2
      - bamtofq.lane1
      - bamtofq.lane2
      - datasource.SE_PE
      - bamtofq.merged.bam
      - bamtofq.out_1.fq.gz
      - bamtofq.out_2.fq.gz
      - bamtofq.merged.bam
      - bamtofq.merged.bam
      - bamtofq.out_1.fq.gz
      - bamtofq.merged.bam
      - datasource.location
      - bamtofq.out_1.fq.gz
      - bamtofq.err
  bamtofqinp: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofqinp;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;trap SomeErrorHandler ERR;\tif [ TRUE == \"TRUE\" ];\n\t\tthen samtools sort /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_INP_R/BM_T_INP_R_1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofqinp/lane1;\n\t\tsamtools sort /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_INP_R/BM_T_INP_R_2.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofqinp/lane2;\n\t\tsamtools merge /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofqinp/merged.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofqinp/lane1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofqinp/lane2.bam;\n\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofqinp/lane1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofqinp/lane2.bam;\n\t\tif [ PE == \"PE\" ];\n\t\t\tthen\n\t\t\t\tbamtofastq gz=1 filename=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofqinp/merged.bam F=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofqinp/out_1.fq.gz F2=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofqinp/out_2.fq.gz;\n\t\t\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofqinp/merged.bam;\n\t\t\telse bamtofastq gz=1 filename=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofqinp/merged.bam > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofqinp/out_1.fq.gz;\n\t\t\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofqinp/merged.bam;\n\t\tfi;\n\telse cat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_INP_R/BM_T_INP_R* > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofqinp/out_1.fq.gz;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofqinp/err"
    condition: ~
    mem: 1500
    placeholders: 
      - bamtofqinp
      - datasource.Inp_bam
      - datasource.Inp_location
      - bamtofqinp.lane1
      - datasource.Inp_location
      - bamtofqinp.lane2
      - bamtofqinp.merged.bam
      - bamtofqinp.lane1
      - bamtofqinp.lane2
      - bamtofqinp.lane1
      - bamtofqinp.lane2
      - datasource.SE_PE
      - bamtofqinp.merged.bam
      - bamtofqinp.out_1.fq.gz
      - bamtofqinp.out_2.fq.gz
      - bamtofqinp.merged.bam
      - bamtofqinp.merged.bam
      - bamtofqinp.out_1.fq.gz
      - bamtofqinp.merged.bam
      - datasource.Inp_location
      - bamtofqinp.out_1.fq.gz
      - bamtofqinp.err
  bedcorrelate: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bedcorrelate;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tbroadreplicates=(/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergedbroadpeak/ChIPseqout_peaks.broadPeak);\n\tgappedreplicates=(/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak);\n\tnarrowreplicates=(/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak);\n\t###\n\tbedtools intersect -u -a ${broadreplicates[0]} -b ${broadreplicates[1]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bedcorrelate/broadintersect.bed;\n\tbedtools intersect -u -a ${gappedreplicates[0]} -b ${gappedreplicates[1]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bedcorrelate/gappedintersect.bed;\n\tbedtools intersect -u -a ${narrowreplicates[0]} -b ${narrowreplicates[1]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bedcorrelate/narrowintersect.bed;\n\tbedtools intersect -u -a ${broadreplicates[1]} -b ${broadreplicates[0]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bedcorrelate/broadintersect2.bed;\n\tbedtools intersect -u -a ${gappedreplicates[1]} -b ${gappedreplicates[0]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bedcorrelate/gappedintersect2.bed;\n\tbedtools intersect -u -a ${narrowreplicates[1]} -b ${narrowreplicates[0]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bedcorrelate/narrowintersect2.bed;\n\t###\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bedcorrelate/broadintersect.bed|wc -l ) \"/\" $(cat ${broadreplicates[0]} |wc -l ) \") *100\"|bc >/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bedcorrelate/broadintersect.txt;\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bedcorrelate/gappedintersect.bed|wc -l ) \"/\" $(cat ${gappedreplicates[0]} |wc -l ) \") *100\"|bc >/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bedcorrelate/gappedintersect.txt;\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bedcorrelate/narrowintersect.bed|wc -l ) \"/\" $(cat ${narrowreplicates[0]} |wc -l ) \") *100\"|bc >/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bedcorrelate/narrowintersect.txt;\n\t###\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bedcorrelate/broadintersect2.bed|wc -l ) \"/\" $(cat ${broadreplicates[1]} |wc -l ) \") *100\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bedcorrelate/broadintersect.txt;\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bedcorrelate/gappedintersect2.bed|wc -l ) \"/\" $(cat ${gappedreplicates[1]} |wc -l ) \") *100\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bedcorrelate/gappedintersect.txt;\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bedcorrelate/narrowintersect2.bed|wc -l ) \"/\" $(cat ${narrowreplicates[1]} |wc -l ) \") *100\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bedcorrelate/narrowintersect.txt;\n\t###\n\techo \"scale=4;((\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bedcorrelate/broadintersect.bed|wc -l ) \"/\" $(cat ${broadreplicates[0]} |wc -l ) \")+(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bedcorrelate/broadintersect2.bed|wc -l ) \"/\" $(cat ${broadreplicates[1]} |wc -l ) \")) *50\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bedcorrelate/broadintersect.txt;\n\techo \"scale=4;((\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bedcorrelate/gappedintersect.bed|wc -l ) \"/\" $(cat ${gappedreplicates[0]} |wc -l ) \")+(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bedcorrelate/gappedintersect2.bed|wc -l ) \"/\" $(cat ${gappedreplicates[1]} |wc -l ) \")) *50\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bedcorrelate/gappedintersect.txt;\n\techo \"scale=4;((\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bedcorrelate/narrowintersect.bed|wc -l ) \"/\" $(cat ${narrowreplicates[0]} |wc -l ) \")+(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bedcorrelate/narrowintersect2.bed|wc -l ) \"/\" $(cat ${narrowreplicates[1]} |wc -l ) \")) *50\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bedcorrelate/narrowintersect.txt; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bedcorrelate/err"
    condition: groupby
    condition_params: 
      - replicate
    cores: 4
    mem: 5000
    placeholders: 
      - bedcorrelate
      - groupby.replicate.macsunmergedbroadpeak.ChIPseqout_peaks.broadPeak
      - groupby.replicate.macsunmergedbroadpeak.ChIPseqout_peaks.gappedPeak
      - groupby.replicate.macsunmergednarrowpeak.ChIPseqout_peaks.narrowPeak
      - bedcorrelate.broadintersect.bed
      - bedcorrelate.gappedintersect.bed
      - bedcorrelate.narrowintersect.bed
      - bedcorrelate.broadintersect2.bed
      - bedcorrelate.gappedintersect2.bed
      - bedcorrelate.narrowintersect2.bed
      - bedcorrelate.broadintersect.bed
      - bedcorrelate.broadintersect.txt
      - bedcorrelate.gappedintersect.bed
      - bedcorrelate.gappedintersect.txt
      - bedcorrelate.narrowintersect.bed
      - bedcorrelate.narrowintersect.txt
      - bedcorrelate.broadintersect2.bed
      - bedcorrelate.broadintersect.txt
      - bedcorrelate.gappedintersect2.bed
      - bedcorrelate.gappedintersect.txt
      - bedcorrelate.narrowintersect2.bed
      - bedcorrelate.narrowintersect.txt
      - bedcorrelate.broadintersect.bed
      - bedcorrelate.broadintersect2.bed
      - bedcorrelate.broadintersect.txt
      - bedcorrelate.gappedintersect.bed
      - bedcorrelate.gappedintersect2.bed
      - bedcorrelate.gappedintersect.txt
      - bedcorrelate.narrowintersect.bed
      - bedcorrelate.narrowintersect2.bed
      - bedcorrelate.narrowintersect.txt
      - bedcorrelate.err
  bowtie: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bowtie;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tls /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_build/touch /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_buildcast/touch;\n\tif [ PE == \"PE\" ];\n\t\tthen /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/bowtierun -p PE -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/trimgalore/out_1_val_1.fq.gz -2 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/trimgalore/out_2_val_2.fq.gz -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bowtie/out.sam -s C57BL6J;\n\telse /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/bowtierun -p PE -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/trimgalore/out_1_val_1.fq.gz -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bowtie/out.sam -s C57BL6J;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bowtie/err"
    condition: ~
    cores: 14
    mem: 7000
    placeholders: 
      - bowtie
      - bowtie_build.touch
      - bowtie_buildcast.touch
      - datasource.SE_PE
      - software.bowtierun
      - datasource.SE_PE
      - trimgalore.output2
      - trimgalore.output4
      - bowtie.out.sam
      - datasource.Strain
      - software.bowtierun
      - datasource.SE_PE
      - trimgalore.output2
      - bowtie.out.sam
      - datasource.Strain
      - bowtie.err
  bowtieinp: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bowtieinp;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tls /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_build/touch /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_buildcast/touch;\n\tif [ PE == \"PE\" ];\n\t\tthen /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/bowtierun -p PE -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/trimgaloreinp/out_1_val_1.fq.gz -2 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/trimgaloreinp/out_2_val_2.fq.gz -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bowtieinp/out.sam -s C57BL6J;\n\telse /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/bowtierun -p PE -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/trimgaloreinp/out_1_val_1.fq.gz -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bowtieinp/out.sam -s C57BL6J;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bowtieinp/err"
    condition: ~
    cores: 14
    mem: 7000
    placeholders: 
      - bowtieinp
      - bowtie_build.touch
      - bowtie_buildcast.touch
      - datasource.SE_PE
      - software.bowtierun
      - datasource.SE_PE
      - trimgaloreinp.output2
      - trimgaloreinp.output4
      - bowtieinp.out.sam
      - datasource.Strain
      - software.bowtierun
      - datasource.SE_PE
      - trimgaloreinp.output2
      - bowtieinp.out.sam
      - datasource.Strain
      - bowtieinp.err
  fastquality: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/fastquality;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tgunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/trimgalore/out_1_val_1.fq.gz | fastx_quality_stats -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/fastquality/out1;\n\tfastq_quality_boxplot_graph.sh -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/fastquality/out1 -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/fastquality/out1.png -t BM_T_20M_R_read1;\n\tgunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/trimgaloreinp/out_1_val_1.fq.gz | fastx_quality_stats -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/fastquality/Inpout1;\n\tfastq_quality_boxplot_graph.sh -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/fastquality/Inpout1 -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/fastquality/Inpout1.png -t BM_T_20M_R_input_read1;\n\tif [ PE == \"PE\" ];\n\tthen gunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/trimgalore/out_2_val_2.fq.gz | fastx_quality_stats -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/fastquality/out2;\n\t\tfastq_quality_boxplot_graph.sh -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/fastquality/out2 -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/fastquality/out2.png -t BM_T_20M_R_read2;\n\t\tgunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/trimgaloreinp/out_2_val_2.fq.gz | fastx_quality_stats -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/fastquality/Inpout2;\n\t\tfastq_quality_boxplot_graph.sh -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/fastquality/Inpout2 -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/fastquality/Inpout2.png -t BM_T_20M_R_input_read2;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/fastquality/err"
    condition: ~
    mem: 50
    placeholders: 
      - fastquality
      - trimgalore.output2
      - fastquality.out1
      - fastquality.out1
      - fastquality.out1.png
      - datasource.Name
      - trimgaloreinp.output2
      - fastquality.Inpout1
      - fastquality.Inpout1
      - fastquality.Inpout1.png
      - datasource.Name
      - datasource.SE_PE
      - trimgalore.output4
      - fastquality.out2
      - fastquality.out2
      - fastquality.out2.png
      - datasource.Name
      - trimgaloreinp.output4
      - fastquality.Inpout2
      - fastquality.Inpout2
      - fastquality.Inpout2.png
      - datasource.Name
      - fastquality.err
  macsmergedbroad: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergedbroad;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tlast=$(tail -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bedcorrelate/broadintersect.txt);\n\tint=${last%.*};\n\tif [ $int -gt 75 ];\n\t\tthen macs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -q 0.01 --broad --broad-cutoff 0.1 --fix-bimodal --extsize 250 --keep-dup auto;\n\t\t###\n\t\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergedbroad/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergedbroad/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergedbroad/FoldE.bdg -m FE\";\n\t\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergedbroad/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergedbroad/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergedbroad/FoldE.bdg -m FE;\n\t\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergedbroad/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergedbroad/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergedbroad/logLR.bdg -m logLR -p 0.00001\";\n\t\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergedbroad/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergedbroad/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergedbroad/logLR.bdg -m logLR -p 0.00001;\n\t\t###\n\t\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergedbroad/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\t\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergedbroad/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergedbroad/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\t\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergedbroad/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t\t###\n\t\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergedbroad/ChIPseqout_model.r;\n\t\tbroadpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergedbroad/ChIPseqout_peaks.broadPeak broadout;\n\t\tgappedpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergedbroad/ChIPseqout_peaks.gappedPeak gappedout;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergedbroad/err"
    condition: groupby
    condition_params: 
      - replicate
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.broadPeak
      - ChIPseqout_peaks.gappedPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
    placeholders: 
      - macsmergedbroad
      - datasource.SE_PE
      - bedcorrelate.broadintersect.txt
      - groupby.replicate.samtoolsview.out.sorted.bam
      - groupby.replicate.samtoolsviewInp.out.sorted.bam
      - datasource.sonication
      - macsmergedbroad.output4
      - macsmergedbroad.output5
      - macsmergedbroad.FoldE.bdg
      - macsmergedbroad.output4
      - macsmergedbroad.output5
      - macsmergedbroad.FoldE.bdg
      - macsmergedbroad.output4
      - macsmergedbroad.output5
      - macsmergedbroad.logLR.bdg
      - macsmergedbroad.output4
      - macsmergedbroad.output5
      - macsmergedbroad.logLR.bdg
      - macsmergedbroad.FoldE.bdg
      - input.mm10.len
      - macsmergedbroad.FoldE.bdg
      - input.mm10.len
      - macsmergedbroad.logLR.bdg
      - input.mm10.len
      - macsmergedbroad.logLR.bdg
      - input.mm10.len
      - macsmergedbroad.output3
      - macsmergedbroad.output1
      - macsmergedbroad.output2
      - macsmergedbroad.err
  macsmergednarrow: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergednarrow;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tlast=$(tail -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bedcorrelate/narrowintersect.txt);\n\tint=${last%.*};\n\tif [ $int -gt 75 ];\n\t\tthen macs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -q 0.01 --fix-bimodal --extsize 250 --keep-dup auto;\n\t\t###\n\t\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergednarrow/ChIPseqout_control_lambda.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergednarrow/FoldE.bw -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergednarrow/FoldE.bdg -m FE\";\n\t\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergednarrow/ChIPseqout_control_lambda.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergednarrow/FoldE.bw -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergednarrow/FoldE.bdg -m FE;\n\t\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergednarrow/ChIPseqout_control_lambda.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergednarrow/FoldE.bw -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergednarrow/logLR.bdg -m logLR -p 0.00001\";\n\t\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergednarrow/ChIPseqout_control_lambda.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergednarrow/FoldE.bw -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergednarrow/logLR.bdg -m logLR -p 0.00001;\n\t\t###\n\t\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergednarrow/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\t\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergednarrow/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergednarrow/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\t\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergednarrow/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t\t###\n\t\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergednarrow/ChIPseqout_model.r;\n\t\tnarrowpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergednarrow/ChIPseqout_peaks.narrowPeak narrowout;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsmergednarrow/err"
    condition: groupby
    condition_params: 
      - replicate
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.narrowPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
    placeholders: 
      - macsmergednarrow
      - datasource.SE_PE
      - bedcorrelate.narrowintersect.txt
      - groupby.replicate.samtoolsview.out.sorted.bam
      - groupby.replicate.samtoolsviewInp.out.sorted.bam
      - datasource.sonication
      - macsmergednarrow.output4
      - macsmergednarrow.output5
      - macsmergednarrow.FoldE.bdg
      - macsmergednarrow.output4
      - macsmergednarrow.output5
      - macsmergednarrow.FoldE.bdg
      - macsmergednarrow.output4
      - macsmergednarrow.output5
      - macsmergednarrow.logLR.bdg
      - macsmergednarrow.output4
      - macsmergednarrow.output5
      - macsmergednarrow.logLR.bdg
      - macsmergednarrow.FoldE.bdg
      - input.mm10.len
      - macsmergednarrow.FoldE.bdg
      - input.mm10.len
      - macsmergednarrow.logLR.bdg
      - input.mm10.len
      - macsmergednarrow.logLR.bdg
      - input.mm10.len
      - macsmergednarrow.output2
      - macsmergednarrow.output1
      - macsmergednarrow.err
  macsunmerged: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmerged;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; \tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tmacs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -p 1 --fix-bimodal --extsize 250 --keep-dup auto; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmerged/err"
    condition: ~
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.narrowPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
    placeholders: 
      - macsunmerged
      - datasource.SE_PE
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.sonication
      - macsunmerged.err
  macsunmergedbroadpeak: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergedbroadpeak;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; ls * | grep -v err | xargs rm -rf;\t. /nfs/users/nfs_r/rg12/.bashrc;\n\ttrap SomeErrorHandler ERR;\n\tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tmacs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -q 0.05 --broad --broad-cutoff 0.1 --fix-bimodal --extsize 250 --keep-dup auto;\n\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergedbroadpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergedbroadpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergedbroadpeak/FoldE.bdg -m FE\";\n\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergedbroadpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergedbroadpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergedbroadpeak/FoldE.bdg -m FE;\n\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergedbroadpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergedbroadpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergedbroadpeak/logLR.bdg -m logLR -p 0.00001\";\n\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergedbroadpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergedbroadpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergedbroadpeak/logLR.bdg -m logLR -p 0.00001;\n\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergedbroadpeak/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergedbroadpeak/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergedbroadpeak/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergedbroadpeak/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t>&2 echo \"Rscript\";\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergedbroadpeak/ChIPseqout_model.r;\n\tbroadpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergedbroadpeak/ChIPseqout_peaks.broadPeak broadout;\n\tgappedpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak gappedout;\n\tbedtools genomecov -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergedbroadpeak/ChIPseqout_peaks.broadPeak -g /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len -bg > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergedbroadpeak/broad.bdg;\n\tbedtools genomecov -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak -g /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len -bg > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergedbroadpeak/gapped.bdg; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergedbroadpeak/err"
    condition: ~
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.broadPeak
      - ChIPseqout_peaks.gappedPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
    placeholders: 
      - macsunmergedbroadpeak
      - datasource.SE_PE
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.sonication
      - macsunmergedbroadpeak.output4
      - macsunmergedbroadpeak.output5
      - macsunmergedbroadpeak.FoldE.bdg
      - macsunmergedbroadpeak.output4
      - macsunmergedbroadpeak.output5
      - macsunmergedbroadpeak.FoldE.bdg
      - macsunmergedbroadpeak.output4
      - macsunmergedbroadpeak.output5
      - macsunmergedbroadpeak.logLR.bdg
      - macsunmergedbroadpeak.output4
      - macsunmergedbroadpeak.output5
      - macsunmergedbroadpeak.logLR.bdg
      - macsunmergedbroadpeak.FoldE.bdg
      - input.mm10.len
      - macsunmergedbroadpeak.FoldE.bdg
      - input.mm10.len
      - macsunmergedbroadpeak.logLR.bdg
      - input.mm10.len
      - macsunmergedbroadpeak.logLR.bdg
      - input.mm10.len
      - macsunmergedbroadpeak.output3
      - macsunmergedbroadpeak.output1
      - macsunmergedbroadpeak.output2
      - macsunmergedbroadpeak.output1
      - input.mm10.len
      - macsunmergedbroadpeak.broad.bdg
      - macsunmergedbroadpeak.output2
      - input.mm10.len
      - macsunmergedbroadpeak.gapped.bdg
      - macsunmergedbroadpeak.err
  macsunmergednarrowpeak: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergednarrowpeak;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; ls * | grep -v err | xargs rm -rf;\t. /nfs/users/nfs_r/rg12/.bashrc;\n\ttrap SomeErrorHandler ERR;\n\tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tmacs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -q 0.01 --fix-bimodal --extsize 250 --keep-dup auto;\n\t###\n\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergednarrowpeak/FoldE.bdg -m FE\";\n\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergednarrowpeak/FoldE.bdg -m FE;\n\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergednarrowpeak/logLR.bdg -m logLR -p 0.00001\";\n\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergednarrowpeak/logLR.bdg -m logLR -p 0.00001;\n\t###\n\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergednarrowpeak/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergednarrowpeak/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergednarrowpeak/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergednarrowpeak/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t###\n\t>&2 echo \"Rscript\";\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergednarrowpeak/ChIPseqout_model.r;\n\tnarrowpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak narrowout;\n\t###\n\tbgzip /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg;\n\tbgzip /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg;\n\ttabix -p bed /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg.gz;\n\ttabix -p bed /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg.gz;\n\tbedtools genomecov -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak -g /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len -bg > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergednarrowpeak/narrow.bdg; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergednarrowpeak/err"
    condition: ~
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.narrowPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
      - ChIPseqout_treat_pileup.bdg.gz
      - ChIPseqout_control_lambda.bdg.gz
      - ChIPseqout_treat_pileup.bdg.gz.tbi
      - ChIPseqout_control_lambda.bdg.gz.tbi
    placeholders: 
      - macsunmergednarrowpeak
      - datasource.SE_PE
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.sonication
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.FoldE.bdg
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.FoldE.bdg
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.logLR.bdg
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.logLR.bdg
      - macsunmergednarrowpeak.FoldE.bdg
      - input.mm10.len
      - macsunmergednarrowpeak.FoldE.bdg
      - input.mm10.len
      - macsunmergednarrowpeak.logLR.bdg
      - input.mm10.len
      - macsunmergednarrowpeak.logLR.bdg
      - input.mm10.len
      - macsunmergednarrowpeak.output2
      - macsunmergednarrowpeak.output1
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.output7
      - macsunmergednarrowpeak.output8
      - macsunmergednarrowpeak.output1
      - input.mm10.len
      - macsunmergednarrowpeak.narrow.bdg
      - macsunmergednarrowpeak.err
  pie: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/pie;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; ls * | grep -v err | xargs rm -rf;\t. /nfs/users/nfs_r/rg12/.bashrc;\n\ttrap SomeErrorHandler ERR;\n\t#gapped broad output\n\tbedtools intersect -loj -a /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak -b /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/ens_genes_and_promoter_distal.bed > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/pie/out;\n\tbedtools intersect -loj -a /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak -b /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/ens_genes_and_promoter_distal.bed > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/pie/out2;\n\tbedtools intersect -wa -b /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak -a /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/ens_genes_and_promoter_distal.bed > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/pie/out3;\n\tbedtools intersect -wa -b /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak -a /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/ens_genes_and_promoter_distal.bed > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/pie/out4;\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/pie.R $(grep -c Gene /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/pie/out) $(grep -c Distal /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/pie/out) $(grep -c Promoter /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/pie/out) $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/pie/out |wc -l) rplot_broad.pdf > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/pie/broad\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/pie.R $(grep -c Gene /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/pie/out2) $(grep -c Distal /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/pie/out2) $(grep -c Promoter /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/pie/out2) $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/pie/out2 |wc -l) rplot_narrow.pdf > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/pie/narrow\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/pie.R $(grep -c Gene /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/pie/out3) $(grep -c Distal /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/pie/out3) $(grep -c Promoter /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/pie/out3) $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/pie/out3 |wc -l) rplot_gene_broad.pdf > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/pie/gene_broad\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/pie.R $(grep -c Gene /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/pie/out4) $(grep -c Distal /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/pie/out4) $(grep -c Promoter /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/pie/out4) $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/pie/out4 |wc -l) rplot_gene_narrow.pdf > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/pie/gene_narrow 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/pie/err"
    condition: ~
    mem: 5000
    placeholders: 
      - pie
      - macsunmergedbroadpeak.output2
      - input.ens_genes_and_promoter_distal.bed
      - pie.out
      - macsunmergednarrowpeak.output1
      - input.ens_genes_and_promoter_distal.bed
      - pie.out2
      - macsunmergedbroadpeak.output2
      - input.ens_genes_and_promoter_distal.bed
      - pie.out3
      - macsunmergednarrowpeak.output1
      - input.ens_genes_and_promoter_distal.bed
      - pie.out4
      - software.pie.R
      - pie.out
      - pie.out
      - pie.out
      - pie.out
      - pie.broad
      - software.pie.R
      - pie.out2
      - pie.out2
      - pie.out2
      - pie.out2
      - pie.narrow
      - software.pie.R
      - pie.out3
      - pie.out3
      - pie.out3
      - pie.out3
      - pie.gene_broad
      - software.pie.R
      - pie.out4
      - pie.out4
      - pie.out4
      - pie.out4
      - pie.gene_narrow
      - pie.err
  samtoolsview: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/samtoolsview;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\ttest -e /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bowtie/out.sam;\n\tsamtools view -hSb /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bowtie/out.sam> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/samtoolsview/out.bam;\n\tsamtools sort /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/samtoolsview/out.bam out.sorted;\n\tsamtools index /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/samtoolsview/out.sorted.bam;\n\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bowtie/out.sam; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/samtoolsview/err"
    condition: ~
    mem: 2000
    outputfiles: 
      - out.sorted.bam
      - out.sorted.bam.bai
    placeholders: 
      - samtoolsview
      - bowtie.out.sam
      - bowtie.out.sam
      - samtoolsview.out.bam
      - samtoolsview.out.bam
      - samtoolsview.output1
      - bowtie.out.sam
      - samtoolsview.err
  samtoolsviewInp: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/samtoolsviewInp;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\ttest -e /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bowtieinp/out.sam;\n\tsamtools view -hSb /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bowtieinp/out.sam > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/samtoolsviewInp/out.bam;\n\tsamtools sort /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/samtoolsviewInp/out.bam out.sorted;\n\tsamtools index /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/samtoolsviewInp/out.sorted.bam;\n\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bowtieinp/out.sam; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/samtoolsviewInp/err"
    condition: ~
    mem: 2000
    outputfiles: 
      - out.sorted.bam
      - out.sorted.bam.bai
    placeholders: 
      - samtoolsviewInp
      - bowtieinp.out.sam
      - bowtieinp.out.sam
      - samtoolsviewInp.out.bam
      - samtoolsviewInp.out.bam
      - samtoolsviewInp.output1
      - bowtieinp.out.sam
      - samtoolsviewInp.err
  seperateclusters: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/seperateclusters;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\tls * | grep -v err | xargs rm -rf;\n\ttrap SomeErrorHandler ERR;\n\tclusters=4;\n\tcp /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/annotatepeaksgroup/cluster.4.RData /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/seperateclusters/clusters.RData;\n\tExtractGName.R /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/seperateclusters/clusters.RData;\n\t>&2 echo \"cluster1-4\";\n\tfor i in {1..4}\n\tdo\n\t\t>&2 echo \"cluster\" ${i};\n\t\techo -e \"/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/samtoolsviewInp/out.sorted.bam\tclusters.1.cluster${i}.txt\t\\\"H4K20me3 T Cell\\\"\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/seperateclusters/config.txt;\n\t\t>&2 echo \"ngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/seperateclusters/config.txt -O heatmapclusters.${i} -L 5000 -GO total -CO blue:white:red -P 5\";\n\t\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/seperateclusters/config.txt -O heatmapclusters.${i} -L 3000 -GO total -CO blue:white:red -P 5;\n\t\tconvert -density 150 heatmapclusters.${i}.heatmap.pdf -quality 90 heatmapclusters.${i}.heatmap.png;\n\tdone 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/seperateclusters/err"
    condition: ~
    cores: 5
    mem: 5000
    placeholders: 
      - seperateclusters
      - annotatepeaksgroup.output1
      - seperateclusters.clusters.RData
      - seperateclusters.clusters.RData
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.mark_full
      - datasource.Cell
      - seperateclusters.config.txt
      - seperateclusters.config.txt
      - seperateclusters.config.txt
      - seperateclusters.err
  summarystats: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/summarystats;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;trap SomeErrorHandler ERR;\tif [ PE == \"PE\" ];\n\t\tthen if [ TRUE == \"TRUE\" ];\n\t\t\tthen echo \"BM_T_20M_R_lane1\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_20M_R/BM_T_20M_R_1.bam >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/summarystats/out.flagstat;\n\t\t\techo \"BM_T_20M_R_lane2\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_20M_R/BM_T_20M_R_2.bam >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/summarystats/out.flagstat;\n\t\telse echo \"BM_T_20M_R\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/summarystats/out.flagstat;\n\t\t\techo \"FastQ\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/summarystats/out.flagstat;\n\t\tfi;\n\t\tif [ TRUE == \"TRUE\" ];\n\t\t\tthen echo \"Inp_BM_T_20M_R_lane1\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_INP_R/BM_T_INP_R_1.bam >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/summarystats/out.flagstat;\n\t\t\techo \"Inp_BM_T_20M_R_lane2\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_INP_R/BM_T_INP_R_2.bam >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/summarystats/out.flagstat;\n\t\telse echo \"Inp_BM_T_20M_R\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/summarystats/out.flagstat;\n\t\t\techo \"FastQ\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/summarystats/out.flagstat;\n\t\tfi;\n\telse if [ TRUE == \"TRUE\" ]; ### CHECK THIS!! SHOULD be INP_1 and INP_2\n\t\tthen echo \"BM_T_20M_R_lane1\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_20M_R/BM_T_20M_R_1.bam >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/summarystats/out.flagstat;\n\t\t\techo \"BM_T_20M_R_lane2\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_20M_R/BM_T_20M_R_2.bam >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/summarystats/out.flagstat;\n\t\telse echo \"BM_T_20M_R\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/summarystats/out.flagstat;\n\t\t\techo \"FastQ\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/summarystats/out.flagstat;\n\t\tfi;\n\t\tif [ TRUE == \"TRUE\" ];\n\t\t\tthen echo \"Inp_BM_T_20M_R_lane1\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_INP_R/BM_T_INP_R_1.bam >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/summarystats/out.flagstat;\n\t\t\techo \"Inp_BM_T_20M_R_lane2\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_INP_R/BM_T_INP_R_2.bam >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/summarystats/out.flagstat;\n\t\telse echo \"Inp_BM_T_20M_R\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/summarystats/out.flagstat;\n\t\t\techo \"FastQ\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/summarystats/out.flagstat;\n\t\tfi;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/summarystats/err"
    condition: ~
    mem: 1000
    placeholders: 
      - summarystats
      - datasource.SE_PE
      - datasource.bam
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - summarystats.out.flagstat
      - datasource.Inp_bam
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.Inp_location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.Inp_location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - summarystats.out.flagstat
      - datasource.bam
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - summarystats.out.flagstat
      - datasource.Inp_bam
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.Inp_location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.Inp_location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - summarystats.out.flagstat
      - summarystats.err
  trimgalore: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/trimgalore;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tlength=$(gunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofq/out_1.fq.gz | head -2| tail -1 | wc -c);\n\tlength=$[length-11];\n\tif [ PE == \"PE\" ];\n\tthen\n\t\ttrim_galore --fastqc --gzip --length $length --paired -a CAGATCTG --stringency 4 --trim1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofq/out_1.fq.gz /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofq/out_2.fq.gz;\n\telse\n\t\ttrim_galore --fastqc --gzip --length $length -a CAGATCTG --stringency 4 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofq/out_1.fq.gz;\n\n\t\tmv out_1_trimmed.fq.gz out_1_val_1.fq.gz;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/trimgalore/err"
    condition: ~
    cores: 3
    mem: 2000
    outputfiles: 
      - out_1.fq.gz_trimming_report.txt
      - out_1_val_1.fq.gz
      - out_2.fq.gz_trimming_report.txt
      - out_2_val_2.fq.gz
      - out_1_val_1.html
      - out_1_val_1.zip
      - out_2_val_2.html
      - out_2_val_2.zip
    placeholders: 
      - trimgalore
      - bamtofq.out_1.fq.gz
      - datasource.SE_PE
      - datasource.Tag
      - bamtofq.out_1.fq.gz
      - bamtofq.out_2.fq.gz
      - datasource.Tag
      - bamtofq.out_1.fq.gz
      - trimgalore.err
  trimgaloreinp: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/trimgaloreinp;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tlength=$(gunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofqinp/out_1.fq.gz | head -2| tail -1 | wc -c);\n\tlength=$[length-11];\n\tif [ PE == \"PE\" ];\n\tthen\n\t\ttrim_galore --fastqc --gzip --length $length --paired -a TAGCTTGT --stringency 4 --trim1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofqinp/out_1.fq.gz /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofqinp/out_2.fq.gz;\n\telse\n\t\ttrim_galore --fastqc --gzip --length $length -a TAGCTTGT --stringency 4 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/bamtofqinp/out_1.fq.gz;\n\t\tmv out_1_trimmed.fq.gz out_1_val_1.fq.gz; ### should FIX\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/trimgaloreinp/err"
    condition: ~
    cores: 3
    mem: 2000
    outputfiles: 
      - out_1.fq.gz_trimming_report.txt
      - out_1_val_1.fq.gz
      - out_2.fq.gz_trimming_report.txt
      - out_2_val_2.fq.gz
      - out_1_val_1.html
      - out_1_val_1.zip
      - out_2_val_2.html
      - out_2_val_2.zip
    placeholders: 
      - trimgaloreinp
      - bamtofqinp.out_1.fq.gz
      - datasource.SE_PE
      - datasource.Inp_Tag
      - bamtofqinp.out_1.fq.gz
      - bamtofqinp.out_2.fq.gz
      - datasource.Inp_Tag
      - bamtofqinp.out_1.fq.gz
      - trimgaloreinp.err
  wigcorrelate: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/wigcorrelate;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tls /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/macsunmergedbroadpeak/FoldE.bw;\n\tlength=(/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmergedbroadpeak/FoldE.bw);\n\t#Change FoldE.bw to output16\n\tif [ ${#length[@]} != 1 ];\n\t\tthen\n\t\twigCorrelate /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job4/macsunmerged/FoldE.bw > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/wigcorrelate/out;\n\tfi; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job6/wigcorrelate/err"
    condition: groupby
    condition_params: 
      - replicate
    cores: 4
    mem: 5000
    placeholders: 
      - wigcorrelate
      - macsunmergedbroadpeak.output6
      - groupby.replicate.macsunmergedbroadpeak.FoldE.bw
      - groupby.replicate.macsunmerged.FoldE.bw
      - wigcorrelate.out
      - wigcorrelate.err
7: 
  annotatepeaks: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/annotatepeaks;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\tls * | grep -v err | xargs rm -rf;\n\ttrap SomeErrorHandler ERR;\n\tclusters=4\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/samtoolsviewInp/out.sorted.bam -T \"H3K36me3 T Cell\" -O out -L 3000 -GO km -KNC ${clusters} -CO blue:white:red -P 5 -FI 1;\n\t/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/ExtractGeneClusterings.r out;\n\tfor i in $(seq 1 ${clusters});\n\tdo\n\t\techo -e \"/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/samtoolsviewInp/out.sorted.bam\tout.cluster${i}.txt\t\\\"H3K36me3 T Cell Cluster${i}\\\"\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/annotatepeaks/config.txt;\n\tdone\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/annotatepeaks/config.txt -O clusters -L 3000 -GO hc -CO blue:white:red -P 5;\n\tcat > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/annotatepeaks/configB.txt << EOF\n/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/samtoolsviewInp/out.sorted.bam\t/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/B_ordered_TPM.txt\t\"H3K36me3 B cell\"\nEOF\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/annotatepeaks/configB.txt -O TPMorderedB -L 3000 -GO none -CO blue:white:red -P 5;\n\tcat > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/annotatepeaks/configT.txt << EOF\n/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/samtoolsviewInp/out.sorted.bam\t/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/T_ordered_TPM.txt\t\"H3K36me3 T cell\"\nEOF\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/annotatepeaks/configT.txt -O TPMorderedT -L 3000 -GO none -CO blue:white:red -P 5; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/annotatepeaks/err"
    condition: ~
    cores: 5
    mem: 5000
    placeholders: 
      - annotatepeaks
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.mark_full
      - datasource.Cell
      - software.ExtractGeneClusterings.r
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.mark_full
      - datasource.Cell
      - annotatepeaks.config.txt
      - annotatepeaks.config.txt
      - annotatepeaks.configB.txt
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - input.B_ordered_TPM.txt
      - datasource.mark_full
      - annotatepeaks.configB.txt
      - annotatepeaks.configT.txt
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - input.T_ordered_TPM.txt
      - datasource.mark_full
      - annotatepeaks.configT.txt
      - annotatepeaks.err
  annotatepeaksgroup: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/annotatepeaksgroup;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\tls * | grep -v err | xargs rm -rf;\n\ttrap SomeErrorHandler ERR;\n\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/samtoolsviewInp/out.sorted.bam -T \"H3K36me3 T Cell\" -O out -L 3000 -CO blue:white:red -P 5 -FI 0;\n\tfor clusters in {4..10};\n\t\tdo name=\"cluster.${clusters}\";\n\t\treplot.r heatmap -I out.zip -O ${name} -T \"H3K36me3 T Cell\" -L 3000 -GO km -KNC ${clusters} -CO blue:white:red -P 5;\n\t\tExtractGName.R ${name}.RData;\n\tdone 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/annotatepeaksgroup/err"
    condition: ~
    cores: 5
    mem: 5000
    outputfiles: 
      - cluster.4.RData
    placeholders: 
      - annotatepeaksgroup
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.mark_full
      - datasource.Cell
      - datasource.mark_full
      - datasource.Cell
      - annotatepeaksgroup.err
  bamtofq: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofq;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;trap SomeErrorHandler ERR;\tif [ TRUE == \"TRUE\" ];\n\t\tthen samtools sort /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_36M_R/BM_T_36M_R_1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofq/lane1;\n\t\tsamtools sort /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_36M_R/BM_T_36M_R_2.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofq/lane2;\n\t\tsamtools merge /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofq/merged.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofq/lane1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofq/lane2.bam;\n\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofq/lane1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofq/lane2.bam;\n\t\tif [ PE == \"PE\" ];\n\t\t\tthen\n\t\t\t\tbamtofastq filename=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofq/merged.bam gz=1 F=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofq/out_1.fq.gz F2=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofq/out_2.fq.gz;\n\t\t\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofq/merged.bam;\n\t\t\telse\n\t\t\t\tbamtofastq gz=1 filename=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofq/merged.bam > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofq/out_1.fq.gz;\n\t\t\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofq/merged.bam;\n\t\t\tfi;\n\t\telse\n\t\t\tcat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_36M_R/BM_T_36M_R* > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofq/out_1.fq.gz;\n\t\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofq/err"
    condition: ~
    mem: 1500
    placeholders: 
      - bamtofq
      - datasource.bam
      - datasource.location
      - bamtofq.lane1
      - datasource.location
      - bamtofq.lane2
      - bamtofq.merged.bam
      - bamtofq.lane1
      - bamtofq.lane2
      - bamtofq.lane1
      - bamtofq.lane2
      - datasource.SE_PE
      - bamtofq.merged.bam
      - bamtofq.out_1.fq.gz
      - bamtofq.out_2.fq.gz
      - bamtofq.merged.bam
      - bamtofq.merged.bam
      - bamtofq.out_1.fq.gz
      - bamtofq.merged.bam
      - datasource.location
      - bamtofq.out_1.fq.gz
      - bamtofq.err
  bamtofqinp: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofqinp;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;trap SomeErrorHandler ERR;\tif [ TRUE == \"TRUE\" ];\n\t\tthen samtools sort /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_INP_R/BM_T_INP_R_1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofqinp/lane1;\n\t\tsamtools sort /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_INP_R/BM_T_INP_R_2.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofqinp/lane2;\n\t\tsamtools merge /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofqinp/merged.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofqinp/lane1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofqinp/lane2.bam;\n\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofqinp/lane1.bam /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofqinp/lane2.bam;\n\t\tif [ PE == \"PE\" ];\n\t\t\tthen\n\t\t\t\tbamtofastq gz=1 filename=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofqinp/merged.bam F=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofqinp/out_1.fq.gz F2=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofqinp/out_2.fq.gz;\n\t\t\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofqinp/merged.bam;\n\t\t\telse bamtofastq gz=1 filename=/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofqinp/merged.bam > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofqinp/out_1.fq.gz;\n\t\t\t\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofqinp/merged.bam;\n\t\tfi;\n\telse cat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_INP_R/BM_T_INP_R* > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofqinp/out_1.fq.gz;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofqinp/err"
    condition: ~
    mem: 1500
    placeholders: 
      - bamtofqinp
      - datasource.Inp_bam
      - datasource.Inp_location
      - bamtofqinp.lane1
      - datasource.Inp_location
      - bamtofqinp.lane2
      - bamtofqinp.merged.bam
      - bamtofqinp.lane1
      - bamtofqinp.lane2
      - bamtofqinp.lane1
      - bamtofqinp.lane2
      - datasource.SE_PE
      - bamtofqinp.merged.bam
      - bamtofqinp.out_1.fq.gz
      - bamtofqinp.out_2.fq.gz
      - bamtofqinp.merged.bam
      - bamtofqinp.merged.bam
      - bamtofqinp.out_1.fq.gz
      - bamtofqinp.merged.bam
      - datasource.Inp_location
      - bamtofqinp.out_1.fq.gz
      - bamtofqinp.err
  bedcorrelate: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bedcorrelate;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tbroadreplicates=(/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergedbroadpeak/ChIPseqout_peaks.broadPeak);\n\tgappedreplicates=(/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak);\n\tnarrowreplicates=(/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak);\n\t###\n\tbedtools intersect -u -a ${broadreplicates[0]} -b ${broadreplicates[1]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bedcorrelate/broadintersect.bed;\n\tbedtools intersect -u -a ${gappedreplicates[0]} -b ${gappedreplicates[1]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bedcorrelate/gappedintersect.bed;\n\tbedtools intersect -u -a ${narrowreplicates[0]} -b ${narrowreplicates[1]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bedcorrelate/narrowintersect.bed;\n\tbedtools intersect -u -a ${broadreplicates[1]} -b ${broadreplicates[0]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bedcorrelate/broadintersect2.bed;\n\tbedtools intersect -u -a ${gappedreplicates[1]} -b ${gappedreplicates[0]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bedcorrelate/gappedintersect2.bed;\n\tbedtools intersect -u -a ${narrowreplicates[1]} -b ${narrowreplicates[0]} > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bedcorrelate/narrowintersect2.bed;\n\t###\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bedcorrelate/broadintersect.bed|wc -l ) \"/\" $(cat ${broadreplicates[0]} |wc -l ) \") *100\"|bc >/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bedcorrelate/broadintersect.txt;\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bedcorrelate/gappedintersect.bed|wc -l ) \"/\" $(cat ${gappedreplicates[0]} |wc -l ) \") *100\"|bc >/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bedcorrelate/gappedintersect.txt;\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bedcorrelate/narrowintersect.bed|wc -l ) \"/\" $(cat ${narrowreplicates[0]} |wc -l ) \") *100\"|bc >/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bedcorrelate/narrowintersect.txt;\n\t###\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bedcorrelate/broadintersect2.bed|wc -l ) \"/\" $(cat ${broadreplicates[1]} |wc -l ) \") *100\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bedcorrelate/broadintersect.txt;\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bedcorrelate/gappedintersect2.bed|wc -l ) \"/\" $(cat ${gappedreplicates[1]} |wc -l ) \") *100\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bedcorrelate/gappedintersect.txt;\n\techo \"scale=4;(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bedcorrelate/narrowintersect2.bed|wc -l ) \"/\" $(cat ${narrowreplicates[1]} |wc -l ) \") *100\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bedcorrelate/narrowintersect.txt;\n\t###\n\techo \"scale=4;((\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bedcorrelate/broadintersect.bed|wc -l ) \"/\" $(cat ${broadreplicates[0]} |wc -l ) \")+(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bedcorrelate/broadintersect2.bed|wc -l ) \"/\" $(cat ${broadreplicates[1]} |wc -l ) \")) *50\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bedcorrelate/broadintersect.txt;\n\techo \"scale=4;((\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bedcorrelate/gappedintersect.bed|wc -l ) \"/\" $(cat ${gappedreplicates[0]} |wc -l ) \")+(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bedcorrelate/gappedintersect2.bed|wc -l ) \"/\" $(cat ${gappedreplicates[1]} |wc -l ) \")) *50\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bedcorrelate/gappedintersect.txt;\n\techo \"scale=4;((\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bedcorrelate/narrowintersect.bed|wc -l ) \"/\" $(cat ${narrowreplicates[0]} |wc -l ) \")+(\" $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bedcorrelate/narrowintersect2.bed|wc -l ) \"/\" $(cat ${narrowreplicates[1]} |wc -l ) \")) *50\"|bc >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bedcorrelate/narrowintersect.txt; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bedcorrelate/err"
    condition: groupby
    condition_params: 
      - replicate
    cores: 4
    mem: 5000
    placeholders: 
      - bedcorrelate
      - groupby.replicate.macsunmergedbroadpeak.ChIPseqout_peaks.broadPeak
      - groupby.replicate.macsunmergedbroadpeak.ChIPseqout_peaks.gappedPeak
      - groupby.replicate.macsunmergednarrowpeak.ChIPseqout_peaks.narrowPeak
      - bedcorrelate.broadintersect.bed
      - bedcorrelate.gappedintersect.bed
      - bedcorrelate.narrowintersect.bed
      - bedcorrelate.broadintersect2.bed
      - bedcorrelate.gappedintersect2.bed
      - bedcorrelate.narrowintersect2.bed
      - bedcorrelate.broadintersect.bed
      - bedcorrelate.broadintersect.txt
      - bedcorrelate.gappedintersect.bed
      - bedcorrelate.gappedintersect.txt
      - bedcorrelate.narrowintersect.bed
      - bedcorrelate.narrowintersect.txt
      - bedcorrelate.broadintersect2.bed
      - bedcorrelate.broadintersect.txt
      - bedcorrelate.gappedintersect2.bed
      - bedcorrelate.gappedintersect.txt
      - bedcorrelate.narrowintersect2.bed
      - bedcorrelate.narrowintersect.txt
      - bedcorrelate.broadintersect.bed
      - bedcorrelate.broadintersect2.bed
      - bedcorrelate.broadintersect.txt
      - bedcorrelate.gappedintersect.bed
      - bedcorrelate.gappedintersect2.bed
      - bedcorrelate.gappedintersect.txt
      - bedcorrelate.narrowintersect.bed
      - bedcorrelate.narrowintersect2.bed
      - bedcorrelate.narrowintersect.txt
      - bedcorrelate.err
  bowtie: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bowtie;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tls /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_build/touch /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_buildcast/touch;\n\tif [ PE == \"PE\" ];\n\t\tthen /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/bowtierun -p PE -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/trimgalore/out_1_val_1.fq.gz -2 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/trimgalore/out_2_val_2.fq.gz -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bowtie/out.sam -s C57BL6J;\n\telse /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/bowtierun -p PE -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/trimgalore/out_1_val_1.fq.gz -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bowtie/out.sam -s C57BL6J;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bowtie/err"
    condition: ~
    cores: 14
    mem: 7000
    placeholders: 
      - bowtie
      - bowtie_build.touch
      - bowtie_buildcast.touch
      - datasource.SE_PE
      - software.bowtierun
      - datasource.SE_PE
      - trimgalore.output2
      - trimgalore.output4
      - bowtie.out.sam
      - datasource.Strain
      - software.bowtierun
      - datasource.SE_PE
      - trimgalore.output2
      - bowtie.out.sam
      - datasource.Strain
      - bowtie.err
  bowtieinp: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bowtieinp;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tls /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_build/touch /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job0/bowtie_buildcast/touch;\n\tif [ PE == \"PE\" ];\n\t\tthen /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/bowtierun -p PE -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/trimgaloreinp/out_1_val_1.fq.gz -2 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/trimgaloreinp/out_2_val_2.fq.gz -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bowtieinp/out.sam -s C57BL6J;\n\telse /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/bowtierun -p PE -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/trimgaloreinp/out_1_val_1.fq.gz -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bowtieinp/out.sam -s C57BL6J;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bowtieinp/err"
    condition: ~
    cores: 14
    mem: 7000
    placeholders: 
      - bowtieinp
      - bowtie_build.touch
      - bowtie_buildcast.touch
      - datasource.SE_PE
      - software.bowtierun
      - datasource.SE_PE
      - trimgaloreinp.output2
      - trimgaloreinp.output4
      - bowtieinp.out.sam
      - datasource.Strain
      - software.bowtierun
      - datasource.SE_PE
      - trimgaloreinp.output2
      - bowtieinp.out.sam
      - datasource.Strain
      - bowtieinp.err
  fastquality: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/fastquality;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tgunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/trimgalore/out_1_val_1.fq.gz | fastx_quality_stats -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/fastquality/out1;\n\tfastq_quality_boxplot_graph.sh -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/fastquality/out1 -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/fastquality/out1.png -t BM_T_36M_R_read1;\n\tgunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/trimgaloreinp/out_1_val_1.fq.gz | fastx_quality_stats -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/fastquality/Inpout1;\n\tfastq_quality_boxplot_graph.sh -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/fastquality/Inpout1 -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/fastquality/Inpout1.png -t BM_T_36M_R_input_read1;\n\tif [ PE == \"PE\" ];\n\tthen gunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/trimgalore/out_2_val_2.fq.gz | fastx_quality_stats -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/fastquality/out2;\n\t\tfastq_quality_boxplot_graph.sh -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/fastquality/out2 -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/fastquality/out2.png -t BM_T_36M_R_read2;\n\t\tgunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/trimgaloreinp/out_2_val_2.fq.gz | fastx_quality_stats -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/fastquality/Inpout2;\n\t\tfastq_quality_boxplot_graph.sh -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/fastquality/Inpout2 -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/fastquality/Inpout2.png -t BM_T_36M_R_input_read2;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/fastquality/err"
    condition: ~
    mem: 50
    placeholders: 
      - fastquality
      - trimgalore.output2
      - fastquality.out1
      - fastquality.out1
      - fastquality.out1.png
      - datasource.Name
      - trimgaloreinp.output2
      - fastquality.Inpout1
      - fastquality.Inpout1
      - fastquality.Inpout1.png
      - datasource.Name
      - datasource.SE_PE
      - trimgalore.output4
      - fastquality.out2
      - fastquality.out2
      - fastquality.out2.png
      - datasource.Name
      - trimgaloreinp.output4
      - fastquality.Inpout2
      - fastquality.Inpout2
      - fastquality.Inpout2.png
      - datasource.Name
      - fastquality.err
  macsmergedbroad: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergedbroad;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tlast=$(tail -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bedcorrelate/broadintersect.txt);\n\tint=${last%.*};\n\tif [ $int -gt 75 ];\n\t\tthen macs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -q 0.01 --broad --broad-cutoff 0.1 --fix-bimodal --extsize 250 --keep-dup auto;\n\t\t###\n\t\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergedbroad/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergedbroad/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergedbroad/FoldE.bdg -m FE\";\n\t\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergedbroad/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergedbroad/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergedbroad/FoldE.bdg -m FE;\n\t\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergedbroad/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergedbroad/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergedbroad/logLR.bdg -m logLR -p 0.00001\";\n\t\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergedbroad/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergedbroad/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergedbroad/logLR.bdg -m logLR -p 0.00001;\n\t\t###\n\t\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergedbroad/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\t\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergedbroad/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergedbroad/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\t\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergedbroad/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t\t###\n\t\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergedbroad/ChIPseqout_model.r;\n\t\tbroadpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergedbroad/ChIPseqout_peaks.broadPeak broadout;\n\t\tgappedpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergedbroad/ChIPseqout_peaks.gappedPeak gappedout;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergedbroad/err"
    condition: groupby
    condition_params: 
      - replicate
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.broadPeak
      - ChIPseqout_peaks.gappedPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
    placeholders: 
      - macsmergedbroad
      - datasource.SE_PE
      - bedcorrelate.broadintersect.txt
      - groupby.replicate.samtoolsview.out.sorted.bam
      - groupby.replicate.samtoolsviewInp.out.sorted.bam
      - datasource.sonication
      - macsmergedbroad.output4
      - macsmergedbroad.output5
      - macsmergedbroad.FoldE.bdg
      - macsmergedbroad.output4
      - macsmergedbroad.output5
      - macsmergedbroad.FoldE.bdg
      - macsmergedbroad.output4
      - macsmergedbroad.output5
      - macsmergedbroad.logLR.bdg
      - macsmergedbroad.output4
      - macsmergedbroad.output5
      - macsmergedbroad.logLR.bdg
      - macsmergedbroad.FoldE.bdg
      - input.mm10.len
      - macsmergedbroad.FoldE.bdg
      - input.mm10.len
      - macsmergedbroad.logLR.bdg
      - input.mm10.len
      - macsmergedbroad.logLR.bdg
      - input.mm10.len
      - macsmergedbroad.output3
      - macsmergedbroad.output1
      - macsmergedbroad.output2
      - macsmergedbroad.err
  macsmergednarrow: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergednarrow;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tlast=$(tail -1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bedcorrelate/narrowintersect.txt);\n\tint=${last%.*};\n\tif [ $int -gt 75 ];\n\t\tthen macs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -q 0.01 --fix-bimodal --extsize 250 --keep-dup auto;\n\t\t###\n\t\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergednarrow/ChIPseqout_control_lambda.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergednarrow/FoldE.bw -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergednarrow/FoldE.bdg -m FE\";\n\t\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergednarrow/ChIPseqout_control_lambda.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergednarrow/FoldE.bw -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergednarrow/FoldE.bdg -m FE;\n\t\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergednarrow/ChIPseqout_control_lambda.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergednarrow/FoldE.bw -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergednarrow/logLR.bdg -m logLR -p 0.00001\";\n\t\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergednarrow/ChIPseqout_control_lambda.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergednarrow/FoldE.bw -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergednarrow/logLR.bdg -m logLR -p 0.00001;\n\t\t###\n\t\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergednarrow/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\t\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergednarrow/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergednarrow/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\t\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergednarrow/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t\t###\n\t\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergednarrow/ChIPseqout_model.r;\n\t\tnarrowpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergednarrow/ChIPseqout_peaks.narrowPeak narrowout;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsmergednarrow/err"
    condition: groupby
    condition_params: 
      - replicate
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.narrowPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
    placeholders: 
      - macsmergednarrow
      - datasource.SE_PE
      - bedcorrelate.narrowintersect.txt
      - groupby.replicate.samtoolsview.out.sorted.bam
      - groupby.replicate.samtoolsviewInp.out.sorted.bam
      - datasource.sonication
      - macsmergednarrow.output4
      - macsmergednarrow.output5
      - macsmergednarrow.FoldE.bdg
      - macsmergednarrow.output4
      - macsmergednarrow.output5
      - macsmergednarrow.FoldE.bdg
      - macsmergednarrow.output4
      - macsmergednarrow.output5
      - macsmergednarrow.logLR.bdg
      - macsmergednarrow.output4
      - macsmergednarrow.output5
      - macsmergednarrow.logLR.bdg
      - macsmergednarrow.FoldE.bdg
      - input.mm10.len
      - macsmergednarrow.FoldE.bdg
      - input.mm10.len
      - macsmergednarrow.logLR.bdg
      - input.mm10.len
      - macsmergednarrow.logLR.bdg
      - input.mm10.len
      - macsmergednarrow.output2
      - macsmergednarrow.output1
      - macsmergednarrow.err
  macsunmerged: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmerged;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; \tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tmacs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -p 1 --fix-bimodal --extsize 250 --keep-dup auto; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmerged/err"
    condition: ~
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.narrowPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
    placeholders: 
      - macsunmerged
      - datasource.SE_PE
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.sonication
      - macsunmerged.err
  macsunmergedbroadpeak: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergedbroadpeak;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; ls * | grep -v err | xargs rm -rf;\t. /nfs/users/nfs_r/rg12/.bashrc;\n\ttrap SomeErrorHandler ERR;\n\tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tmacs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -q 0.05 --broad --broad-cutoff 0.1 --fix-bimodal --extsize 250 --keep-dup auto;\n\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergedbroadpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergedbroadpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergedbroadpeak/FoldE.bdg -m FE\";\n\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergedbroadpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergedbroadpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergedbroadpeak/FoldE.bdg -m FE;\n\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergedbroadpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergedbroadpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergedbroadpeak/logLR.bdg -m logLR -p 0.00001\";\n\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergedbroadpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergedbroadpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergedbroadpeak/logLR.bdg -m logLR -p 0.00001;\n\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergedbroadpeak/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergedbroadpeak/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergedbroadpeak/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergedbroadpeak/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t>&2 echo \"Rscript\";\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergedbroadpeak/ChIPseqout_model.r;\n\tbroadpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergedbroadpeak/ChIPseqout_peaks.broadPeak broadout;\n\tgappedpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak gappedout;\n\tbedtools genomecov -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergedbroadpeak/ChIPseqout_peaks.broadPeak -g /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len -bg > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergedbroadpeak/broad.bdg;\n\tbedtools genomecov -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak -g /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len -bg > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergedbroadpeak/gapped.bdg; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergedbroadpeak/err"
    condition: ~
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.broadPeak
      - ChIPseqout_peaks.gappedPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
    placeholders: 
      - macsunmergedbroadpeak
      - datasource.SE_PE
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.sonication
      - macsunmergedbroadpeak.output4
      - macsunmergedbroadpeak.output5
      - macsunmergedbroadpeak.FoldE.bdg
      - macsunmergedbroadpeak.output4
      - macsunmergedbroadpeak.output5
      - macsunmergedbroadpeak.FoldE.bdg
      - macsunmergedbroadpeak.output4
      - macsunmergedbroadpeak.output5
      - macsunmergedbroadpeak.logLR.bdg
      - macsunmergedbroadpeak.output4
      - macsunmergedbroadpeak.output5
      - macsunmergedbroadpeak.logLR.bdg
      - macsunmergedbroadpeak.FoldE.bdg
      - input.mm10.len
      - macsunmergedbroadpeak.FoldE.bdg
      - input.mm10.len
      - macsunmergedbroadpeak.logLR.bdg
      - input.mm10.len
      - macsunmergedbroadpeak.logLR.bdg
      - input.mm10.len
      - macsunmergedbroadpeak.output3
      - macsunmergedbroadpeak.output1
      - macsunmergedbroadpeak.output2
      - macsunmergedbroadpeak.output1
      - input.mm10.len
      - macsunmergedbroadpeak.broad.bdg
      - macsunmergedbroadpeak.output2
      - input.mm10.len
      - macsunmergedbroadpeak.gapped.bdg
      - macsunmergedbroadpeak.err
  macsunmergednarrowpeak: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergednarrowpeak;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; ls * | grep -v err | xargs rm -rf;\t. /nfs/users/nfs_r/rg12/.bashrc;\n\ttrap SomeErrorHandler ERR;\n\tif [ PE == \"PE\" ]; then paired=\"BAMPE\";else paired=\"BAM\";fi;\n\tmacs2 callpeak -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/samtoolsview/out.sorted.bam -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/samtoolsviewInp/out.sorted.bam -f $paired -g mm -n ChIPseqout -B --SPMR -q 0.01 --fix-bimodal --extsize 250 --keep-dup auto;\n\t###\n\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergednarrowpeak/FoldE.bdg -m FE\";\n\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergednarrowpeak/FoldE.bdg -m FE;\n\t>&2 echo \"macs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergednarrowpeak/logLR.bdg -m logLR -p 0.00001\";\n\tmacs2 bdgcmp -t /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg -o /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergednarrowpeak/logLR.bdg -m logLR -p 0.00001;\n\t###\n\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergednarrowpeak/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergednarrowpeak/FoldE.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t>&2 echo \"bdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergednarrowpeak/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len\";\n\tbdg2bw /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergednarrowpeak/logLR.bdg /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len;\n\t###\n\t>&2 echo \"Rscript\";\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergednarrowpeak/ChIPseqout_model.r;\n\tnarrowpeak.py /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak narrowout;\n\t###\n\tbgzip /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg;\n\tbgzip /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg;\n\ttabix -p bed /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergednarrowpeak/ChIPseqout_treat_pileup.bdg.gz;\n\ttabix -p bed /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergednarrowpeak/ChIPseqout_control_lambda.bdg.gz;\n\tbedtools genomecov -i /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak -g /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/mm10.len -bg > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergednarrowpeak/narrow.bdg; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergednarrowpeak/err"
    condition: ~
    cores: 5
    mem: 5000
    outputfiles: 
      - ChIPseqout_peaks.narrowPeak
      - ChIPseqout_model.r
      - ChIPseqout_treat_pileup.bdg
      - ChIPseqout_control_lambda.bdg
      - FoldE.bw
      - logLR.bw
      - ChIPseqout_treat_pileup.bdg.gz
      - ChIPseqout_control_lambda.bdg.gz
      - ChIPseqout_treat_pileup.bdg.gz.tbi
      - ChIPseqout_control_lambda.bdg.gz.tbi
    placeholders: 
      - macsunmergednarrowpeak
      - datasource.SE_PE
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.sonication
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.FoldE.bdg
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.FoldE.bdg
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.logLR.bdg
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.logLR.bdg
      - macsunmergednarrowpeak.FoldE.bdg
      - input.mm10.len
      - macsunmergednarrowpeak.FoldE.bdg
      - input.mm10.len
      - macsunmergednarrowpeak.logLR.bdg
      - input.mm10.len
      - macsunmergednarrowpeak.logLR.bdg
      - input.mm10.len
      - macsunmergednarrowpeak.output2
      - macsunmergednarrowpeak.output1
      - macsunmergednarrowpeak.output3
      - macsunmergednarrowpeak.output4
      - macsunmergednarrowpeak.output7
      - macsunmergednarrowpeak.output8
      - macsunmergednarrowpeak.output1
      - input.mm10.len
      - macsunmergednarrowpeak.narrow.bdg
      - macsunmergednarrowpeak.err
  pie: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/pie;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; ls * | grep -v err | xargs rm -rf;\t. /nfs/users/nfs_r/rg12/.bashrc;\n\ttrap SomeErrorHandler ERR;\n\t#gapped broad output\n\tbedtools intersect -loj -a /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak -b /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/ens_genes_and_promoter_distal.bed > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/pie/out;\n\tbedtools intersect -loj -a /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak -b /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/ens_genes_and_promoter_distal.bed > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/pie/out2;\n\tbedtools intersect -wa -b /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergedbroadpeak/ChIPseqout_peaks.gappedPeak -a /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/ens_genes_and_promoter_distal.bed > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/pie/out3;\n\tbedtools intersect -wa -b /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergednarrowpeak/ChIPseqout_peaks.narrowPeak -a /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/input/ens_genes_and_promoter_distal.bed > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/pie/out4;\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/pie.R $(grep -c Gene /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/pie/out) $(grep -c Distal /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/pie/out) $(grep -c Promoter /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/pie/out) $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/pie/out |wc -l) rplot_broad.pdf > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/pie/broad\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/pie.R $(grep -c Gene /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/pie/out2) $(grep -c Distal /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/pie/out2) $(grep -c Promoter /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/pie/out2) $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/pie/out2 |wc -l) rplot_narrow.pdf > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/pie/narrow\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/pie.R $(grep -c Gene /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/pie/out3) $(grep -c Distal /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/pie/out3) $(grep -c Promoter /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/pie/out3) $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/pie/out3 |wc -l) rplot_gene_broad.pdf > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/pie/gene_broad\n\tRscript /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/software/pie.R $(grep -c Gene /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/pie/out4) $(grep -c Distal /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/pie/out4) $(grep -c Promoter /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/pie/out4) $(cat /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/pie/out4 |wc -l) rplot_gene_narrow.pdf > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/pie/gene_narrow 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/pie/err"
    condition: ~
    mem: 5000
    placeholders: 
      - pie
      - macsunmergedbroadpeak.output2
      - input.ens_genes_and_promoter_distal.bed
      - pie.out
      - macsunmergednarrowpeak.output1
      - input.ens_genes_and_promoter_distal.bed
      - pie.out2
      - macsunmergedbroadpeak.output2
      - input.ens_genes_and_promoter_distal.bed
      - pie.out3
      - macsunmergednarrowpeak.output1
      - input.ens_genes_and_promoter_distal.bed
      - pie.out4
      - software.pie.R
      - pie.out
      - pie.out
      - pie.out
      - pie.out
      - pie.broad
      - software.pie.R
      - pie.out2
      - pie.out2
      - pie.out2
      - pie.out2
      - pie.narrow
      - software.pie.R
      - pie.out3
      - pie.out3
      - pie.out3
      - pie.out3
      - pie.gene_broad
      - software.pie.R
      - pie.out4
      - pie.out4
      - pie.out4
      - pie.out4
      - pie.gene_narrow
      - pie.err
  samtoolsview: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/samtoolsview;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\ttest -e /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bowtie/out.sam;\n\tsamtools view -hSb /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bowtie/out.sam> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/samtoolsview/out.bam;\n\tsamtools sort /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/samtoolsview/out.bam out.sorted;\n\tsamtools index /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/samtoolsview/out.sorted.bam;\n\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bowtie/out.sam; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/samtoolsview/err"
    condition: ~
    mem: 2000
    outputfiles: 
      - out.sorted.bam
      - out.sorted.bam.bai
    placeholders: 
      - samtoolsview
      - bowtie.out.sam
      - bowtie.out.sam
      - samtoolsview.out.bam
      - samtoolsview.out.bam
      - samtoolsview.output1
      - bowtie.out.sam
      - samtoolsview.err
  samtoolsviewInp: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/samtoolsviewInp;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\ttest -e /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bowtieinp/out.sam;\n\tsamtools view -hSb /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bowtieinp/out.sam > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/samtoolsviewInp/out.bam;\n\tsamtools sort /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/samtoolsviewInp/out.bam out.sorted;\n\tsamtools index /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/samtoolsviewInp/out.sorted.bam;\n\trm /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bowtieinp/out.sam; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/samtoolsviewInp/err"
    condition: ~
    mem: 2000
    outputfiles: 
      - out.sorted.bam
      - out.sorted.bam.bai
    placeholders: 
      - samtoolsviewInp
      - bowtieinp.out.sam
      - bowtieinp.out.sam
      - samtoolsviewInp.out.bam
      - samtoolsviewInp.out.bam
      - samtoolsviewInp.output1
      - bowtieinp.out.sam
      - samtoolsviewInp.err
  seperateclusters: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/seperateclusters;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\tls * | grep -v err | xargs rm -rf;\n\ttrap SomeErrorHandler ERR;\n\tclusters=4;\n\tcp /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/annotatepeaksgroup/cluster.4.RData /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/seperateclusters/clusters.RData;\n\tExtractGName.R /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/seperateclusters/clusters.RData;\n\t>&2 echo \"cluster1-4\";\n\tfor i in {1..4}\n\tdo\n\t\t>&2 echo \"cluster\" ${i};\n\t\techo -e \"/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/samtoolsview/out.sorted.bam:/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/samtoolsviewInp/out.sorted.bam\tclusters.1.cluster${i}.txt\t\\\"H3K36me3 T Cell\\\"\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/seperateclusters/config.txt;\n\t\t>&2 echo \"ngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/seperateclusters/config.txt -O heatmapclusters.${i} -L 5000 -GO total -CO blue:white:red -P 5\";\n\t\tngs.plot.r -G mm10 -R genebody -C /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/seperateclusters/config.txt -O heatmapclusters.${i} -L 3000 -GO total -CO blue:white:red -P 5;\n\t\tconvert -density 150 heatmapclusters.${i}.heatmap.pdf -quality 90 heatmapclusters.${i}.heatmap.png;\n\tdone 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/seperateclusters/err"
    condition: ~
    cores: 5
    mem: 5000
    placeholders: 
      - seperateclusters
      - annotatepeaksgroup.output1
      - seperateclusters.clusters.RData
      - seperateclusters.clusters.RData
      - samtoolsview.output1
      - samtoolsviewInp.output1
      - datasource.mark_full
      - datasource.Cell
      - seperateclusters.config.txt
      - seperateclusters.config.txt
      - seperateclusters.config.txt
      - seperateclusters.err
  summarystats: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/summarystats;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;trap SomeErrorHandler ERR;\tif [ PE == \"PE\" ];\n\t\tthen if [ TRUE == \"TRUE\" ];\n\t\t\tthen echo \"BM_T_36M_R_lane1\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_36M_R/BM_T_36M_R_1.bam >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/summarystats/out.flagstat;\n\t\t\techo \"BM_T_36M_R_lane2\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_36M_R/BM_T_36M_R_2.bam >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/summarystats/out.flagstat;\n\t\telse echo \"BM_T_36M_R\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/summarystats/out.flagstat;\n\t\t\techo \"FastQ\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/summarystats/out.flagstat;\n\t\tfi;\n\t\tif [ TRUE == \"TRUE\" ];\n\t\t\tthen echo \"Inp_BM_T_36M_R_lane1\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_INP_R/BM_T_INP_R_1.bam >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/summarystats/out.flagstat;\n\t\t\techo \"Inp_BM_T_36M_R_lane2\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_INP_R/BM_T_INP_R_2.bam >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/summarystats/out.flagstat;\n\t\telse echo \"Inp_BM_T_36M_R\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/summarystats/out.flagstat;\n\t\t\techo \"FastQ\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/summarystats/out.flagstat;\n\t\tfi;\n\telse if [ TRUE == \"TRUE\" ]; ### CHECK THIS!! SHOULD be INP_1 and INP_2\n\t\tthen echo \"BM_T_36M_R_lane1\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_36M_R/BM_T_36M_R_1.bam >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/summarystats/out.flagstat;\n\t\t\techo \"BM_T_36M_R_lane2\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_36M_R/BM_T_36M_R_2.bam >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/summarystats/out.flagstat;\n\t\telse echo \"BM_T_36M_R\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/summarystats/out.flagstat;\n\t\t\techo \"FastQ\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/summarystats/out.flagstat;\n\t\tfi;\n\t\tif [ TRUE == \"TRUE\" ];\n\t\t\tthen echo \"Inp_BM_T_36M_R_lane1\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_INP_R/BM_T_INP_R_1.bam >>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/summarystats/out.flagstat;\n\t\t\techo \"Inp_BM_T_36M_R_lane2\" >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/summarystats/out.flagstat;\n\t\t\tsamtools flagstat /lustre/scratch109/sanger/rg12/ChIPseq/Unaligned/15449/BM_T_INP_R/BM_T_INP_R_2.bam >> /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/summarystats/out.flagstat;\n\t\telse echo \"Inp_BM_T_36M_R\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/summarystats/out.flagstat;\n\t\t\techo \"FastQ\" > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/summarystats/out.flagstat;\n\t\tfi;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/summarystats/err"
    condition: ~
    mem: 1000
    placeholders: 
      - summarystats
      - datasource.SE_PE
      - datasource.bam
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - summarystats.out.flagstat
      - datasource.Inp_bam
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.Inp_location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.Inp_location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - summarystats.out.flagstat
      - datasource.bam
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - summarystats.out.flagstat
      - datasource.Inp_bam
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.Inp_location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - datasource.Inp_location
      - summarystats.out.flagstat
      - datasource.Name
      - summarystats.out.flagstat
      - summarystats.out.flagstat
      - summarystats.err
  trimgalore: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/trimgalore;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tlength=$(gunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofq/out_1.fq.gz | head -2| tail -1 | wc -c);\n\tlength=$[length-11];\n\tif [ PE == \"PE\" ];\n\tthen\n\t\ttrim_galore --fastqc --gzip --length $length --paired -a ACTTGATG --stringency 4 --trim1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofq/out_1.fq.gz /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofq/out_2.fq.gz;\n\telse\n\t\ttrim_galore --fastqc --gzip --length $length -a ACTTGATG --stringency 4 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofq/out_1.fq.gz;\n\n\t\tmv out_1_trimmed.fq.gz out_1_val_1.fq.gz;\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/trimgalore/err"
    condition: ~
    cores: 3
    mem: 2000
    outputfiles: 
      - out_1.fq.gz_trimming_report.txt
      - out_1_val_1.fq.gz
      - out_2.fq.gz_trimming_report.txt
      - out_2_val_2.fq.gz
      - out_1_val_1.html
      - out_1_val_1.zip
      - out_2_val_2.html
      - out_2_val_2.zip
    placeholders: 
      - trimgalore
      - bamtofq.out_1.fq.gz
      - datasource.SE_PE
      - datasource.Tag
      - bamtofq.out_1.fq.gz
      - bamtofq.out_2.fq.gz
      - datasource.Tag
      - bamtofq.out_1.fq.gz
      - trimgalore.err
  trimgaloreinp: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/trimgaloreinp;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tlength=$(gunzip -c /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofqinp/out_1.fq.gz | head -2| tail -1 | wc -c);\n\tlength=$[length-11];\n\tif [ PE == \"PE\" ];\n\tthen\n\t\ttrim_galore --fastqc --gzip --length $length --paired -a TAGCTTGT --stringency 4 --trim1 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofqinp/out_1.fq.gz /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofqinp/out_2.fq.gz;\n\telse\n\t\ttrim_galore --fastqc --gzip --length $length -a TAGCTTGT --stringency 4 /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/bamtofqinp/out_1.fq.gz;\n\t\tmv out_1_trimmed.fq.gz out_1_val_1.fq.gz; ### should FIX\n\tfi 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/trimgaloreinp/err"
    condition: ~
    cores: 3
    mem: 2000
    outputfiles: 
      - out_1.fq.gz_trimming_report.txt
      - out_1_val_1.fq.gz
      - out_2.fq.gz_trimming_report.txt
      - out_2_val_2.fq.gz
      - out_1_val_1.html
      - out_1_val_1.zip
      - out_2_val_2.html
      - out_2_val_2.zip
    placeholders: 
      - trimgaloreinp
      - bamtofqinp.out_1.fq.gz
      - datasource.SE_PE
      - datasource.Inp_Tag
      - bamtofqinp.out_1.fq.gz
      - bamtofqinp.out_2.fq.gz
      - datasource.Inp_Tag
      - bamtofqinp.out_1.fq.gz
      - trimgaloreinp.err
  wigcorrelate: 
    cmd: "cd /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/wigcorrelate;  ls * | grep -v err | xargs rm -rf;. /nfs/users/nfs_r/rg12/.bashrc;>&2 date;trap SomeErrorHandler ERR; . /nfs/users/nfs_r/rg12/.bashrc;\ttrap SomeErrorHandler ERR;\n\tls /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/macsunmergedbroadpeak/FoldE.bw;\n\tlength=(/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmergedbroadpeak/FoldE.bw);\n\t#Change FoldE.bw to output16\n\tif [ ${#length[@]} != 1 ];\n\t\tthen\n\t\twigCorrelate /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job5/macsunmerged/FoldE.bw > /lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/wigcorrelate/out;\n\tfi; 2>/lustre/scratch110/sanger/rg12/Pipeline/ChIPseq/output/run2/job7/wigcorrelate/err"
    condition: groupby
    condition_params: 
      - replicate
    cores: 4
    mem: 5000
    placeholders: 
      - wigcorrelate
      - macsunmergedbroadpeak.output6
      - groupby.replicate.macsunmergedbroadpeak.FoldE.bw
      - groupby.replicate.macsunmerged.FoldE.bw
      - wigcorrelate.out
      - wigcorrelate.err
